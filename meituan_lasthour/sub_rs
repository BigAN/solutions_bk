########### sub add fetch cost area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.222110033035 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0218482017517 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0447609424591 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00788807868958 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.42612695694 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0816159248352 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0529398918152 s 

add stats features begin ......
add stats features end ......
time lapsing 1.26259589195 s 

tr.size() 659269
te.size() 251864
features,length 62, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13110
[LightGBM] [Info] Number of data: 659269, number of used features: 62
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1825, 271, 2306, 8722, 2204, 1917, 2305, 1459, 1275, 2078, 1958, 5763, 8760, 7714, 6360, 724, 636, 2099, 659, 8786, 6103, 2011, 1885, 4942, 2108, 477, 7586, 2205, 2165, 2041, 3528, 1959, 2122, 5837, 7330, 8696, 1325, 2222, 1949, 1879, 4430, 1880, 1324, 2542, 1702, 562, 2178, 1981, 1886, 2045, 2092, 8981, 8552, 2069, 2258, 2916, 2436, 3143, 1310, 1960, 9510, 2052])
                                              feature  importances
1                                             area_id          271
25     lasthour_poi_agg_poi_id_mean_waiting_order_num          477
45                                           food_num          562
16                poi_agg_poi_id_mean_box_total_value          636
18              poi_agg_poi_id_mean_waiting_order_num          659
15       lasthour_poi_agg_poi_id_mean_box_total_value          724
8                                         poi_lat_bin         1275
58                                              15min         1310
42                                            poi_lat         1324
36                                            poi_lng         1325
7                                         poi_lng_bin         1459
44                      poi_agg__avg_speed_meanpoi_id         1702
0                  lasthour_poi_agg_poi_id_coor_count         1825
39              poi_agg_poi_id_mean_arrive_guest_cost         1879
41                          poi_agg_poi_id_coor_count         1880
22              lasthour_poi_agg__avg_speed_stdpoi_id         1885
48             lasthour_poi_agg_poi_id_std_fetch_cost         1886
5              lasthour_poi_agg__avg_speed_meanpoi_id         1917
38                     lasthour_poi_agg_poi_id_std_dd         1949
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1958
31               poi_agg_poi_id_std_arrive_guest_cost         1959
59     lasthour_poi_agg_poi_id_mean_delivery_distance         1960
47                                             poi_id         1981
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         2011
29      lasthour_poi_agg_poi_id_mean_food_total_value         2041
49       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2045
61              poi_agg_poi_id_mean_delivery_distance         2052
53                 poi_agg_poi_id_std_arriveshop_cost         2069
9                 poi_agg_poi_id_mean_arriveshop_cost         2078
50      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2092
..                                                ...          ...
32        lasthour_poi_agg_poi_id_std_arriveshop_cost         2122
28          poi_agg_poi_id_arrive_guest_avg_speed_std         2165
46                       poi_agg__avg_speed_stdpoi_id         2178
4                poi_agg_poi_id_mean_food_total_value         2204
27                    lasthour_poi_agg_poi_id_mean_dd         2205
37            lasthour_poi_agg_poi_id_mean_fetch_cost         2222
54  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2258
6                               poi_agg_poi_id_std_dd         2305
2                                               10min         2306
56                             poi_agg_poi_id_mean_dd         2436
43                     poi_agg_poi_id_mean_fetch_cost         2542
55                                    box_total_value         2916
57                                            weekday         3143
30                                        cst_lat_bin         3528
40                                 customer_longitude         4430
23                                        cst_lng_bin         4942
11                                  customer_latitude         5763
33                                  waiting_order_num         5837
20                           _10min_working_rider_num         6103
14                   _10min_notbusy_working_rider_num         6360
34                       _10min_deliverying_order_num         7330
26   area_id_area_id#hour#minute_arriveshop_cost_mean         7586
13    area_id_area_id#hour#minute_arriveshop_cost_std         7714
52                              prd_arrive_guest_time         8552
35                                          direction         8696
3                               bill_number_per_rider         8722
12                       _10min_not_fetched_order_num         8760
19                                  delivery_distance         8786
51                                   food_total_value         8981
60                                     area_busy_coef         9510

[62 rows x 2 columns]
[from_start 6780c31] sub:add fetch cost area
 1 file changed, 48 insertions(+), 49 deletions(-)
########### sub: add fetch cost area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.214452981949 s 

add stats features begin ......
add stats features end ......
time lapsing 0.018755197525 s 

add stats features begin ......
add stats features end ......
time lapsing 0.045599937439 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00646495819092 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.381939888 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0897309780121 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0494749546051 s 

add stats features begin ......
add stats features end ......
time lapsing 1.32183790207 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'area_id_area_id#hour#minute_fetch_cost_std', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'area_id_area_id#hour#minute_fetch_cost_mean', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13620
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1757, 254, 1922, 7641, 2159, 1719, 2362, 1497, 1255, 7174, 1923, 2172, 5443, 7624, 6224, 5926, 709, 589, 1924, 648, 8541, 5571, 1846, 2065, 4701, 2146, 411, 5878, 2216, 2198, 2004, 3857, 1901, 2206, 5411, 6589, 7863, 1307, 2015, 2010, 1821, 4418, 1650, 1326, 2278, 1743, 5609, 464, 2210, 2107, 1992, 2124, 2200, 8088, 7864, 2145, 2364, 2732, 2355, 2954, 962, 2209, 8629, 2098])
                                              feature  importances
1                                             area_id          254
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          411
47                                           food_num          464
17                poi_agg_poi_id_mean_box_total_value          589
19              poi_agg_poi_id_mean_waiting_order_num          648
16       lasthour_poi_agg_poi_id_mean_box_total_value          709
60                                              15min          962
8                                         poi_lat_bin         1255
37                                            poi_lng         1307
43                                            poi_lat         1326
7                                         poi_lng_bin         1497
42                          poi_agg_poi_id_coor_count         1650
5              lasthour_poi_agg__avg_speed_meanpoi_id         1719
45                      poi_agg__avg_speed_meanpoi_id         1743
0                  lasthour_poi_agg_poi_id_coor_count         1757
40              poi_agg_poi_id_mean_arrive_guest_cost         1821
22         poi_agg_poi_id_arrive_guest_avg_speed_mean         1846
32               poi_agg_poi_id_std_arrive_guest_cost         1901
2                                               10min         1922
10                poi_agg_poi_id_mean_arriveshop_cost         1923
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1924
50             lasthour_poi_agg_poi_id_std_fetch_cost         1992
30      lasthour_poi_agg_poi_id_mean_food_total_value         2004
39                     lasthour_poi_agg_poi_id_std_dd         2010
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2015
23              lasthour_poi_agg__avg_speed_stdpoi_id         2065
63              poi_agg_poi_id_mean_delivery_distance         2098
49                                             poi_id         2107
51       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2124
55                 poi_agg_poi_id_std_arriveshop_cost         2145
..                                                ...          ...
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2200
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2206
61     lasthour_poi_agg_poi_id_mean_delivery_distance         2209
48                       poi_agg__avg_speed_stdpoi_id         2210
28                    lasthour_poi_agg_poi_id_mean_dd         2216
44                     poi_agg_poi_id_mean_fetch_cost         2278
58                             poi_agg_poi_id_mean_dd         2355
6                               poi_agg_poi_id_std_dd         2362
56  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2364
57                                    box_total_value         2732
59                                            weekday         2954
31                                        cst_lat_bin         3857
41                                 customer_longitude         4418
24                                        cst_lng_bin         4701
34                                  waiting_order_num         5411
12                                  customer_latitude         5443
21                           _10min_working_rider_num         5571
46        area_id_area_id#hour#minute_fetch_cost_mean         5609
27   area_id_area_id#hour#minute_arriveshop_cost_mean         5878
15                   _10min_notbusy_working_rider_num         5926
14    area_id_area_id#hour#minute_arriveshop_cost_std         6224
35                       _10min_deliverying_order_num         6589
9          area_id_area_id#hour#minute_fetch_cost_std         7174
13                       _10min_not_fetched_order_num         7624
3                               bill_number_per_rider         7641
36                                          direction         7863
54                              prd_arrive_guest_time         7864
53                                   food_total_value         8088
20                                  delivery_distance         8541
62                                     area_busy_coef         8629

[64 rows x 2 columns]
[from_start 2fe3c24] sub:add fetch cost area
 2 files changed, 82 insertions(+), 80 deletions(-)
########### sub: arrive_guest_cost ###########
add stats features begin ......
add stats features end ......
time lapsing 0.226097106934 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0189690589905 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0463399887085 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00699496269226 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.382848024368 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0753009319305 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0508580207825 s 

add stats features begin ......
add stats features end ......
time lapsing 1.19944190979 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_aarrive_guest_cost_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_id_area_id#hour#minute_arrive_guest_cost_std', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13618
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1740, 298, 1999, 7785, 2023, 1729, 2258, 1422, 1289, 2065, 1845, 5936, 7221, 6613, 6071, 647, 555, 1999, 618, 8408, 5500, 1928, 6252, 2016, 4618, 2086, 380, 6493, 2258, 2100, 1977, 3739, 1873, 2114, 5463, 7047, 8068, 1254, 2035, 2049, 1700, 4336, 1602, 1252, 2324, 1631, 461, 2154, 1838, 1832, 2195, 1794, 8988, 7534, 1857, 2431, 2867, 2355, 6329, 3005, 1034, 1949, 8836, 1925])
                                              feature  importances
1                                             area_id          298
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          380
46                                           food_num          461
16                poi_agg_poi_id_mean_box_total_value          555
18              poi_agg_poi_id_mean_waiting_order_num          618
15       lasthour_poi_agg_poi_id_mean_box_total_value          647
60                                              15min         1034
43                                            poi_lat         1252
37                                            poi_lng         1254
8                                         poi_lat_bin         1289
7                                         poi_lng_bin         1422
42                          poi_agg_poi_id_coor_count         1602
45                      poi_agg__avg_speed_meanpoi_id         1631
40              poi_agg_poi_id_mean_arrive_guest_cost         1700
5              lasthour_poi_agg__avg_speed_meanpoi_id         1729
0                  lasthour_poi_agg_poi_id_coor_count         1740
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1794
49             lasthour_poi_agg_poi_id_std_fetch_cost         1832
48                                             poi_id         1838
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1845
54                 poi_agg_poi_id_std_arriveshop_cost         1857
32               poi_agg_poi_id_std_arrive_guest_cost         1873
63              poi_agg_poi_id_mean_delivery_distance         1925
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1928
61     lasthour_poi_agg_poi_id_mean_delivery_distance         1949
30      lasthour_poi_agg_poi_id_mean_food_total_value         1977
2                                               10min         1999
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1999
23              lasthour_poi_agg__avg_speed_stdpoi_id         2016
4                poi_agg_poi_id_mean_food_total_value         2023
..                                                ...          ...
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2100
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2114
47                       poi_agg__avg_speed_stdpoi_id         2154
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2195
6                               poi_agg_poi_id_std_dd         2258
28                    lasthour_poi_agg_poi_id_mean_dd         2258
44                     poi_agg_poi_id_mean_fetch_cost         2324
57                             poi_agg_poi_id_mean_dd         2355
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2431
56                                    box_total_value         2867
59                                            weekday         3005
31                                        cst_lat_bin         3739
41                                 customer_longitude         4336
24                                        cst_lng_bin         4618
34                                  waiting_order_num         5463
20                           _10min_working_rider_num         5500
11                                  customer_latitude         5936
14                   _10min_notbusy_working_rider_num         6071
22  area_id_area_id#hour#minute_aarrive_guest_cost...         6252
58  area_id_area_id#hour#minute_arrive_guest_cost_std         6329
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6493
13    area_id_area_id#hour#minute_arriveshop_cost_std         6613
35                       _10min_deliverying_order_num         7047
12                       _10min_not_fetched_order_num         7221
53                              prd_arrive_guest_time         7534
3                               bill_number_per_rider         7785
36                                          direction         8068
19                                  delivery_distance         8408
62                                     area_busy_coef         8836
52                                   food_total_value         8988

[64 rows x 2 columns]
[from_start 6afe3dd] sub:arrive_guest_cost
 2 files changed, 36 insertions(+), 35 deletions(-)
########### sub: food total value : only sum ###########
add stats features begin ......
add stats features end ......
time lapsing 0.214001178741 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0193209648132 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0433678627014 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00706887245178 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.412833929062 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0895328521729 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0474720001221 s 

add stats features begin ......
add stats features end ......
time lapsing 1.39189291 s 

tr.size() 659269
te.size() 251864
features,length 63, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1863, 272, 2086, 8028, 2182, 2075, 2202, 1556, 1384, 2050, 2105, 5465, 7672, 6647, 6408, 727, 641, 2002, 624, 8440, 5777, 1840, 7238, 1858, 4987, 2090, 455, 6519, 2305, 2263, 2319, 3808, 2045, 2085, 5267, 7163, 8778, 1294, 2207, 2080, 1829, 4252, 1652, 1361, 2385, 1798, 421, 2190, 2091, 1995, 2158, 1991, 8552, 8348, 1951, 2152, 2807, 2308, 3140, 1061, 2081, 8569, 2101])
                                              feature  importances
1                                             area_id          272
46                                           food_num          421
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          455
18              poi_agg_poi_id_mean_waiting_order_num          624
16                poi_agg_poi_id_mean_box_total_value          641
15       lasthour_poi_agg_poi_id_mean_box_total_value          727
59                                              15min         1061
37                                            poi_lng         1294
43                                            poi_lat         1361
8                                         poi_lat_bin         1384
7                                         poi_lng_bin         1556
42                          poi_agg_poi_id_coor_count         1652
45                      poi_agg__avg_speed_meanpoi_id         1798
40              poi_agg_poi_id_mean_arrive_guest_cost         1829
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1840
23              lasthour_poi_agg__avg_speed_stdpoi_id         1858
0                  lasthour_poi_agg_poi_id_coor_count         1863
54                 poi_agg_poi_id_std_arriveshop_cost         1951
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1991
49             lasthour_poi_agg_poi_id_std_fetch_cost         1995
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2002
32               poi_agg_poi_id_std_arrive_guest_cost         2045
9                 poi_agg_poi_id_mean_arriveshop_cost         2050
5              lasthour_poi_agg__avg_speed_meanpoi_id         2075
39                     lasthour_poi_agg_poi_id_std_dd         2080
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2081
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2085
2                                               10min         2086
25                      poi_agg_poi_id_std_fetch_cost         2090
48                                             poi_id         2091
..                                                ...          ...
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2158
4                poi_agg_poi_id_mean_food_total_value         2182
47                       poi_agg__avg_speed_stdpoi_id         2190
6                               poi_agg_poi_id_std_dd         2202
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2207
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2263
28                    lasthour_poi_agg_poi_id_mean_dd         2305
57                             poi_agg_poi_id_mean_dd         2308
30      lasthour_poi_agg_poi_id_mean_food_total_value         2319
44                     poi_agg_poi_id_mean_fetch_cost         2385
56                                    box_total_value         2807
58                                            weekday         3140
31                                        cst_lat_bin         3808
41                                 customer_longitude         4252
24                                        cst_lng_bin         4987
34                                  waiting_order_num         5267
11                                  customer_latitude         5465
20                           _10min_working_rider_num         5777
14                   _10min_notbusy_working_rider_num         6408
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6519
13    area_id_area_id#hour#minute_arriveshop_cost_std         6647
35                       _10min_deliverying_order_num         7163
22   area_id_area_id#hour#minute_food_total_value_sum         7238
12                       _10min_not_fetched_order_num         7672
3                               bill_number_per_rider         8028
53                              prd_arrive_guest_time         8348
19                                  delivery_distance         8440
52                                   food_total_value         8552
61                                     area_busy_coef         8569
36                                          direction         8778

[63 rows x 2 columns]
[from_start 9ddc568] sub:food total value : only sum
 2 files changed, 33 insertions(+), 29 deletions(-)
########### sub: try order id count ###########
[from_start 79b4887] sub:try order id count
 1 file changed, 2 insertions(+), 1 deletion(-)
########### sub: try order id count ###########
add stats features begin ......
add stats features end ......
time lapsing 0.205654859543 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0198690891266 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0412628650665 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00679397583008 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.363966941833 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0732250213623 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0488791465759 s 

add stats features begin ......
add stats features end ......
time lapsing 1.01906895638 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'area_id_area_id#hour#minute_order_id_count', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13617
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1777, 264, 1969, 7656, 2121, 1803, 2229, 1425, 1253, 2056, 1913, 6057, 7282, 6359, 6170, 688, 5591, 543, 1878, 675, 8513, 5595, 1778, 6064, 1902, 4866, 2038, 435, 6746, 2162, 1896, 2222, 3422, 2089, 1987, 5343, 6993, 8310, 1227, 2032, 1926, 1737, 4257, 1646, 1358, 2308, 1680, 452, 2142, 2066, 1992, 2003, 2030, 8374, 8321, 2081, 2251, 2742, 2382, 3049, 1032, 2043, 8837, 1962])
                                              feature  importances
1                                             area_id          264
27     lasthour_poi_agg_poi_id_mean_waiting_order_num          435
47                                           food_num          452
17                poi_agg_poi_id_mean_box_total_value          543
19              poi_agg_poi_id_mean_waiting_order_num          675
15       lasthour_poi_agg_poi_id_mean_box_total_value          688
60                                              15min         1032
38                                            poi_lng         1227
8                                         poi_lat_bin         1253
44                                            poi_lat         1358
7                                         poi_lng_bin         1425
43                          poi_agg_poi_id_coor_count         1646
46                      poi_agg__avg_speed_meanpoi_id         1680
41              poi_agg_poi_id_mean_arrive_guest_cost         1737
0                  lasthour_poi_agg_poi_id_coor_count         1777
22         poi_agg_poi_id_arrive_guest_avg_speed_mean         1778
5              lasthour_poi_agg__avg_speed_meanpoi_id         1803
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1878
30          poi_agg_poi_id_arrive_guest_avg_speed_std         1896
24              lasthour_poi_agg__avg_speed_stdpoi_id         1902
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1913
40                     lasthour_poi_agg_poi_id_std_dd         1926
63              poi_agg_poi_id_mean_delivery_distance         1962
2                                               10min         1969
34        lasthour_poi_agg_poi_id_std_arriveshop_cost         1987
50             lasthour_poi_agg_poi_id_std_fetch_cost         1992
51       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2003
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2030
39            lasthour_poi_agg_poi_id_mean_fetch_cost         2032
26                      poi_agg_poi_id_std_fetch_cost         2038
..                                                ...          ...
33               poi_agg_poi_id_std_arrive_guest_cost         2089
4                poi_agg_poi_id_mean_food_total_value         2121
48                       poi_agg__avg_speed_stdpoi_id         2142
29                    lasthour_poi_agg_poi_id_mean_dd         2162
31      lasthour_poi_agg_poi_id_mean_food_total_value         2222
6                               poi_agg_poi_id_std_dd         2229
56  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2251
45                     poi_agg_poi_id_mean_fetch_cost         2308
58                             poi_agg_poi_id_mean_dd         2382
57                                    box_total_value         2742
59                                            weekday         3049
32                                        cst_lat_bin         3422
42                                 customer_longitude         4257
25                                        cst_lng_bin         4866
35                                  waiting_order_num         5343
16         area_id_area_id#hour#minute_order_id_count         5591
21                           _10min_working_rider_num         5595
11                                  customer_latitude         6057
23   area_id_area_id#hour#minute_food_total_value_sum         6064
14                   _10min_notbusy_working_rider_num         6170
13    area_id_area_id#hour#minute_arriveshop_cost_std         6359
28   area_id_area_id#hour#minute_arriveshop_cost_mean         6746
36                       _10min_deliverying_order_num         6993
12                       _10min_not_fetched_order_num         7282
3                               bill_number_per_rider         7656
37                                          direction         8310
54                              prd_arrive_guest_time         8321
53                                   food_total_value         8374
20                                  delivery_distance         8513
62                                     area_busy_coef         8837

[64 rows x 2 columns]
[from_start 2f19f24] sub:try order id count
 1 file changed, 26 insertions(+), 24 deletions(-)
########### sub: try delivery distance ###########
add stats features begin ......
add stats features end ......
time lapsing 0.224342107773 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0189309120178 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0418429374695 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00672101974487 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.365551948547 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0895011425018 s 

add stats features begin ......
add stats features end ......
time lapsing 0.051924943924 s 

add stats features begin ......
add stats features end ......
time lapsing 0.981240987778 s 

tr.size() 659269
te.size() 251864
features,length 63, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1863, 272, 2086, 8028, 2182, 2075, 2202, 1556, 1384, 2050, 2105, 5465, 7672, 6647, 6408, 727, 641, 2002, 624, 8440, 5777, 1840, 7238, 1858, 4987, 2090, 455, 6519, 2305, 2263, 2319, 3808, 2045, 2085, 5267, 7163, 8778, 1294, 2207, 2080, 1829, 4252, 1652, 1361, 2385, 1798, 421, 2190, 2091, 1995, 2158, 1991, 8552, 8348, 1951, 2152, 2807, 2308, 3140, 1061, 2081, 8569, 2101])
                                              feature  importances
1                                             area_id          272
46                                           food_num          421
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          455
18              poi_agg_poi_id_mean_waiting_order_num          624
16                poi_agg_poi_id_mean_box_total_value          641
15       lasthour_poi_agg_poi_id_mean_box_total_value          727
59                                              15min         1061
37                                            poi_lng         1294
43                                            poi_lat         1361
8                                         poi_lat_bin         1384
7                                         poi_lng_bin         1556
42                          poi_agg_poi_id_coor_count         1652
45                      poi_agg__avg_speed_meanpoi_id         1798
40              poi_agg_poi_id_mean_arrive_guest_cost         1829
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1840
23              lasthour_poi_agg__avg_speed_stdpoi_id         1858
0                  lasthour_poi_agg_poi_id_coor_count         1863
54                 poi_agg_poi_id_std_arriveshop_cost         1951
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1991
49             lasthour_poi_agg_poi_id_std_fetch_cost         1995
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2002
32               poi_agg_poi_id_std_arrive_guest_cost         2045
9                 poi_agg_poi_id_mean_arriveshop_cost         2050
5              lasthour_poi_agg__avg_speed_meanpoi_id         2075
39                     lasthour_poi_agg_poi_id_std_dd         2080
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2081
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2085
2                                               10min         2086
25                      poi_agg_poi_id_std_fetch_cost         2090
48                                             poi_id         2091
..                                                ...          ...
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2158
4                poi_agg_poi_id_mean_food_total_value         2182
47                       poi_agg__avg_speed_stdpoi_id         2190
6                               poi_agg_poi_id_std_dd         2202
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2207
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2263
28                    lasthour_poi_agg_poi_id_mean_dd         2305
57                             poi_agg_poi_id_mean_dd         2308
30      lasthour_poi_agg_poi_id_mean_food_total_value         2319
44                     poi_agg_poi_id_mean_fetch_cost         2385
56                                    box_total_value         2807
58                                            weekday         3140
31                                        cst_lat_bin         3808
41                                 customer_longitude         4252
24                                        cst_lng_bin         4987
34                                  waiting_order_num         5267
11                                  customer_latitude         5465
20                           _10min_working_rider_num         5777
14                   _10min_notbusy_working_rider_num         6408
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6519
13    area_id_area_id#hour#minute_arriveshop_cost_std         6647
35                       _10min_deliverying_order_num         7163
22   area_id_area_id#hour#minute_food_total_value_sum         7238
12                       _10min_not_fetched_order_num         7672
3                               bill_number_per_rider         8028
53                              prd_arrive_guest_time         8348
19                                  delivery_distance         8440
52                                   food_total_value         8552
61                                     area_busy_coef         8569
36                                          direction         8778

[63 rows x 2 columns]
[from_start 84d6525] sub:try delivery distance
 1 file changed, 5 insertions(+), 9 deletions(-)
########### sub: try delivery distance ###########
add stats features begin ......
add stats features end ......
time lapsing 0.228309869766 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0241940021515 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0504951477051 s 

add stats features begin ......
add stats features end ......
time lapsing 0.01211810112 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.363825082779 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0802359580994 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0447220802307 s 

add stats features begin ......
add stats features end ......
time lapsing 1.14902615547 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_id_area_id#hour#minute_delivery_distance_sum', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13618
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1709, 276, 1893, 7860, 2092, 1807, 2213, 1511, 1232, 2087, 2026, 5926, 7383, 6611, 6142, 666, 544, 2050, 696, 8283, 5656, 1879, 5891, 1937, 4959, 2283, 403, 6256, 2202, 2110, 1999, 3688, 1867, 2103, 5391, 6821, 8055, 1226, 2008, 1992, 1816, 4408, 1509, 1322, 2290, 1606, 448, 2203, 1919, 1951, 2163, 1867, 9041, 7763, 1970, 2343, 2868, 2312, 5417, 3138, 982, 2079, 8989, 1863])
                                              feature  importances
1                                             area_id          276
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          403
46                                           food_num          448
16                poi_agg_poi_id_mean_box_total_value          544
15       lasthour_poi_agg_poi_id_mean_box_total_value          666
18              poi_agg_poi_id_mean_waiting_order_num          696
60                                              15min          982
37                                            poi_lng         1226
8                                         poi_lat_bin         1232
43                                            poi_lat         1322
42                          poi_agg_poi_id_coor_count         1509
7                                         poi_lng_bin         1511
45                      poi_agg__avg_speed_meanpoi_id         1606
0                  lasthour_poi_agg_poi_id_coor_count         1709
5              lasthour_poi_agg__avg_speed_meanpoi_id         1807
40              poi_agg_poi_id_mean_arrive_guest_cost         1816
63              poi_agg_poi_id_mean_delivery_distance         1863
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1867
32               poi_agg_poi_id_std_arrive_guest_cost         1867
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1879
2                                               10min         1893
48                                             poi_id         1919
23              lasthour_poi_agg__avg_speed_stdpoi_id         1937
49             lasthour_poi_agg_poi_id_std_fetch_cost         1951
54                 poi_agg_poi_id_std_arriveshop_cost         1970
39                     lasthour_poi_agg_poi_id_std_dd         1992
30      lasthour_poi_agg_poi_id_mean_food_total_value         1999
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2008
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2026
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2050
..                                                ...          ...
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2110
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2163
28                    lasthour_poi_agg_poi_id_mean_dd         2202
47                       poi_agg__avg_speed_stdpoi_id         2203
6                               poi_agg_poi_id_std_dd         2213
25                      poi_agg_poi_id_std_fetch_cost         2283
44                     poi_agg_poi_id_mean_fetch_cost         2290
57                             poi_agg_poi_id_mean_dd         2312
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2343
56                                    box_total_value         2868
59                                            weekday         3138
31                                        cst_lat_bin         3688
41                                 customer_longitude         4408
24                                        cst_lng_bin         4959
34                                  waiting_order_num         5391
58  area_id_area_id#hour#minute_delivery_distance_sum         5417
20                           _10min_working_rider_num         5656
22   area_id_area_id#hour#minute_food_total_value_sum         5891
11                                  customer_latitude         5926
14                   _10min_notbusy_working_rider_num         6142
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6256
13    area_id_area_id#hour#minute_arriveshop_cost_std         6611
35                       _10min_deliverying_order_num         6821
12                       _10min_not_fetched_order_num         7383
53                              prd_arrive_guest_time         7763
3                               bill_number_per_rider         7860
36                                          direction         8055
19                                  delivery_distance         8283
62                                     area_busy_coef         8989
52                                   food_total_value         9041

[64 rows x 2 columns]
[from_start d64957b] sub:try delivery distance
 3 files changed, 44 insertions(+), 29 deletions(-)
########### sub: try delivery_duration ###########
add stats features begin ......
add stats features end ......
time lapsing 0.214570045471 s 

add stats features begin ......
add stats features end ......
time lapsing 0.018070936203 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0409820079803 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00703501701355 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.382635831833 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0762791633606 s 

add stats features begin ......
add stats features end ......
time lapsing 0.045825958252 s 

add stats features begin ......
add stats features end ......
time lapsing 0.86186003685 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lat', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'area_id_area_id#hour#minute_delivery_duration_sum', 'cst_lat_bin', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_mean_food_total_value']
Start training...
[LightGBM] [Info] Total Bins 13618
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1810, 256, 1905, 7502, 2122, 1929, 2242, 1567, 1281, 2119, 1929, 6010, 6992, 6560, 6078, 700, 541, 2039, 646, 8555, 5531, 1946, 5583, 2106, 4783, 2164, 417, 6187, 2305, 2254, 1259, 2047, 1978, 5625, 6505, 8222, 1234, 1993, 1651, 2108, 1745, 4298, 5167, 3881, 2448, 1656, 471, 2245, 1897, 1972, 2270, 1898, 9019, 7601, 2010, 2466, 2814, 2368, 2879, 1048, 2041, 9114, 1888, 2123])
                                              feature  importances
1                                             area_id          256
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          417
46                                           food_num          471
16                poi_agg_poi_id_mean_box_total_value          541
18              poi_agg_poi_id_mean_waiting_order_num          646
15       lasthour_poi_agg_poi_id_mean_box_total_value          700
59                                              15min         1048
36                                            poi_lng         1234
30                                            poi_lat         1259
8                                         poi_lat_bin         1281
7                                         poi_lng_bin         1567
38                          poi_agg_poi_id_coor_count         1651
45                      poi_agg__avg_speed_meanpoi_id         1656
40              poi_agg_poi_id_mean_arrive_guest_cost         1745
0                  lasthour_poi_agg_poi_id_coor_count         1810
62              poi_agg_poi_id_mean_delivery_distance         1888
48                                             poi_id         1897
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1898
2                                               10min         1905
5              lasthour_poi_agg__avg_speed_meanpoi_id         1929
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1929
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1946
49             lasthour_poi_agg_poi_id_std_fetch_cost         1972
32        lasthour_poi_agg_poi_id_std_arriveshop_cost         1978
37            lasthour_poi_agg_poi_id_mean_fetch_cost         1993
54                 poi_agg_poi_id_std_arriveshop_cost         2010
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2039
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2041
31               poi_agg_poi_id_std_arrive_guest_cost         2047
23              lasthour_poi_agg__avg_speed_stdpoi_id         2106
..                                                ...          ...
25                      poi_agg_poi_id_std_fetch_cost         2164
6                               poi_agg_poi_id_std_dd         2242
47                       poi_agg__avg_speed_stdpoi_id         2245
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2254
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2270
28                    lasthour_poi_agg_poi_id_mean_dd         2305
57                             poi_agg_poi_id_mean_dd         2368
44                     poi_agg_poi_id_mean_fetch_cost         2448
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2466
56                                    box_total_value         2814
58                                            weekday         2879
43                                        cst_lat_bin         3881
41                                 customer_longitude         4298
24                                        cst_lng_bin         4783
42  area_id_area_id#hour#minute_delivery_duration_sum         5167
20                           _10min_working_rider_num         5531
22   area_id_area_id#hour#minute_food_total_value_sum         5583
33                                  waiting_order_num         5625
11                                  customer_latitude         6010
14                   _10min_notbusy_working_rider_num         6078
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6187
34                       _10min_deliverying_order_num         6505
13    area_id_area_id#hour#minute_arriveshop_cost_std         6560
12                       _10min_not_fetched_order_num         6992
3                               bill_number_per_rider         7502
53                              prd_arrive_guest_time         7601
35                                          direction         8222
19                                  delivery_distance         8555
52                                   food_total_value         9019
61                                     area_busy_coef         9114

[64 rows x 2 columns]
[from_start b4d08dd] sub:try delivery_duration
 3 files changed, 31 insertions(+), 31 deletions(-)
########### sub: try area: area_busy_coef###########
add stats features begin ......
add stats features end ......
time lapsing 0.232547044754 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0196671485901 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0474801063538 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00742101669312 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.388142108917 s 

add stats features begin ......
add stats features end ......
time lapsing 0.079549074173 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0530982017517 s 

add stats features begin ......
add stats features end ......
time lapsing 1.1546151638 s 

tr.size() 659269
te.size() 251864
features,length 65, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'area_id_area_id#hour#minute_area_busy_coef_std', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'area_busy_coef', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'area_id_area_id#hour#minute_area_busy_coef_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'poi_agg_poi_id_mean_food_total_value', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13874
[LightGBM] [Info] Number of data: 659269, number of used features: 65
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1807, 238, 1734, 7624, 6024, 1874, 2202, 1365, 1227, 2070, 2107, 5671, 7227, 5740, 5957, 699, 516, 2072, 633, 7838, 8720, 5127, 1835, 5912, 5260, 1954, 4300, 2246, 447, 5332, 2139, 2101, 2196, 3355, 1960, 2286, 4981, 6214, 7827, 1316, 2110, 1945, 1932, 4292, 1693, 1347, 2254, 1757, 469, 2167, 2141, 1887, 2141, 1986, 8781, 8265, 1962, 2205, 2462, 2370, 2679, 857, 2026, 2151, 1988])
                                              feature  importances
1                                             area_id          238
28     lasthour_poi_agg_poi_id_mean_waiting_order_num          447
48                                           food_num          469
16                poi_agg_poi_id_mean_box_total_value          516
18              poi_agg_poi_id_mean_waiting_order_num          633
15       lasthour_poi_agg_poi_id_mean_box_total_value          699
61                                              15min          857
8                                         poi_lat_bin         1227
39                                            poi_lng         1316
45                                            poi_lat         1347
7                                         poi_lng_bin         1365
44                          poi_agg_poi_id_coor_count         1693
2                                               10min         1734
47                      poi_agg__avg_speed_meanpoi_id         1757
0                  lasthour_poi_agg_poi_id_coor_count         1807
22         poi_agg_poi_id_arrive_guest_avg_speed_mean         1835
5              lasthour_poi_agg__avg_speed_meanpoi_id         1874
51             lasthour_poi_agg_poi_id_std_fetch_cost         1887
42              poi_agg_poi_id_mean_arrive_guest_cost         1932
41                     lasthour_poi_agg_poi_id_std_dd         1945
25              lasthour_poi_agg__avg_speed_stdpoi_id         1954
34               poi_agg_poi_id_std_arrive_guest_cost         1960
56                 poi_agg_poi_id_std_arriveshop_cost         1962
53      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1986
64              poi_agg_poi_id_mean_delivery_distance         1988
62     lasthour_poi_agg_poi_id_mean_delivery_distance         2026
9                 poi_agg_poi_id_mean_arriveshop_cost         2070
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2072
31          poi_agg_poi_id_arrive_guest_avg_speed_std         2101
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2107
..                                                ...          ...
49                       poi_agg__avg_speed_stdpoi_id         2167
32      lasthour_poi_agg_poi_id_mean_food_total_value         2196
6                               poi_agg_poi_id_std_dd         2202
57  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2205
27                      poi_agg_poi_id_std_fetch_cost         2246
46                     poi_agg_poi_id_mean_fetch_cost         2254
35               poi_agg_poi_id_mean_food_total_value         2286
59                             poi_agg_poi_id_mean_dd         2370
58                                    box_total_value         2462
60                                            weekday         2679
33                                        cst_lat_bin         3355
43                                 customer_longitude         4292
26                                        cst_lng_bin         4300
36                                  waiting_order_num         4981
21                           _10min_working_rider_num         5127
24     area_id_area_id#hour#minute_area_busy_coef_sum         5260
29   area_id_area_id#hour#minute_arriveshop_cost_mean         5332
11                                  customer_latitude         5671
13    area_id_area_id#hour#minute_arriveshop_cost_std         5740
23   area_id_area_id#hour#minute_food_total_value_sum         5912
14                   _10min_notbusy_working_rider_num         5957
4      area_id_area_id#hour#minute_area_busy_coef_std         6024
37                       _10min_deliverying_order_num         6214
12                       _10min_not_fetched_order_num         7227
3                               bill_number_per_rider         7624
38                                          direction         7827
19                                     area_busy_coef         7838
55                              prd_arrive_guest_time         8265
20                                  delivery_distance         8720
54                                   food_total_value         8781

[65 rows x 2 columns]
[from_start 8eb02f1] sub:try area: area_busy_coef
 2 files changed, 37 insertions(+), 37 deletions(-)
########### sub: try poi_dd_rank ###########
add stats features begin ......
add stats features end ......
time lapsing 0.335414886475 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0318310260773 s 

add stats features begin ......
add stats features end ......
time lapsing 0.065603017807 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0114541053772 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.478542089462 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0958459377289 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0569961071014 s 

add stats features begin ......
add stats features end ......
time lapsing 1.29945707321 s 

tr.size() 659269
te.size() 251864
features,length 67, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'area_id_area_id#hour#minute_area_busy_coef_std', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'area_id_area_id#hour#minute_food_total_value_sum', 'area_id_area_id#hour#minute_area_busy_coef_sum', 'lasthour_poi_agg_poi_id_std_dd', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'poi_agg_poi_id_mean_food_total_value', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'index', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'poi_dd_rank', 'area_busy_coef', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg__avg_speed_stdpoi_id']
Start training...
[LightGBM] [Info] Total Bins 14384
[LightGBM] [Info] Number of data: 659269, number of used features: 67
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1873, 220, 2851, 1832, 6014, 5881, 1859, 2178, 1343, 1218, 1945, 1894, 5425, 7226, 1737, 5823, 2259, 1920, 646, 632, 5721, 5843, 5567, 2026, 4420, 2155, 2315, 5485, 4409, 2060, 526, 3617, 1924, 2260, 4780, 7648, 7395, 1237, 2048, 452, 1953, 1846, 920, 2016, 2212, 1252, 2401, 1697, 432, 856, 1884, 1916, 2109, 8432, 8361, 1970, 5370, 2660, 2323, 895, 7983, 1974, 7647, 2134, 2163, 1991, 1939])
                                              feature  importances
1                                             area_id          220
48                                           food_num          432
39     lasthour_poi_agg_poi_id_mean_waiting_order_num          452
30                poi_agg_poi_id_mean_box_total_value          526
19       lasthour_poi_agg_poi_id_mean_box_total_value          632
18              poi_agg_poi_id_mean_waiting_order_num          646
49                                             poi_id          856
59                                        poi_dd_rank          895
42                                              15min          920
9                                         poi_lat_bin         1218
37                                            poi_lng         1237
45                                            poi_lat         1252
8                                         poi_lng_bin         1343
47                      poi_agg__avg_speed_meanpoi_id         1697
14                                              10min         1737
3                           poi_agg_poi_id_coor_count         1832
41  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1846
6              lasthour_poi_agg__avg_speed_meanpoi_id         1859
0                  lasthour_poi_agg_poi_id_coor_count         1873
50             lasthour_poi_agg_poi_id_std_fetch_cost         1884
11     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1894
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1916
17         poi_agg_poi_id_arrive_guest_avg_speed_mean         1920
32               poi_agg_poi_id_std_arrive_guest_cost         1924
66              lasthour_poi_agg__avg_speed_stdpoi_id         1939
10                poi_agg_poi_id_mean_arriveshop_cost         1945
40                                              index         1953
55                 poi_agg_poi_id_std_arriveshop_cost         1970
61              poi_agg_poi_id_mean_arrive_guest_cost         1974
65              poi_agg_poi_id_mean_delivery_distance         1991
..                                                ...          ...
64        lasthour_poi_agg_poi_id_std_arriveshop_cost         2163
7                               poi_agg_poi_id_std_dd         2178
44                       poi_agg__avg_speed_stdpoi_id         2212
16      lasthour_poi_agg_poi_id_mean_food_total_value         2259
33               poi_agg_poi_id_mean_food_total_value         2260
26  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2315
58                             poi_agg_poi_id_mean_dd         2323
46                     poi_agg_poi_id_mean_fetch_cost         2401
57                                    box_total_value         2660
2                                             weekday         2851
31                                        cst_lat_bin         3617
28                                 customer_longitude         4409
24                                        cst_lng_bin         4420
34                                  waiting_order_num         4780
56                   _10min_notbusy_working_rider_num         5370
12                                  customer_latitude         5425
27   area_id_area_id#hour#minute_arriveshop_cost_mean         5485
22     area_id_area_id#hour#minute_area_busy_coef_sum         5567
20                           _10min_working_rider_num         5721
15    area_id_area_id#hour#minute_arriveshop_cost_std         5823
21   area_id_area_id#hour#minute_food_total_value_sum         5843
5      area_id_area_id#hour#minute_area_busy_coef_std         5881
4                        _10min_deliverying_order_num         6014
13                       _10min_not_fetched_order_num         7226
36                                          direction         7395
62                                  delivery_distance         7647
35                              bill_number_per_rider         7648
60                                     area_busy_coef         7983
54                              prd_arrive_guest_time         8361
53                                   food_total_value         8432

[67 rows x 2 columns]
[from_start 146c24c] sub:try poi_dd_rank
 2 files changed, 35 insertions(+), 32 deletions(-)
########### sub: try poi_dd_rank ###########
add stats features begin ......
add stats features end ......
time lapsing 0.290452003479 s 

add stats features begin ......
add stats features end ......
time lapsing 0.037003993988 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0809369087219 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0135719776154 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.569432973862 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0848290920258 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0686891078949 s 

add stats features begin ......
add stats features end ......
time lapsing 1.51061201096 s 

tr.size() 659269
te.size() 251864
features,length 65, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'poi_dd_rank', 'index', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13874
[LightGBM] [Info] Number of data: 659269, number of used features: 65
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1790, 277, 2122, 8285, 2222, 1851, 2089, 1385, 1261, 2030, 2020, 5839, 7494, 6985, 6183, 720, 488, 2069, 650, 7824, 5811, 1989, 6874, 1860, 4467, 2165, 378, 6751, 2131, 2100, 2208, 3777, 2018, 1937, 5515, 7316, 8126, 1246, 2067, 1961, 1830, 4493, 1720, 1341, 2473, 1609, 486, 2084, 1863, 1923, 2227, 1889, 8872, 8108, 1997, 2356, 2729, 2268, 873, 1119, 2989, 1021, 2029, 9523, 1897])
                                              feature  importances
1                                             area_id          277
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          378
46                                           food_num          486
16                poi_agg_poi_id_mean_box_total_value          488
18              poi_agg_poi_id_mean_waiting_order_num          650
15       lasthour_poi_agg_poi_id_mean_box_total_value          720
58                                        poi_dd_rank          873
61                                              15min         1021
59                                              index         1119
37                                            poi_lng         1246
8                                         poi_lat_bin         1261
43                                            poi_lat         1341
7                                         poi_lng_bin         1385
45                      poi_agg__avg_speed_meanpoi_id         1609
42                          poi_agg_poi_id_coor_count         1720
0                  lasthour_poi_agg_poi_id_coor_count         1790
40              poi_agg_poi_id_mean_arrive_guest_cost         1830
5              lasthour_poi_agg__avg_speed_meanpoi_id         1851
23              lasthour_poi_agg__avg_speed_stdpoi_id         1860
48                                             poi_id         1863
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1889
64              poi_agg_poi_id_mean_delivery_distance         1897
49             lasthour_poi_agg_poi_id_std_fetch_cost         1923
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         1937
39                     lasthour_poi_agg_poi_id_std_dd         1961
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1989
54                 poi_agg_poi_id_std_arriveshop_cost         1997
32               poi_agg_poi_id_std_arrive_guest_cost         2018
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2020
62     lasthour_poi_agg_poi_id_mean_delivery_distance         2029
..                                                ...          ...
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2100
2                                               10min         2122
28                    lasthour_poi_agg_poi_id_mean_dd         2131
25                      poi_agg_poi_id_std_fetch_cost         2165
30      lasthour_poi_agg_poi_id_mean_food_total_value         2208
4                poi_agg_poi_id_mean_food_total_value         2222
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2227
57                             poi_agg_poi_id_mean_dd         2268
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2356
44                     poi_agg_poi_id_mean_fetch_cost         2473
56                                    box_total_value         2729
60                                            weekday         2989
31                                        cst_lat_bin         3777
24                                        cst_lng_bin         4467
41                                 customer_longitude         4493
34                                  waiting_order_num         5515
20                           _10min_working_rider_num         5811
11                                  customer_latitude         5839
14                   _10min_notbusy_working_rider_num         6183
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6751
22   area_id_area_id#hour#minute_food_total_value_sum         6874
13    area_id_area_id#hour#minute_arriveshop_cost_std         6985
35                       _10min_deliverying_order_num         7316
12                       _10min_not_fetched_order_num         7494
19                                  delivery_distance         7824
53                              prd_arrive_guest_time         8108
36                                          direction         8126
3                               bill_number_per_rider         8285
52                                   food_total_value         8872
63                                     area_busy_coef         9523

[65 rows x 2 columns]
[from_start b814087] sub:try poi_dd_rank
 2 files changed, 16 insertions(+), 19 deletions(-)
########### sub: try poi_dd_rank ###########
add stats features begin ......
add stats features end ......
time lapsing 0.284596920013 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0296261310577 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0576031208038 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0139520168304 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.56099486351 s 

add stats features begin ......
add stats features end ......
time lapsing 0.138839960098 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0600957870483 s 

add stats features begin ......
add stats features end ......
time lapsing 1.72538399696 s 

tr.size() 659269
te.size() 251864
[from_start ef21086] sub:try poi_dd_rank
 2 files changed, 30 insertions(+), 33 deletions(-)
########### sub: rm area id ###########
add stats features begin ......
add stats features end ......
time lapsing 0.229958772659 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0235118865967 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0490491390228 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00703406333923 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.420527935028 s 

add stats features begin ......
add stats features end ......
time lapsing 0.924245834351 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0646631717682 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0474910736084 s 

tr.size() 659269
te.size() 251864
features,length 62, ['10min', 'area_id_area_id#hour#minute___arriveshop_cost_mean', '_10min_deliverying_order_num', 'poi_agg_poi_id___mean_box_total_value', 'poi_lng_bin', 'area_id_area_id#hour#minute___arriveshop_cost_std', 'poi_agg_poi_id___mean_delivery_distance', 'bill_number_per_rider', 'poi_agg_poi_id___coor_count', 'customer_latitude', 'lasthour_agg_poi_id___coor_count', 'poi_agg_poi_id___mean_food_total_value', 'poi_agg_poi_id___arrive_guest_avg_speed_std', 'poi_agg_poi_id___mean_arrive_guest_cost', 'lasthour_agg_poi_id___std_arriveshop_cost', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id___mean_arriveshop_cost', 'cst_lng_bin', 'lasthour_agg_poi_id___mean_delivery_distance', 'lasthour_agg_poi_id___avg_speed_mean', 'poi_agg_poi_id___std_arriveshop_cost', 'customer_longitude', 'poi_lat', 'lasthour_agg_poi_id___std_fetch_cost', 'area_busy_coef', 'waiting_order_num', 'poi_agg_poi_id___avg_speed_mean', 'direction', 'poi_lng', 'poi_agg_poi_id___std_arrive_guest_cost', 'poi_agg_poi_id___mean_dd', 'lasthour_agg_poi_id___mean_arrive_guest_cost', 'poi_agg_poi_id___std_dd', 'lasthour_agg_poi_id___mean_food_total_value', 'lasthour_agg_poi_id___mean_box_total_value', 'area_id_area_id#hour#minute___food_total_value_sum', 'lasthour_agg_poi_id___avg_speed_std', 'food_total_value', 'lasthour_agg_poi_id___std_dd', 'lasthour_agg_poi_id___mean_fetch_cost', 'poi_lat_bin', 'food_num', 'poi_agg_poi_id___std_fetch_cost', 'lasthour_agg_poi_id__arrive_guest_avg_speed_mean', 'poi_agg_poi_id___arrive_guest_avg_speed_mean', 'poi_id', '_10min_notbusy_working_rider_num', 'lasthour_agg_poi_id___std_arrive_guest_cost', 'poi_agg_poi_id___avg_speed_std', 'poi_agg_poi_id___mean_waiting_order_num', 'lasthour_agg_poi_id___mean_dd', 'prd_arrive_guest_time', 'lasthour_agg_poi_id___mean_waiting_order_num', 'box_total_value', 'weekday', '_10min_not_fetched_order_num', '15min', 'lasthour_agg_poi_id___mean_arriveshop_cost', 'cst_lat_bin', 'poi_agg_poi_id___mean_fetch_cost', 'lasthour_agg_poi_id___arrive_guest_avg_speed_std']
Start training...
[LightGBM] [Info] Total Bins 13352
[LightGBM] [Info] Number of data: 659269, number of used features: 62
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1942, 6580, 7095, 684, 1468, 7385, 2184, 7428, 1936, 6044, 1789, 2193, 2222, 1897, 2076, 8661, 6752, 2163, 4548, 2139, 1923, 2146, 4457, 1741, 2071, 9263, 5485, 1808, 8217, 1277, 2100, 2517, 2041, 2271, 2269, 684, 6904, 2090, 8652, 1969, 1975, 862, 450, 2293, 2041, 2009, 2174, 5154, 1840, 2211, 600, 2077, 8254, 479, 2722, 2987, 7280, 1024, 2274, 3596, 2284, 2343])
                                              feature  importances
42                                           food_num          450
53       lasthour_agg_poi_id___mean_waiting_order_num          479
50            poi_agg_poi_id___mean_waiting_order_num          600
3               poi_agg_poi_id___mean_box_total_value          684
35         lasthour_agg_poi_id___mean_box_total_value          684
41                                        poi_lat_bin          862
57                                              15min         1024
29                                            poi_lng         1277
4                                         poi_lng_bin         1468
23                                            poi_lat         1741
10                   lasthour_agg_poi_id___coor_count         1789
27                    poi_agg_poi_id___avg_speed_mean         1808
48        lasthour_agg_poi_id___std_arrive_guest_cost         1840
13            poi_agg_poi_id___mean_arrive_guest_cost         1897
20               lasthour_agg_poi_id___avg_speed_mean         1923
8                         poi_agg_poi_id___coor_count         1936
0                                               10min         1942
39                       lasthour_agg_poi_id___std_dd         1969
40              lasthour_agg_poi_id___mean_fetch_cost         1975
45       poi_agg_poi_id___arrive_guest_avg_speed_mean         2009
32       lasthour_agg_poi_id___mean_arrive_guest_cost         2041
44   lasthour_agg_poi_id__arrive_guest_avg_speed_mean         2041
24               lasthour_agg_poi_id___std_fetch_cost         2071
14          lasthour_agg_poi_id___std_arriveshop_cost         2076
51                      lasthour_agg_poi_id___mean_dd         2077
37                lasthour_agg_poi_id___avg_speed_std         2090
30             poi_agg_poi_id___std_arrive_guest_cost         2100
19       lasthour_agg_poi_id___mean_delivery_distance         2139
21               poi_agg_poi_id___std_arriveshop_cost         2146
17              poi_agg_poi_id___mean_arriveshop_cost         2163
..                                                ...          ...
11             poi_agg_poi_id___mean_food_total_value         2193
49                     poi_agg_poi_id___avg_speed_std         2211
12        poi_agg_poi_id___arrive_guest_avg_speed_std         2222
34        lasthour_agg_poi_id___mean_food_total_value         2269
33                            poi_agg_poi_id___std_dd         2271
58         lasthour_agg_poi_id___mean_arriveshop_cost         2274
60                   poi_agg_poi_id___mean_fetch_cost         2284
43                    poi_agg_poi_id___std_fetch_cost         2293
61   lasthour_agg_poi_id___arrive_guest_avg_speed_std         2343
31                           poi_agg_poi_id___mean_dd         2517
54                                    box_total_value         2722
55                                            weekday         2987
59                                        cst_lat_bin         3596
22                                 customer_longitude         4457
18                                        cst_lng_bin         4548
47                   _10min_notbusy_working_rider_num         5154
26                                  waiting_order_num         5485
9                                   customer_latitude         6044
1   area_id_area_id#hour#minute___arriveshop_cost_...         6580
16                           _10min_working_rider_num         6752
36  area_id_area_id#hour#minute___food_total_value...         6904
2                        _10min_deliverying_order_num         7095
56                       _10min_not_fetched_order_num         7280
5   area_id_area_id#hour#minute___arriveshop_cost_std         7385
7                               bill_number_per_rider         7428
28                                          direction         8217
52                              prd_arrive_guest_time         8254
38                                   food_total_value         8652
15                                  delivery_distance         8661
25                                     area_busy_coef         9263

[62 rows x 2 columns]
[from_start 09a9866] sub:rm area id
 3 files changed, 132 insertions(+), 74 deletions(-)
########### sub: back area id ###########
add stats features begin ......
add stats features end ......
time lapsing 0.237754106522 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0221040248871 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0421090126038 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00922918319702 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.351888895035 s 

add stats features begin ......
add stats features end ......
time lapsing 0.861783981323 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0664930343628 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0511250495911 s 

tr.size() 659269
te.size() 251864
features,length 63, ['area_id', '10min', 'area_id_area_id#hour#minute___arriveshop_cost_mean', '_10min_deliverying_order_num', 'poi_agg_poi_id___mean_box_total_value', 'poi_lng_bin', 'area_id_area_id#hour#minute___arriveshop_cost_std', 'poi_agg_poi_id___mean_delivery_distance', 'bill_number_per_rider', 'poi_agg_poi_id___coor_count', 'customer_latitude', 'lasthour_agg_poi_id___coor_count', 'poi_agg_poi_id___mean_food_total_value', 'poi_agg_poi_id___arrive_guest_avg_speed_std', 'poi_agg_poi_id___mean_arrive_guest_cost', 'lasthour_agg_poi_id___std_arriveshop_cost', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id___mean_arriveshop_cost', 'cst_lng_bin', 'lasthour_agg_poi_id___mean_delivery_distance', 'lasthour_agg_poi_id___avg_speed_mean', 'poi_agg_poi_id___std_arriveshop_cost', 'customer_longitude', 'poi_lat', 'lasthour_agg_poi_id___std_fetch_cost', 'area_busy_coef', 'waiting_order_num', 'poi_agg_poi_id___avg_speed_mean', 'direction', 'poi_lng', 'poi_agg_poi_id___std_arrive_guest_cost', 'poi_agg_poi_id___mean_dd', 'lasthour_agg_poi_id___mean_arrive_guest_cost', 'poi_agg_poi_id___std_dd', 'lasthour_agg_poi_id___mean_food_total_value', 'lasthour_agg_poi_id___mean_box_total_value', 'area_id_area_id#hour#minute___food_total_value_sum', 'lasthour_agg_poi_id___avg_speed_std', 'food_total_value', 'lasthour_agg_poi_id___std_dd', 'lasthour_agg_poi_id___mean_fetch_cost', 'poi_lat_bin', 'food_num', 'poi_agg_poi_id___std_fetch_cost', 'lasthour_agg_poi_id__arrive_guest_avg_speed_mean', 'poi_agg_poi_id___arrive_guest_avg_speed_mean', 'poi_id', '_10min_notbusy_working_rider_num', 'lasthour_agg_poi_id___std_arrive_guest_cost', 'poi_agg_poi_id___avg_speed_std', 'poi_agg_poi_id___mean_waiting_order_num', 'lasthour_agg_poi_id___mean_dd', 'prd_arrive_guest_time', 'lasthour_agg_poi_id___mean_waiting_order_num', 'box_total_value', 'weekday', '_10min_not_fetched_order_num', '15min', 'lasthour_agg_poi_id___mean_arriveshop_cost', 'cst_lat_bin', 'poi_agg_poi_id___mean_fetch_cost', 'lasthour_agg_poi_id___arrive_guest_avg_speed_std']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [276, 1889, 6496, 7166, 624, 1636, 6783, 2086, 8002, 1950, 5526, 1754, 2209, 2038, 1969, 2200, 8928, 5939, 2005, 4932, 2131, 1811, 2159, 4260, 1909, 1903, 9301, 5417, 1766, 8445, 1314, 2066, 2491, 1980, 2153, 2357, 697, 6824, 2035, 8252, 1934, 2165, 845, 487, 2338, 2195, 1836, 2195, 5585, 1995, 2163, 634, 2223, 8358, 444, 2788, 2970, 7061, 1170, 2241, 3940, 2266, 2488])
                                              feature  importances
0                                             area_id          276
54       lasthour_agg_poi_id___mean_waiting_order_num          444
43                                           food_num          487
4               poi_agg_poi_id___mean_box_total_value          624
51            poi_agg_poi_id___mean_waiting_order_num          634
36         lasthour_agg_poi_id___mean_box_total_value          697
42                                        poi_lat_bin          845
58                                              15min         1170
30                                            poi_lng         1314
5                                         poi_lng_bin         1636
11                   lasthour_agg_poi_id___coor_count         1754
28                    poi_agg_poi_id___avg_speed_mean         1766
21               lasthour_agg_poi_id___avg_speed_mean         1811
46       poi_agg_poi_id___arrive_guest_avg_speed_mean         1836
1                                               10min         1889
25               lasthour_agg_poi_id___std_fetch_cost         1903
24                                            poi_lat         1909
40                       lasthour_agg_poi_id___std_dd         1934
9                         poi_agg_poi_id___coor_count         1950
14            poi_agg_poi_id___mean_arrive_guest_cost         1969
33       lasthour_agg_poi_id___mean_arrive_guest_cost         1980
49        lasthour_agg_poi_id___std_arrive_guest_cost         1995
18              poi_agg_poi_id___mean_arriveshop_cost         2005
38                lasthour_agg_poi_id___avg_speed_std         2035
13        poi_agg_poi_id___arrive_guest_avg_speed_std         2038
31             poi_agg_poi_id___std_arrive_guest_cost         2066
7             poi_agg_poi_id___mean_delivery_distance         2086
20       lasthour_agg_poi_id___mean_delivery_distance         2131
34                            poi_agg_poi_id___std_dd         2153
22               poi_agg_poi_id___std_arriveshop_cost         2159
..                                                ...          ...
45   lasthour_agg_poi_id__arrive_guest_avg_speed_mean         2195
15          lasthour_agg_poi_id___std_arriveshop_cost         2200
12             poi_agg_poi_id___mean_food_total_value         2209
52                      lasthour_agg_poi_id___mean_dd         2223
59         lasthour_agg_poi_id___mean_arriveshop_cost         2241
61                   poi_agg_poi_id___mean_fetch_cost         2266
44                    poi_agg_poi_id___std_fetch_cost         2338
35        lasthour_agg_poi_id___mean_food_total_value         2357
62   lasthour_agg_poi_id___arrive_guest_avg_speed_std         2488
32                           poi_agg_poi_id___mean_dd         2491
55                                    box_total_value         2788
56                                            weekday         2970
60                                        cst_lat_bin         3940
23                                 customer_longitude         4260
19                                        cst_lng_bin         4932
27                                  waiting_order_num         5417
10                                  customer_latitude         5526
48                   _10min_notbusy_working_rider_num         5585
17                           _10min_working_rider_num         5939
2   area_id_area_id#hour#minute___arriveshop_cost_...         6496
6   area_id_area_id#hour#minute___arriveshop_cost_std         6783
37  area_id_area_id#hour#minute___food_total_value...         6824
57                       _10min_not_fetched_order_num         7061
3                        _10min_deliverying_order_num         7166
8                               bill_number_per_rider         8002
39                                   food_total_value         8252
53                              prd_arrive_guest_time         8358
29                                          direction         8445
16                                  delivery_distance         8928
26                                     area_busy_coef         9301

[63 rows x 2 columns]
[from_start 25c4de4] sub:back area id
 3 files changed, 29 insertions(+), 30 deletions(-)
########### sub: 5 min, rain ###########
add stats features begin ......
add stats features end ......
time lapsing 0.212525129318 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0171201229095 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0407900810242 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00642800331116 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.38499712944 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0684680938721 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0547370910645 s 

add stats features begin ......
add stats features end ......
time lapsing 1.03475213051 s 

tr.size() 659269
te.size() 251864
features,length 65, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lat', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'is_rain', '5min', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_mean_food_total_value']
Start training...
[LightGBM] [Info] Total Bins 13378
[LightGBM] [Info] Number of data: 659269, number of used features: 65
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1893, 265, 1811, 8241, 2354, 1843, 2186, 1487, 1270, 2029, 2157, 5905, 7734, 6688, 6077, 731, 557, 2008, 653, 7569, 5907, 2040, 6671, 1985, 4502, 2197, 436, 6447, 2274, 2161, 1312, 3712, 1962, 1961, 5409, 7115, 8163, 1220, 2015, 1759, 2007, 1792, 4658, 91, 2540, 2395, 1609, 494, 2158, 2129, 2052, 2140, 1956, 9005, 8336, 2123, 2132, 2819, 2396, 3078, 399, 2052, 8832, 2042, 2059])
                                              feature  importances
43                                            is_rain           91
1                                             area_id          265
60                                              15min          399
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          436
47                                           food_num          494
16                poi_agg_poi_id_mean_box_total_value          557
18              poi_agg_poi_id_mean_waiting_order_num          653
15       lasthour_poi_agg_poi_id_mean_box_total_value          731
37                                            poi_lng         1220
8                                         poi_lat_bin         1270
30                                            poi_lat         1312
7                                         poi_lng_bin         1487
46                      poi_agg__avg_speed_meanpoi_id         1609
39                          poi_agg_poi_id_coor_count         1759
41              poi_agg_poi_id_mean_arrive_guest_cost         1792
2                                               10min         1811
5              lasthour_poi_agg__avg_speed_meanpoi_id         1843
0                  lasthour_poi_agg_poi_id_coor_count         1893
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1956
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         1961
32               poi_agg_poi_id_std_arrive_guest_cost         1962
23              lasthour_poi_agg__avg_speed_stdpoi_id         1985
40                     lasthour_poi_agg_poi_id_std_dd         2007
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2008
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2015
9                 poi_agg_poi_id_mean_arriveshop_cost         2029
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         2040
63              poi_agg_poi_id_mean_delivery_distance         2042
61     lasthour_poi_agg_poi_id_mean_delivery_distance         2052
50             lasthour_poi_agg_poi_id_std_fetch_cost         2052
..                                                ...          ...
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2157
48                       poi_agg__avg_speed_stdpoi_id         2158
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2161
6                               poi_agg_poi_id_std_dd         2186
25                      poi_agg_poi_id_std_fetch_cost         2197
28                    lasthour_poi_agg_poi_id_mean_dd         2274
4                poi_agg_poi_id_mean_food_total_value         2354
45                     poi_agg_poi_id_mean_fetch_cost         2395
58                             poi_agg_poi_id_mean_dd         2396
44                                               5min         2540
57                                    box_total_value         2819
59                                            weekday         3078
31                                        cst_lat_bin         3712
24                                        cst_lng_bin         4502
42                                 customer_longitude         4658
34                                  waiting_order_num         5409
11                                  customer_latitude         5905
20                           _10min_working_rider_num         5907
14                   _10min_notbusy_working_rider_num         6077
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6447
22   area_id_area_id#hour#minute_food_total_value_sum         6671
13    area_id_area_id#hour#minute_arriveshop_cost_std         6688
35                       _10min_deliverying_order_num         7115
19                                  delivery_distance         7569
12                       _10min_not_fetched_order_num         7734
36                                          direction         8163
3                               bill_number_per_rider         8241
54                              prd_arrive_guest_time         8336
62                                     area_busy_coef         8832
53                                   food_total_value         9005

[65 rows x 2 columns]
[from_start 83e2d14] sub:5 min, rain
 1 file changed, 2 insertions(+)
########### sub: 5 min ###########
add stats features begin ......
add stats features end ......
time lapsing 0.211220979691 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0208451747894 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0414249897003 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00666618347168 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.343244791031 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0692410469055 s 

add stats features begin ......
add stats features end ......
time lapsing 0.043673992157 s 

add stats features begin ......
add stats features end ......
time lapsing 1.25340795517 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lat', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', '5min', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_mean_food_total_value']
Start training...
[LightGBM] [Info] Total Bins 13376
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1822, 250, 1786, 7788, 2106, 1930, 2237, 1469, 1271, 2011, 1982, 6175, 7660, 6717, 6089, 705, 581, 2074, 662, 8590, 5874, 1884, 6501, 2008, 4876, 2284, 415, 6464, 2338, 2124, 1257, 3743, 1751, 2219, 5487, 6799, 8478, 1352, 1983, 2023, 1782, 4504, 1649, 2491, 2283, 1579, 477, 2358, 2082, 1951, 2133, 1930, 9227, 7629, 1905, 2387, 2847, 2397, 2908, 397, 1939, 9288, 1916, 2176])
                                              feature  importances
1                                             area_id          250
59                                              15min          397
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          415
46                                           food_num          477
16                poi_agg_poi_id_mean_box_total_value          581
18              poi_agg_poi_id_mean_waiting_order_num          662
15       lasthour_poi_agg_poi_id_mean_box_total_value          705
30                                            poi_lat         1257
8                                         poi_lat_bin         1271
37                                            poi_lng         1352
7                                         poi_lng_bin         1469
45                      poi_agg__avg_speed_meanpoi_id         1579
42                          poi_agg_poi_id_coor_count         1649
32               poi_agg_poi_id_std_arrive_guest_cost         1751
40              poi_agg_poi_id_mean_arrive_guest_cost         1782
2                                               10min         1786
0                  lasthour_poi_agg_poi_id_coor_count         1822
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1884
54                 poi_agg_poi_id_std_arriveshop_cost         1905
62              poi_agg_poi_id_mean_delivery_distance         1916
5              lasthour_poi_agg__avg_speed_meanpoi_id         1930
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1930
60     lasthour_poi_agg_poi_id_mean_delivery_distance         1939
49             lasthour_poi_agg_poi_id_std_fetch_cost         1951
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1982
38            lasthour_poi_agg_poi_id_mean_fetch_cost         1983
23              lasthour_poi_agg__avg_speed_stdpoi_id         2008
9                 poi_agg_poi_id_mean_arriveshop_cost         2011
39                     lasthour_poi_agg_poi_id_std_dd         2023
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2074
..                                                ...          ...
63      lasthour_poi_agg_poi_id_mean_food_total_value         2176
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2219
6                               poi_agg_poi_id_std_dd         2237
44                     poi_agg_poi_id_mean_fetch_cost         2283
25                      poi_agg_poi_id_std_fetch_cost         2284
28                    lasthour_poi_agg_poi_id_mean_dd         2338
47                       poi_agg__avg_speed_stdpoi_id         2358
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2387
57                             poi_agg_poi_id_mean_dd         2397
43                                               5min         2491
56                                    box_total_value         2847
58                                            weekday         2908
31                                        cst_lat_bin         3743
41                                 customer_longitude         4504
24                                        cst_lng_bin         4876
34                                  waiting_order_num         5487
20                           _10min_working_rider_num         5874
14                   _10min_notbusy_working_rider_num         6089
11                                  customer_latitude         6175
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6464
22   area_id_area_id#hour#minute_food_total_value_sum         6501
13    area_id_area_id#hour#minute_arriveshop_cost_std         6717
35                       _10min_deliverying_order_num         6799
53                              prd_arrive_guest_time         7629
12                       _10min_not_fetched_order_num         7660
3                               bill_number_per_rider         7788
36                                          direction         8478
19                                  delivery_distance         8590
52                                   food_total_value         9227
61                                     area_busy_coef         9288

[64 rows x 2 columns]
[from_start b909817] sub:5 min
 2 files changed, 33 insertions(+), 36 deletions(-)
########### sub: only rain ###########
add stats features begin ......
add stats features end ......
time lapsing 0.210956811905 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0168581008911 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0391521453857 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00671291351318 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.371427059174 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0769519805908 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0473649501801 s 

add stats features begin ......
add stats features end ......
time lapsing 0.934491157532 s 

tr.size() 659269
te.size() 251864
features,length 65, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lat', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'is_rain', '5min', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_mean_food_total_value']
Start training...
[LightGBM] [Info] Total Bins 13378
[LightGBM] [Info] Number of data: 659269, number of used features: 65
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1893, 265, 1811, 8241, 2354, 1843, 2186, 1487, 1270, 2029, 2157, 5905, 7734, 6688, 6077, 731, 557, 2008, 653, 7569, 5907, 2040, 6671, 1985, 4502, 2197, 436, 6447, 2274, 2161, 1312, 3712, 1962, 1961, 5409, 7115, 8163, 1220, 2015, 1759, 2007, 1792, 4658, 91, 2540, 2395, 1609, 494, 2158, 2129, 2052, 2140, 1956, 9005, 8336, 2123, 2132, 2819, 2396, 3078, 399, 2052, 8832, 2042, 2059])
                                              feature  importances
43                                            is_rain           91
1                                             area_id          265
60                                              15min          399
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          436
47                                           food_num          494
16                poi_agg_poi_id_mean_box_total_value          557
18              poi_agg_poi_id_mean_waiting_order_num          653
15       lasthour_poi_agg_poi_id_mean_box_total_value          731
37                                            poi_lng         1220
8                                         poi_lat_bin         1270
30                                            poi_lat         1312
7                                         poi_lng_bin         1487
46                      poi_agg__avg_speed_meanpoi_id         1609
39                          poi_agg_poi_id_coor_count         1759
41              poi_agg_poi_id_mean_arrive_guest_cost         1792
2                                               10min         1811
5              lasthour_poi_agg__avg_speed_meanpoi_id         1843
0                  lasthour_poi_agg_poi_id_coor_count         1893
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1956
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         1961
32               poi_agg_poi_id_std_arrive_guest_cost         1962
23              lasthour_poi_agg__avg_speed_stdpoi_id         1985
40                     lasthour_poi_agg_poi_id_std_dd         2007
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2008
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2015
9                 poi_agg_poi_id_mean_arriveshop_cost         2029
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         2040
63              poi_agg_poi_id_mean_delivery_distance         2042
61     lasthour_poi_agg_poi_id_mean_delivery_distance         2052
50             lasthour_poi_agg_poi_id_std_fetch_cost         2052
..                                                ...          ...
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2157
48                       poi_agg__avg_speed_stdpoi_id         2158
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2161
6                               poi_agg_poi_id_std_dd         2186
25                      poi_agg_poi_id_std_fetch_cost         2197
28                    lasthour_poi_agg_poi_id_mean_dd         2274
4                poi_agg_poi_id_mean_food_total_value         2354
45                     poi_agg_poi_id_mean_fetch_cost         2395
58                             poi_agg_poi_id_mean_dd         2396
44                                               5min         2540
57                                    box_total_value         2819
59                                            weekday         3078
31                                        cst_lat_bin         3712
24                                        cst_lng_bin         4502
42                                 customer_longitude         4658
34                                  waiting_order_num         5409
11                                  customer_latitude         5905
20                           _10min_working_rider_num         5907
14                   _10min_notbusy_working_rider_num         6077
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6447
22   area_id_area_id#hour#minute_food_total_value_sum         6671
13    area_id_area_id#hour#minute_arriveshop_cost_std         6688
35                       _10min_deliverying_order_num         7115
19                                  delivery_distance         7569
12                       _10min_not_fetched_order_num         7734
36                                          direction         8163
3                               bill_number_per_rider         8241
54                              prd_arrive_guest_time         8336
62                                     area_busy_coef         8832
53                                   food_total_value         9005

[65 rows x 2 columns]
[from_start 6795017] sub:only rain
 2 files changed, 29 insertions(+), 27 deletions(-)
########### sub: only rain ###########
add stats features begin ......
add stats features end ......
time lapsing 0.197996139526 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0183229446411 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0435361862183 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00798583030701 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.371996879578 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0773959159851 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0528969764709 s 

add stats features begin ......
add stats features end ......
time lapsing 0.965409040451 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'is_rain', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13366
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1792, 279, 2100, 7913, 2134, 1828, 2400, 1495, 1243, 2167, 1993, 6041, 7561, 6990, 6334, 702, 537, 2114, 680, 8585, 5791, 1928, 6903, 2059, 4830, 2164, 405, 6821, 2273, 2128, 2126, 3711, 1922, 2144, 5491, 7071, 8017, 1237, 2020, 1640, 2049, 1836, 4314, 114, 1402, 2433, 1686, 493, 2199, 2088, 2055, 2012, 2019, 8517, 8316, 2086, 2360, 2833, 2326, 3122, 1005, 2191, 8985, 1990])
                                              feature  importances
43                                            is_rain          114
1                                             area_id          279
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          405
47                                           food_num          493
16                poi_agg_poi_id_mean_box_total_value          537
18              poi_agg_poi_id_mean_waiting_order_num          680
15       lasthour_poi_agg_poi_id_mean_box_total_value          702
60                                              15min         1005
37                                            poi_lng         1237
8                                         poi_lat_bin         1243
44                                            poi_lat         1402
7                                         poi_lng_bin         1495
39                          poi_agg_poi_id_coor_count         1640
46                      poi_agg__avg_speed_meanpoi_id         1686
0                  lasthour_poi_agg_poi_id_coor_count         1792
5              lasthour_poi_agg__avg_speed_meanpoi_id         1828
41              poi_agg_poi_id_mean_arrive_guest_cost         1836
32               poi_agg_poi_id_std_arrive_guest_cost         1922
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1928
63              poi_agg_poi_id_mean_delivery_distance         1990
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1993
51       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2012
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2019
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2020
40                     lasthour_poi_agg_poi_id_std_dd         2049
50             lasthour_poi_agg_poi_id_std_fetch_cost         2055
23              lasthour_poi_agg__avg_speed_stdpoi_id         2059
55                 poi_agg_poi_id_std_arriveshop_cost         2086
49                                             poi_id         2088
2                                               10min         2100
..                                                ...          ...
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2144
25                      poi_agg_poi_id_std_fetch_cost         2164
9                 poi_agg_poi_id_mean_arriveshop_cost         2167
61     lasthour_poi_agg_poi_id_mean_delivery_distance         2191
48                       poi_agg__avg_speed_stdpoi_id         2199
28                    lasthour_poi_agg_poi_id_mean_dd         2273
58                             poi_agg_poi_id_mean_dd         2326
56  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2360
6                               poi_agg_poi_id_std_dd         2400
45                     poi_agg_poi_id_mean_fetch_cost         2433
57                                    box_total_value         2833
59                                            weekday         3122
31                                        cst_lat_bin         3711
42                                 customer_longitude         4314
24                                        cst_lng_bin         4830
34                                  waiting_order_num         5491
20                           _10min_working_rider_num         5791
11                                  customer_latitude         6041
14                   _10min_notbusy_working_rider_num         6334
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6821
22   area_id_area_id#hour#minute_food_total_value_sum         6903
13    area_id_area_id#hour#minute_arriveshop_cost_std         6990
35                       _10min_deliverying_order_num         7071
12                       _10min_not_fetched_order_num         7561
3                               bill_number_per_rider         7913
36                                          direction         8017
54                              prd_arrive_guest_time         8316
53                                   food_total_value         8517
19                                  delivery_distance         8585
62                                     area_busy_coef         8985

[64 rows x 2 columns]
[from_start 2ff14c5] sub:only rain
 2 files changed, 17 insertions(+), 21 deletions(-)
########### sub: back ###########
add stats features begin ......
add stats features end ......
time lapsing 0.220905065536 s 

add stats features begin ......
add stats features end ......
time lapsing 0.023041009903 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0409030914307 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00670599937439 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.37047791481 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0738160610199 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0454180240631 s 

add stats features begin ......
add stats features end ......
time lapsing 1.06449913979 s 

tr.size() 659269
te.size() 251864
features,length 63, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1863, 272, 2086, 8028, 2182, 2075, 2202, 1556, 1384, 2050, 2105, 5465, 7672, 6647, 6408, 727, 641, 2002, 624, 8440, 5777, 1840, 7238, 1858, 4987, 2090, 455, 6519, 2305, 2263, 2319, 3808, 2045, 2085, 5267, 7163, 8778, 1294, 2207, 2080, 1829, 4252, 1652, 1361, 2385, 1798, 421, 2190, 2091, 1995, 2158, 1991, 8552, 8348, 1951, 2152, 2807, 2308, 3140, 1061, 2081, 8569, 2101])
                                              feature  importances
1                                             area_id          272
46                                           food_num          421
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          455
18              poi_agg_poi_id_mean_waiting_order_num          624
16                poi_agg_poi_id_mean_box_total_value          641
15       lasthour_poi_agg_poi_id_mean_box_total_value          727
59                                              15min         1061
37                                            poi_lng         1294
43                                            poi_lat         1361
8                                         poi_lat_bin         1384
7                                         poi_lng_bin         1556
42                          poi_agg_poi_id_coor_count         1652
45                      poi_agg__avg_speed_meanpoi_id         1798
40              poi_agg_poi_id_mean_arrive_guest_cost         1829
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1840
23              lasthour_poi_agg__avg_speed_stdpoi_id         1858
0                  lasthour_poi_agg_poi_id_coor_count         1863
54                 poi_agg_poi_id_std_arriveshop_cost         1951
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1991
49             lasthour_poi_agg_poi_id_std_fetch_cost         1995
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2002
32               poi_agg_poi_id_std_arrive_guest_cost         2045
9                 poi_agg_poi_id_mean_arriveshop_cost         2050
5              lasthour_poi_agg__avg_speed_meanpoi_id         2075
39                     lasthour_poi_agg_poi_id_std_dd         2080
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2081
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2085
2                                               10min         2086
25                      poi_agg_poi_id_std_fetch_cost         2090
48                                             poi_id         2091
..                                                ...          ...
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2158
4                poi_agg_poi_id_mean_food_total_value         2182
47                       poi_agg__avg_speed_stdpoi_id         2190
6                               poi_agg_poi_id_std_dd         2202
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2207
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2263
28                    lasthour_poi_agg_poi_id_mean_dd         2305
57                             poi_agg_poi_id_mean_dd         2308
30      lasthour_poi_agg_poi_id_mean_food_total_value         2319
44                     poi_agg_poi_id_mean_fetch_cost         2385
56                                    box_total_value         2807
58                                            weekday         3140
31                                        cst_lat_bin         3808
41                                 customer_longitude         4252
24                                        cst_lng_bin         4987
34                                  waiting_order_num         5267
11                                  customer_latitude         5465
20                           _10min_working_rider_num         5777
14                   _10min_notbusy_working_rider_num         6408
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6519
13    area_id_area_id#hour#minute_arriveshop_cost_std         6647
35                       _10min_deliverying_order_num         7163
22   area_id_area_id#hour#minute_food_total_value_sum         7238
12                       _10min_not_fetched_order_num         7672
3                               bill_number_per_rider         8028
53                              prd_arrive_guest_time         8348
19                                  delivery_distance         8440
52                                   food_total_value         8552
61                                     area_busy_coef         8569
36                                          direction         8778

[63 rows x 2 columns]
[from_start 0b777c2] sub:back
 2 files changed, 20 insertions(+), 20 deletions(-)
########### sub: rm 15min###########
[from_start 3526a42] sub:rm 15min
 4 files changed, 33 insertions(+), 32 deletions(-)
########### sub: pick + drop ###########
add stats features begin ......
add stats features end ......
time lapsing 0.22763800621 s 

add stats features begin ......
add stats features end ......
time lapsing 0.019739151001 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0423789024353 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00688004493713 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.371912002563 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0727849006653 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0511829853058 s 

add stats features begin ......
add stats features end ......
time lapsing 1.03631091118 s 

add stats features begin ......
add stats features end ......
time lapsing 0.437670946121 s 

tr.size() 659269
te.size() 251864
features,length 68, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'cluster_agg_pickup_cluster#dropoff_cluster_arrive_guest_cost_std', 'poi_agg_poi_id_coor_count', 'weekday', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'cluster_agg_pickup_cluster#dropoff_cluster_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'poi_agg_poi_id_mean_arriveshop_cost', 'poi_lng', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', '10min', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cluster_agg_pickup_cluster#dropoff_cluster_arriveshop_cost_mean', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cluster_agg_pickup_cluster#dropoff_cluster_aarrive_guest_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'poi_lat_bin', 'food_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'cluster_agg_pickup_cluster#dropoff_cluster_food_total_value_sum', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'cst_lat_bin', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14621
[LightGBM] [Info] Number of data: 659269, number of used features: 68
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1807, 245, 2979, 1693, 2895, 7281, 1774, 2126, 1257, 2874, 6070, 1732, 1056, 4922, 7735, 6873, 2082, 1808, 655, 2073, 613, 5232, 1680, 1850, 3962, 2082, 2041, 6841, 3649, 1843, 508, 2597, 1941, 1866, 4919, 7634, 7320, 2019, 1994, 407, 1799, 1013, 3036, 2013, 2071, 1408, 2098, 1587, 727, 462, 1825, 1923, 1781, 2022, 8320, 7560, 1861, 3100, 2561, 2378, 3347, 8777, 6169, 1620, 7681, 2054, 1997, 1875])
                                              feature  importances
1                                             area_id          245
39     lasthour_poi_agg_poi_id_mean_waiting_order_num          407
49                                           food_num          462
30                poi_agg_poi_id_mean_box_total_value          508
20       lasthour_poi_agg_poi_id_mean_box_total_value          613
18              poi_agg_poi_id_mean_waiting_order_num          655
48                                        poi_lat_bin          727
41                                              15min         1013
12                                            poi_lng         1056
8                                         poi_lng_bin         1257
45                                            poi_lat         1408
47                      poi_agg__avg_speed_meanpoi_id         1587
63              poi_agg_poi_id_mean_arrive_guest_cost         1620
22                     lasthour_poi_agg_poi_id_std_dd         1680
3                           poi_agg_poi_id_coor_count         1693
11                poi_agg_poi_id_mean_arriveshop_cost         1732
6              lasthour_poi_agg__avg_speed_meanpoi_id         1774
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1781
40         poi_agg_poi_id_arrive_guest_avg_speed_mean         1799
0                  lasthour_poi_agg_poi_id_coor_count         1807
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1808
50                                             poi_id         1825
29          poi_agg_poi_id_arrive_guest_avg_speed_std         1843
23              lasthour_poi_agg__avg_speed_stdpoi_id         1850
56                 poi_agg_poi_id_std_arriveshop_cost         1861
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         1866
67              poi_agg_poi_id_mean_delivery_distance         1875
51             lasthour_poi_agg_poi_id_std_fetch_cost         1923
32               poi_agg_poi_id_std_arrive_guest_cost         1941
38            lasthour_poi_agg_poi_id_mean_fetch_cost         1994
..                                                ...          ...
16      lasthour_poi_agg_poi_id_mean_food_total_value         2082
25                      poi_agg_poi_id_std_fetch_cost         2082
46                     poi_agg_poi_id_mean_fetch_cost         2098
7                               poi_agg_poi_id_std_dd         2126
59                             poi_agg_poi_id_mean_dd         2378
58                                    box_total_value         2561
31  cluster_agg_pickup_cluster#dropoff_cluster_arr...         2597
9   cluster_agg_pickup_cluster#dropoff_cluster_arr...         2874
4                                             weekday         2895
2   cluster_agg_pickup_cluster#dropoff_cluster_arr...         2979
42  cluster_agg_pickup_cluster#dropoff_cluster_aar...         3036
57  cluster_agg_pickup_cluster#dropoff_cluster_foo...         3100
60                                        cst_lat_bin         3347
28                                 customer_longitude         3649
24                                        cst_lng_bin         3962
34                                  waiting_order_num         4919
13                                  customer_latitude         4922
21                           _10min_working_rider_num         5232
10                   _10min_notbusy_working_rider_num         6070
62   area_id_area_id#hour#minute_food_total_value_sum         6169
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6841
15    area_id_area_id#hour#minute_arriveshop_cost_std         6873
5                        _10min_deliverying_order_num         7281
36                                          direction         7320
55                              prd_arrive_guest_time         7560
35                              bill_number_per_rider         7634
64                                  delivery_distance         7681
14                       _10min_not_fetched_order_num         7735
54                                   food_total_value         8320
61                                     area_busy_coef         8777

[68 rows x 2 columns]
[from_start 2f46754] sub:pick + drop
 2 files changed, 42 insertions(+), 42 deletions(-)
########### sub: back ###########
add stats features begin ......
add stats features end ......
time lapsing 0.203305006027 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0178918838501 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0396671295166 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00663495063782 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.373049974442 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0845940113068 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0482552051544 s 

add stats features begin ......
add stats features end ......
time lapsing 0.986356973648 s 

tr.size() 659269
te.size() 251864
features,length 63, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1863, 272, 2086, 8028, 2182, 2075, 2202, 1556, 1384, 2050, 2105, 5465, 7672, 6647, 6408, 727, 641, 2002, 624, 8440, 5777, 1840, 7238, 1858, 4987, 2090, 455, 6519, 2305, 2263, 2319, 3808, 2045, 2085, 5267, 7163, 8778, 1294, 2207, 2080, 1829, 4252, 1652, 1361, 2385, 1798, 421, 2190, 2091, 1995, 2158, 1991, 8552, 8348, 1951, 2152, 2807, 2308, 3140, 1061, 2081, 8569, 2101])
                                              feature  importances
1                                             area_id          272
46                                           food_num          421
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          455
18              poi_agg_poi_id_mean_waiting_order_num          624
16                poi_agg_poi_id_mean_box_total_value          641
15       lasthour_poi_agg_poi_id_mean_box_total_value          727
59                                              15min         1061
37                                            poi_lng         1294
43                                            poi_lat         1361
8                                         poi_lat_bin         1384
7                                         poi_lng_bin         1556
42                          poi_agg_poi_id_coor_count         1652
45                      poi_agg__avg_speed_meanpoi_id         1798
40              poi_agg_poi_id_mean_arrive_guest_cost         1829
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1840
23              lasthour_poi_agg__avg_speed_stdpoi_id         1858
0                  lasthour_poi_agg_poi_id_coor_count         1863
54                 poi_agg_poi_id_std_arriveshop_cost         1951
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1991
49             lasthour_poi_agg_poi_id_std_fetch_cost         1995
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2002
32               poi_agg_poi_id_std_arrive_guest_cost         2045
9                 poi_agg_poi_id_mean_arriveshop_cost         2050
5              lasthour_poi_agg__avg_speed_meanpoi_id         2075
39                     lasthour_poi_agg_poi_id_std_dd         2080
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2081
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2085
2                                               10min         2086
25                      poi_agg_poi_id_std_fetch_cost         2090
48                                             poi_id         2091
..                                                ...          ...
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2158
4                poi_agg_poi_id_mean_food_total_value         2182
47                       poi_agg__avg_speed_stdpoi_id         2190
6                               poi_agg_poi_id_std_dd         2202
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2207
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2263
28                    lasthour_poi_agg_poi_id_mean_dd         2305
57                             poi_agg_poi_id_mean_dd         2308
30      lasthour_poi_agg_poi_id_mean_food_total_value         2319
44                     poi_agg_poi_id_mean_fetch_cost         2385
56                                    box_total_value         2807
58                                            weekday         3140
31                                        cst_lat_bin         3808
41                                 customer_longitude         4252
24                                        cst_lng_bin         4987
34                                  waiting_order_num         5267
11                                  customer_latitude         5465
20                           _10min_working_rider_num         5777
14                   _10min_notbusy_working_rider_num         6408
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6519
13    area_id_area_id#hour#minute_arriveshop_cost_std         6647
35                       _10min_deliverying_order_num         7163
22   area_id_area_id#hour#minute_food_total_value_sum         7238
12                       _10min_not_fetched_order_num         7672
3                               bill_number_per_rider         8028
53                              prd_arrive_guest_time         8348
19                                  delivery_distance         8440
52                                   food_total_value         8552
61                                     area_busy_coef         8569
36                                          direction         8778

[63 rows x 2 columns]
[from_start 03e78ed] sub:back
 9 files changed, 445 insertions(+), 278 deletions(-)
 create mode 100644 solutions/__init__.py
 create mode 100644 solutions/meituan_lasthour/stack/__init__.py
 create mode 100644 solutions/meituan_lasthour/stack/regression/__init__.py
########### sub: try log cosh ###########
add stats features begin ......
add stats features end ......
time lapsing 0.206049919128 s 

add stats features begin ......
add stats features end ......
time lapsing 0.019052028656 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0454540252686 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00686502456665 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.377970933914 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0745320320129 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0462598800659 s 

add stats features begin ......
add stats features end ......
time lapsing 1.23469996452 s 

tr.size() 659269
te.size() 251864
add stats features begin ......
add stats features end ......
time lapsing 0.194188117981 s 

add stats features begin ......
add stats features end ......
time lapsing 0.346376895905 s 

add stats features begin ......
add stats features end ......
time lapsing 0.397585868835 s 

add stats features begin ......
add stats features end ......
time lapsing 0.355948925018 s 

features,length 72, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_hourpoi_id_mean_food_total_value', 'cur_10min_deliverying_order_num', '_10min_not_fetched_order_num', '10min', 'cst_lng_bin', 'cur_10min_notbusy_working_rider_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cur_hourpoi_id_mean_delivery_distance', 'poi_agg_poi_id_std_fetch_cost', 'cur_10min_working_rider_num', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_hourpoi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_mean_dd', 'cur_hourpoi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'cur_hourpoi_id_mean_waiting_order_num', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14343
[LightGBM] [Info] Number of data: 283627, number of used features: 72
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1740, 153, 3270, 1413, 6341, 1747, 2030, 1111, 1054, 2225, 1872, 5623, 1907, 1379, 7047, 1607, 4661, 962, 6202, 2297, 2053, 454, 1875, 648, 6035, 2156, 2046, 1649, 2148, 470, 424, 5680, 4322, 2086, 442, 3523, 1847, 2056, 5906, 7889, 9255, 1030, 1929, 1914, 540, 358, 2006, 1163, 1001, 2236, 1783, 451, 439, 2089, 811, 2138, 1922, 1923, 1983, 9374, 9243, 1733, 4734, 3023, 2000, 9104, 5577, 1769, 8846, 2038, 1564, 1674])
                                              feature  importances
1                                             area_id          153
45                cur_hourpoi_id_mean_box_total_value          358
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          424
52                                           food_num          439
34                poi_agg_poi_id_mean_box_total_value          442
51              cur_hourpoi_id_mean_waiting_order_num          451
21              poi_agg_poi_id_mean_waiting_order_num          454
29                        cur_10min_working_rider_num          470
44                                              15min          540
23       lasthour_poi_agg_poi_id_mean_box_total_value          648
54                    cur_10min_not_fetched_order_num          811
17                cur_10min_notbusy_working_rider_num          962
48                                            poi_lat         1001
41                                            poi_lng         1030
8                                         poi_lat_bin         1054
7                                         poi_lng_bin         1111
47                          cur_hourpoi_id_coor_count         1163
13                    cur_10min_deliverying_order_num         1379
3                           poi_agg_poi_id_coor_count         1413
70               poi_agg_poi_id_mean_food_total_value         1564
15                                              10min         1607
27              cur_hourpoi_id_mean_delivery_distance         1649
71              poi_agg_poi_id_mean_delivery_distance         1674
61                 poi_agg_poi_id_std_arriveshop_cost         1733
0                  lasthour_poi_agg_poi_id_coor_count         1740
5              lasthour_poi_agg__avg_speed_meanpoi_id         1747
67              poi_agg_poi_id_mean_arrive_guest_cost         1769
50                      poi_agg__avg_speed_meanpoi_id         1783
36               poi_agg_poi_id_std_arrive_guest_cost         1847
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1872
..                                                ...          ...
20  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2053
37        lasthour_poi_agg_poi_id_std_arriveshop_cost         2056
33          poi_agg_poi_id_arrive_guest_avg_speed_std         2086
53                       poi_agg__avg_speed_stdpoi_id         2089
55                                             poi_id         2138
28                      poi_agg_poi_id_std_fetch_cost         2148
25                     lasthour_poi_agg_poi_id_std_dd         2156
9   lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2225
49                     poi_agg_poi_id_mean_fetch_cost         2236
19      lasthour_poi_agg_poi_id_mean_food_total_value         2297
63                                    box_total_value         3023
2                                             weekday         3270
35                                        cst_lat_bin         3523
32                                 customer_longitude         4322
16                                        cst_lng_bin         4661
62                   _10min_notbusy_working_rider_num         4734
66   area_id_area_id#hour#minute_food_total_value_sum         5577
11                                  customer_latitude         5623
31   area_id_area_id#hour#minute_arriveshop_cost_mean         5680
38                                  waiting_order_num         5906
24                           _10min_working_rider_num         6035
18    area_id_area_id#hour#minute_arriveshop_cost_std         6202
4                        _10min_deliverying_order_num         6341
14                       _10min_not_fetched_order_num         7047
39                              bill_number_per_rider         7889
68                                  delivery_distance         8846
65                                     area_busy_coef         9104
60                              prd_arrive_guest_time         9243
40                                          direction         9255
59                                   food_total_value         9374

[72 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.224981069565 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0184631347656 s 

add stats features begin ......
add stats features end ......
time lapsing 0.042228937149 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00703406333923 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.359012126923 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0679869651794 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0463700294495 s 

add stats features begin ......
add stats features end ......
time lapsing 1.11402606964 s 

tr.size() 659269
te.size() 251864
add stats features begin ......
add stats features end ......
time lapsing 0.176836967468 s 

add stats features begin ......
add stats features end ......
time lapsing 0.336333990097 s 

add stats features begin ......
add stats features end ......
time lapsing 0.140938043594 s 

add stats features begin ......
add stats features end ......
time lapsing 0.311951875687 s 

features,length 72, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_hourpoi_id_mean_food_total_value', 'cur_10min_deliverying_order_num', '_10min_not_fetched_order_num', '10min', 'cst_lng_bin', 'cur_10min_notbusy_working_rider_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cur_hourpoi_id_mean_delivery_distance', 'poi_agg_poi_id_std_fetch_cost', 'cur_10min_working_rider_num', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_hourpoi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_mean_dd', 'cur_hourpoi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'cur_hourpoi_id_mean_waiting_order_num', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14369
[LightGBM] [Info] Number of data: 659269, number of used features: 72
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1672, 216, 3050, 1371, 6565, 1732, 2135, 1490, 1144, 2162, 1926, 5360, 1838, 1589, 7000, 1706, 4668, 1203, 6563, 2167, 2085, 417, 1990, 628, 5975, 2036, 1912, 1745, 2012, 604, 347, 6042, 4330, 1968, 465, 3781, 1881, 2006, 5446, 8019, 8337, 1243, 1865, 2007, 522, 408, 2121, 1289, 1180, 2505, 1679, 472, 435, 2149, 910, 1993, 1874, 1909, 2029, 8541, 8578, 1828, 5134, 2836, 2125, 9226, 6380, 1787, 8188, 1981, 1549, 1674])
                                              feature  importances
1                                             area_id          216
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          347
45                cur_hourpoi_id_mean_box_total_value          408
21              poi_agg_poi_id_mean_waiting_order_num          417
52                                           food_num          435
34                poi_agg_poi_id_mean_box_total_value          465
51              cur_hourpoi_id_mean_waiting_order_num          472
44                                              15min          522
29                        cur_10min_working_rider_num          604
23       lasthour_poi_agg_poi_id_mean_box_total_value          628
54                    cur_10min_not_fetched_order_num          910
8                                         poi_lat_bin         1144
48                                            poi_lat         1180
17                cur_10min_notbusy_working_rider_num         1203
41                                            poi_lng         1243
47                          cur_hourpoi_id_coor_count         1289
3                           poi_agg_poi_id_coor_count         1371
7                                         poi_lng_bin         1490
70               poi_agg_poi_id_mean_food_total_value         1549
13                    cur_10min_deliverying_order_num         1589
0                  lasthour_poi_agg_poi_id_coor_count         1672
71              poi_agg_poi_id_mean_delivery_distance         1674
50                      poi_agg__avg_speed_meanpoi_id         1679
15                                              10min         1706
5              lasthour_poi_agg__avg_speed_meanpoi_id         1732
27              cur_hourpoi_id_mean_delivery_distance         1745
67              poi_agg_poi_id_mean_arrive_guest_cost         1787
61                 poi_agg_poi_id_std_arriveshop_cost         1828
12               cur_hourpoi_id_mean_food_total_value         1838
42            lasthour_poi_agg_poi_id_mean_fetch_cost         1865
..                                                ...          ...
58       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2029
25                     lasthour_poi_agg_poi_id_std_dd         2036
20  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2085
46                    lasthour_poi_agg_poi_id_mean_dd         2121
64                             poi_agg_poi_id_mean_dd         2125
6                               poi_agg_poi_id_std_dd         2135
53                       poi_agg__avg_speed_stdpoi_id         2149
9   lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2162
19      lasthour_poi_agg_poi_id_mean_food_total_value         2167
49                     poi_agg_poi_id_mean_fetch_cost         2505
63                                    box_total_value         2836
2                                             weekday         3050
35                                        cst_lat_bin         3781
32                                 customer_longitude         4330
16                                        cst_lng_bin         4668
62                   _10min_notbusy_working_rider_num         5134
11                                  customer_latitude         5360
38                                  waiting_order_num         5446
24                           _10min_working_rider_num         5975
31   area_id_area_id#hour#minute_arriveshop_cost_mean         6042
66   area_id_area_id#hour#minute_food_total_value_sum         6380
18    area_id_area_id#hour#minute_arriveshop_cost_std         6563
4                        _10min_deliverying_order_num         6565
14                       _10min_not_fetched_order_num         7000
39                              bill_number_per_rider         8019
68                                  delivery_distance         8188
40                                          direction         8337
59                                   food_total_value         8541
60                              prd_arrive_guest_time         8578
65                                     area_busy_coef         9226

[72 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.209351062775 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0181047916412 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0412909984589 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00701117515564 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.383736133575 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0746829509735 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0491170883179 s 

add stats features begin ......
add stats features end ......
time lapsing 1.04170298576 s 

tr.size() 659269
te.size() 251864
add stats features begin ......
add stats features end ......
time lapsing 0.173074007034 s 

add stats features begin ......
add stats features end ......
time lapsing 0.341041088104 s 

features,length 72, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_hourpoi_id_mean_food_total_value', 'cur_10min_deliverying_order_num', '_10min_not_fetched_order_num', '10min', 'cst_lng_bin', 'cur_10min_notbusy_working_rider_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cur_hourpoi_id_mean_delivery_distance', 'poi_agg_poi_id_std_fetch_cost', 'cur_10min_working_rider_num', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_hourpoi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_mean_dd', 'cur_hourpoi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'cur_hourpoi_id_mean_waiting_order_num', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14369
[LightGBM] [Info] Number of data: 659269, number of used features: 72
add stats features begin ......
add stats features end ......
time lapsing 0.225936174393 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0207679271698 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0427370071411 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00682878494263 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.36368894577 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0752539634705 s 

add stats features begin ......
add stats features end ......
time lapsing 0.045175075531 s 

add stats features begin ......
add stats features end ......
time lapsing 0.945424079895 s 

tr.size() 659269
te.size() 251864
add stats features begin ......
add stats features end ......
time lapsing 0.169487953186 s 

add stats features begin ......
add stats features end ......
time lapsing 0.348219156265 s 

features,length 68, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_hourpoi_id_mean_food_total_value', '_10min_not_fetched_order_num', '10min', 'cst_lng_bin', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cur_hourpoi_id_mean_delivery_distance', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_hourpoi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_mean_dd', 'cur_hourpoi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'cur_hourpoi_id_mean_waiting_order_num', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14189
[LightGBM] [Info] Number of data: 659269, number of used features: 68
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1709, 263, 2993, 1508, 7023, 1940, 2243, 1519, 1283, 1937, 1851, 5688, 1761, 7634, 2124, 4964, 6748, 2090, 1968, 446, 627, 6534, 1750, 1935, 1762, 2073, 2138, 7055, 4353, 1980, 489, 3788, 1990, 1978, 5391, 7863, 8189, 1301, 2019, 363, 1865, 1013, 343, 2008, 1184, 1202, 2207, 1652, 512, 527, 1972, 2058, 1733, 1926, 2051, 8683, 8404, 2001, 5336, 3032, 2362, 8810, 6104, 1711, 8535, 2082, 1807, 1610])
                                              feature  importances
1                                             area_id          263
42                cur_hourpoi_id_mean_box_total_value          343
39     lasthour_poi_agg_poi_id_mean_waiting_order_num          363
19              poi_agg_poi_id_mean_waiting_order_num          446
30                poi_agg_poi_id_mean_box_total_value          489
48              cur_hourpoi_id_mean_waiting_order_num          512
49                                           food_num          527
20       lasthour_poi_agg_poi_id_mean_box_total_value          627
41                                              15min         1013
44                          cur_hourpoi_id_coor_count         1184
45                                            poi_lat         1202
8                                         poi_lat_bin         1283
37                                            poi_lng         1301
3                           poi_agg_poi_id_coor_count         1508
7                                         poi_lng_bin         1519
67              poi_agg_poi_id_mean_delivery_distance         1610
47                      poi_agg__avg_speed_meanpoi_id         1652
0                  lasthour_poi_agg_poi_id_coor_count         1709
63              poi_agg_poi_id_mean_arrive_guest_cost         1711
52             lasthour_poi_agg_poi_id_std_fetch_cost         1733
22                     lasthour_poi_agg_poi_id_std_dd         1750
12               cur_hourpoi_id_mean_food_total_value         1761
24              cur_hourpoi_id_mean_delivery_distance         1762
66               poi_agg_poi_id_mean_food_total_value         1807
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1851
40         poi_agg_poi_id_arrive_guest_avg_speed_mean         1865
53      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1926
23              lasthour_poi_agg__avg_speed_stdpoi_id         1935
9                 poi_agg_poi_id_mean_arriveshop_cost         1937
5              lasthour_poi_agg__avg_speed_meanpoi_id         1940
..                                                ...          ...
54       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2051
51                                             poi_id         2058
25                      poi_agg_poi_id_std_fetch_cost         2073
65     lasthour_poi_agg_poi_id_mean_delivery_distance         2082
17      lasthour_poi_agg_poi_id_mean_food_total_value         2090
14                                              10min         2124
26  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2138
46                     poi_agg_poi_id_mean_fetch_cost         2207
6                               poi_agg_poi_id_std_dd         2243
60                             poi_agg_poi_id_mean_dd         2362
2                                             weekday         2993
59                                    box_total_value         3032
31                                        cst_lat_bin         3788
28                                 customer_longitude         4353
15                                        cst_lng_bin         4964
58                   _10min_notbusy_working_rider_num         5336
34                                  waiting_order_num         5391
11                                  customer_latitude         5688
62   area_id_area_id#hour#minute_food_total_value_sum         6104
21                           _10min_working_rider_num         6534
16    area_id_area_id#hour#minute_arriveshop_cost_std         6748
4                        _10min_deliverying_order_num         7023
27   area_id_area_id#hour#minute_arriveshop_cost_mean         7055
13                       _10min_not_fetched_order_num         7634
35                              bill_number_per_rider         7863
36                                          direction         8189
56                              prd_arrive_guest_time         8404
64                                  delivery_distance         8535
55                                   food_total_value         8683
61                                     area_busy_coef         8810

[68 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.204112052917 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0187530517578 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0412020683289 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00728607177734 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.366332054138 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0718529224396 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0478320121765 s 

add stats features begin ......
add stats features end ......
time lapsing 1.01476192474 s 

tr.size() 659269
te.size() 251864
add stats features begin ......
add stats features end ......
time lapsing 0.171844005585 s 

add stats features begin ......
add stats features end ......
time lapsing 0.327542066574 s 

features,length 67, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_10min_deliverying_order_num', '_10min_not_fetched_order_num', '10min', 'cur_10min_notbusy_working_rider_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', '_10min_working_rider_num', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'cur_10min_working_rider_num', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13544
[LightGBM] [Info] Number of data: 659269, number of used features: 67
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1908, 193, 3081, 1854, 6537, 1978, 2192, 1383, 1225, 2025, 1997, 5325, 1641, 7712, 1592, 1278, 6632, 2212, 2070, 599, 657, 6218, 2173, 2020, 4577, 2245, 598, 2372, 6706, 4402, 2030, 527, 3795, 2105, 2039, 5712, 7269, 7812, 1354, 2027, 420, 1841, 542, 2197, 2310, 1356, 2308, 1727, 480, 949, 2018, 1899, 1945, 2209, 9086, 8020, 2005, 5487, 2918, 2365, 8331, 7088, 1759, 8587, 2132, 2033, 1916])
                                              feature  importances
1                                             area_id          193
40     lasthour_poi_agg_poi_id_mean_waiting_order_num          420
48                                           food_num          480
31                poi_agg_poi_id_mean_box_total_value          527
42                                              15min          542
26                        cur_10min_working_rider_num          598
19              poi_agg_poi_id_mean_waiting_order_num          599
20       lasthour_poi_agg_poi_id_mean_box_total_value          657
49                    cur_10min_not_fetched_order_num          949
8                                         poi_lat_bin         1225
15                cur_10min_notbusy_working_rider_num         1278
38                                            poi_lng         1354
45                                            poi_lat         1356
7                                         poi_lng_bin         1383
14                                              10min         1592
12                    cur_10min_deliverying_order_num         1641
47                      poi_agg__avg_speed_meanpoi_id         1727
62              poi_agg_poi_id_mean_arrive_guest_cost         1759
41         poi_agg_poi_id_arrive_guest_avg_speed_mean         1841
3                           poi_agg_poi_id_coor_count         1854
51             lasthour_poi_agg_poi_id_std_fetch_cost         1899
0                  lasthour_poi_agg_poi_id_coor_count         1908
66              poi_agg_poi_id_mean_delivery_distance         1916
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1945
5              lasthour_poi_agg__avg_speed_meanpoi_id         1978
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1997
56                 poi_agg_poi_id_std_arriveshop_cost         2005
50                                             poi_id         2018
23              lasthour_poi_agg__avg_speed_stdpoi_id         2020
9                 poi_agg_poi_id_mean_arriveshop_cost         2025
..                                                ...          ...
22                     lasthour_poi_agg_poi_id_std_dd         2173
6                               poi_agg_poi_id_std_dd         2192
43                    lasthour_poi_agg_poi_id_mean_dd         2197
53       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2209
17      lasthour_poi_agg_poi_id_mean_food_total_value         2212
25                      poi_agg_poi_id_std_fetch_cost         2245
46                     poi_agg_poi_id_mean_fetch_cost         2308
44                       poi_agg__avg_speed_stdpoi_id         2310
59                             poi_agg_poi_id_mean_dd         2365
27  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2372
58                                    box_total_value         2918
2                                             weekday         3081
32                                        cst_lat_bin         3795
29                                 customer_longitude         4402
24                                        cst_lng_bin         4577
11                                  customer_latitude         5325
57                   _10min_notbusy_working_rider_num         5487
35                                  waiting_order_num         5712
21                           _10min_working_rider_num         6218
4                        _10min_deliverying_order_num         6537
16    area_id_area_id#hour#minute_arriveshop_cost_std         6632
28   area_id_area_id#hour#minute_arriveshop_cost_mean         6706
61   area_id_area_id#hour#minute_food_total_value_sum         7088
36                              bill_number_per_rider         7269
13                       _10min_not_fetched_order_num         7712
37                                          direction         7812
55                              prd_arrive_guest_time         8020
60                                     area_busy_coef         8331
63                                  delivery_distance         8587
54                                   food_total_value         9086

[67 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.224550008774 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0268850326538 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0477950572968 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00743293762207 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.412436008453 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0816459655762 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0539500713348 s 

add stats features begin ......
add stats features end ......
time lapsing 1.46426701546 s 

tr.size() 659269
te.size() 251864
features,length 63, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1828, 349, 1775, 7681, 2210, 1858, 2391, 1715, 1510, 2206, 1885, 5549, 7466, 6234, 6591, 640, 668, 1886, 763, 8780, 6001, 1945, 6893, 1838, 5033, 2141, 494, 6168, 2479, 2098, 2323, 3984, 2239, 2042, 5586, 6773, 8011, 1485, 2251, 2024, 1786, 4463, 1716, 1476, 2746, 1753, 509, 2539, 2033, 1886, 2246, 2011, 8324, 8223, 2043, 1950, 2761, 2812, 2950, 887, 2072, 8886, 2135])
                                              feature  importances
1                                             area_id          349
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          494
46                                           food_num          509
15       lasthour_poi_agg_poi_id_mean_box_total_value          640
16                poi_agg_poi_id_mean_box_total_value          668
18              poi_agg_poi_id_mean_waiting_order_num          763
59                                              15min          887
43                                            poi_lat         1476
37                                            poi_lng         1485
8                                         poi_lat_bin         1510
7                                         poi_lng_bin         1715
42                          poi_agg_poi_id_coor_count         1716
45                      poi_agg__avg_speed_meanpoi_id         1753
2                                               10min         1775
40              poi_agg_poi_id_mean_arrive_guest_cost         1786
0                  lasthour_poi_agg_poi_id_coor_count         1828
23              lasthour_poi_agg__avg_speed_stdpoi_id         1838
5              lasthour_poi_agg__avg_speed_meanpoi_id         1858
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1885
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1886
49             lasthour_poi_agg_poi_id_std_fetch_cost         1886
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1945
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1950
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2011
39                     lasthour_poi_agg_poi_id_std_dd         2024
48                                             poi_id         2033
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2042
54                 poi_agg_poi_id_std_arriveshop_cost         2043
60     lasthour_poi_agg_poi_id_mean_delivery_distance         2072
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2098
..                                                ...          ...
4                poi_agg_poi_id_mean_food_total_value         2210
32               poi_agg_poi_id_std_arrive_guest_cost         2239
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2246
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2251
30      lasthour_poi_agg_poi_id_mean_food_total_value         2323
6                               poi_agg_poi_id_std_dd         2391
28                    lasthour_poi_agg_poi_id_mean_dd         2479
47                       poi_agg__avg_speed_stdpoi_id         2539
44                     poi_agg_poi_id_mean_fetch_cost         2746
56                                    box_total_value         2761
57                             poi_agg_poi_id_mean_dd         2812
58                                            weekday         2950
31                                        cst_lat_bin         3984
41                                 customer_longitude         4463
24                                        cst_lng_bin         5033
11                                  customer_latitude         5549
34                                  waiting_order_num         5586
20                           _10min_working_rider_num         6001
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6168
13    area_id_area_id#hour#minute_arriveshop_cost_std         6234
14                   _10min_notbusy_working_rider_num         6591
35                       _10min_deliverying_order_num         6773
22   area_id_area_id#hour#minute_food_total_value_sum         6893
12                       _10min_not_fetched_order_num         7466
3                               bill_number_per_rider         7681
36                                          direction         8011
53                              prd_arrive_guest_time         8223
52                                   food_total_value         8324
19                                  delivery_distance         8780
61                                     area_busy_coef         8886

[63 rows x 2 columns]
########### sub: try fix ###########
add stats features begin ......
add stats features end ......
time lapsing 0.222623109818 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0210111141205 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0877981185913 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0184969902039 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.540715932846 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0883820056915 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0627579689026 s 

add stats features begin ......
add stats features end ......
time lapsing 1.40840601921 s 

features,length 67, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14351
[LightGBM] [Info] Number of data: 659269, number of used features: 67
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1848, 1789, 309, 3030, 1733, 6883, 1711, 2361, 1608, 1381, 2093, 1630, 5662, 7421, 1705, 6486, 1776, 1823, 724, 1856, 1955, 607, 2007, 1836, 1843, 4723, 2214, 1995, 480, 5831, 4409, 1783, 517, 4134, 2089, 2041, 5545, 6974, 7481, 1479, 1882, 1693, 933, 2077, 2456, 1494, 2714, 1564, 523, 1774, 1736, 1825, 2155, 8539, 8341, 1954, 6592, 2689, 3081, 5447, 8645, 6670, 1586, 8723, 1778, 1711, 1646])
                                              feature  importances
2                                             area_id          309
28     lasthour_poi_agg_poi_id_mean_waiting_order_num          480
32                poi_agg_poi_id_mean_box_total_value          517
48                                           food_num          523
21       lasthour_poi_agg_poi_id_mean_box_total_value          607
18              poi_agg_poi_id_mean_waiting_order_num          724
42                                              15min          933
9                                         poi_lat_bin         1381
39                                            poi_lng         1479
45                                            poi_lat         1494
47                      poi_agg__avg_speed_meanpoi_id         1564
62              poi_agg_poi_id_mean_arrive_guest_cost         1586
8                                         poi_lng_bin         1608
11     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1630
66              poi_agg_poi_id_mean_delivery_distance         1646
41         poi_agg_poi_id_arrive_guest_avg_speed_mean         1693
14                                              10min         1705
6              lasthour_poi_agg__avg_speed_meanpoi_id         1711
65               poi_agg_poi_id_mean_food_total_value         1711
4                           poi_agg_poi_id_coor_count         1733
50             lasthour_poi_agg_poi_id_std_fetch_cost         1736
49                                             poi_id         1774
16      lasthour_poi_agg_poi_id_mean_food_total_value         1776
64     lasthour_poi_agg_poi_id_mean_delivery_distance         1778
31          poi_agg_poi_id_arrive_guest_avg_speed_std         1783
1                  lasthour_poi_agg_poi_id_coor_count         1789
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1823
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1825
23                     lasthour_poi_agg_poi_id_std_dd         1836
24              lasthour_poi_agg__avg_speed_stdpoi_id         1843
..                                                ...          ...
35        lasthour_poi_agg_poi_id_std_arriveshop_cost         2041
43                    lasthour_poi_agg_poi_id_mean_dd         2077
34               poi_agg_poi_id_std_arrive_guest_cost         2089
10  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2093
52       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2155
26                      poi_agg_poi_id_std_fetch_cost         2214
7                               poi_agg_poi_id_std_dd         2361
44                       poi_agg__avg_speed_stdpoi_id         2456
57                                    box_total_value         2689
46                     poi_agg_poi_id_mean_fetch_cost         2714
3                                             weekday         3030
58                             poi_agg_poi_id_mean_dd         3081
33                                        cst_lat_bin         4134
30                                 customer_longitude         4409
25                                        cst_lng_bin         4723
59                           _10min_working_rider_num         5447
36                                  waiting_order_num         5545
12                                  customer_latitude         5662
29   area_id_area_id#hour#minute_arriveshop_cost_mean         5831
15    area_id_area_id#hour#minute_arriveshop_cost_std         6486
56                   _10min_notbusy_working_rider_num         6592
61   area_id_area_id#hour#minute_food_total_value_sum         6670
5                        _10min_deliverying_order_num         6883
37                              bill_number_per_rider         6974
13                       _10min_not_fetched_order_num         7421
38                                          direction         7481
54                              prd_arrive_guest_time         8341
53                                   food_total_value         8539
60                                     area_busy_coef         8645
63                                  delivery_distance         8723

[67 rows x 2 columns]
[from_start 64415b7] sub:try fix
 1 file changed, 40 insertions(+), 43 deletions(-)
########### sub: try testb area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.224109888077 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0201060771942 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0480749607086 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00724601745605 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.418186903 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0805051326752 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0517148971558 s 

add stats features begin ......
add stats features end ......
time lapsing 1.34202003479 s 

add stats features begin ......
add stats features end ......
time lapsing 1.29833889008 s 

add stats features begin ......
add stats features end ......
time lapsing 0.403437137604 s 

features,length 75, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'cur_10min_deliverying_order_num_cha', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'cur_10min_not_fetched_order_last', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'cur_10min_notbusy_working_rider_cha', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'cur_10min_working_rider_cha', 'cur_10min_working_rider_last', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'cur_10min_deliverying_order_num_last', 'food_num', 'cur_10min_not_fetched_order_cha', 'cur_10min_notbusy_working_rider_last', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', '15min', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_mean_food_total_value']
Start training...
[LightGBM] [Info] Total Bins 15447
[LightGBM] [Info] Number of data: 659269, number of used features: 75
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1807, 1539, 189, 2516, 1752, 5641, 1602, 2206, 1625, 1141, 1959, 1575, 5529, 6213, 1173, 5299, 2515, 1807, 602, 1899, 2097, 601, 1813, 2315, 1722, 1869, 4204, 2010, 1776, 1949, 4904, 4252, 1760, 481, 3600, 1961, 1868, 5756, 7091, 7195, 1275, 1954, 442, 1736, 1362, 1625, 2165, 2357, 1364, 2698, 1429, 2522, 416, 2495, 1230, 1760, 1634, 1857, 2020, 8202, 7990, 1811, 5200, 2545, 2752, 4859, 698, 8770, 5027, 1659, 7743, 1588, 1716, 1610, 1676])
                                             feature  importances
2                                            area_id          189
52                                          food_num          416
42    lasthour_poi_agg_poi_id_mean_waiting_order_num          442
33               poi_agg_poi_id_mean_box_total_value          481
21      lasthour_poi_agg_poi_id_mean_box_total_value          601
18             poi_agg_poi_id_mean_waiting_order_num          602
66                                             15min          698
9                                        poi_lat_bin         1141
14                                             10min         1173
54              cur_10min_notbusy_working_rider_last         1230
40                                           poi_lng         1275
44                       cur_10min_working_rider_cha         1362
48                                           poi_lat         1364
50                     poi_agg__avg_speed_meanpoi_id         1429
1                 lasthour_poi_agg_poi_id_coor_count         1539
11    lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1575
71    lasthour_poi_agg_poi_id_mean_delivery_distance         1588
6             lasthour_poi_agg__avg_speed_meanpoi_id         1602
73             poi_agg_poi_id_mean_delivery_distance         1610
45                      cur_10min_working_rider_last         1625
8                                        poi_lng_bin         1625
56            lasthour_poi_agg_poi_id_std_fetch_cost         1634
69             poi_agg_poi_id_mean_arrive_guest_cost         1659
74     lasthour_poi_agg_poi_id_mean_food_total_value         1676
72              poi_agg_poi_id_mean_food_total_value         1716
24                    lasthour_poi_agg_poi_id_std_dd         1722
43        poi_agg_poi_id_arrive_guest_avg_speed_mean         1736
4                          poi_agg_poi_id_coor_count         1752
55                                            poi_id         1760
32         poi_agg_poi_id_arrive_guest_avg_speed_std         1760
..                                               ...          ...
20               poi_agg_poi_id_mean_arriveshop_cost         2097
46                   lasthour_poi_agg_poi_id_mean_dd         2165
7                              poi_agg_poi_id_std_dd         2206
23                  cur_10min_not_fetched_order_last         2315
47                      poi_agg__avg_speed_stdpoi_id         2357
53                   cur_10min_not_fetched_order_cha         2495
16               cur_10min_deliverying_order_num_cha         2515
3                                            weekday         2516
51              cur_10min_deliverying_order_num_last         2522
63                                   box_total_value         2545
49                    poi_agg_poi_id_mean_fetch_cost         2698
64                            poi_agg_poi_id_mean_dd         2752
34                                       cst_lat_bin         3600
26                                       cst_lng_bin         4204
31                                customer_longitude         4252
65                          _10min_working_rider_num         4859
30  area_id_area_id#hour#minute_arriveshop_cost_mean         4904
68  area_id_area_id#hour#minute_food_total_value_sum         5027
62                  _10min_notbusy_working_rider_num         5200
15   area_id_area_id#hour#minute_arriveshop_cost_std         5299
12                                 customer_latitude         5529
5                       _10min_deliverying_order_num         5641
37                                 waiting_order_num         5756
13                      _10min_not_fetched_order_num         6213
38                             bill_number_per_rider         7091
39                                         direction         7195
70                                 delivery_distance         7743
60                             prd_arrive_guest_time         7990
59                                  food_total_value         8202
67                                    area_busy_coef         8770

[75 rows x 2 columns]
[from_start c9cfd1a] sub:try testb area
 2 files changed, 65 insertions(+), 72 deletions(-)
########### sub: try testb area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.204252958298 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0185489654541 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0410349369049 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00751209259033 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.406076908112 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0767838954926 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0534470081329 s 

add stats features begin ......
add stats features end ......
time lapsing 1.29815912247 s 

add stats features begin ......
add stats features end ......
time lapsing 1.0916659832 s 

add stats features begin ......
add stats features end ......
time lapsing 0.378264904022 s 

features,length 74, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'cur_min_x', 'poi_agg_poi_id_coor_count', 'weekday', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_10min_notbusy_working_rider_median', 'cur_10min_deliverying_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_mean_delivery_distance', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_10min_working_rider_last', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'cur_min_y', 'next15_min']
Start training...
[LightGBM] [Info] Total Bins 14842
[LightGBM] [Info] Number of data: 659269, number of used features: 74
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1775, 1767, 226, 6417, 1763, 2749, 5607, 1725, 2413, 1508, 1216, 2110, 1750, 5631, 766, 1509, 1043, 5412, 1752, 1786, 708, 1925, 2071, 613, 1945, 2764, 1629, 1842, 1818, 4659, 2326, 1913, 459, 4778, 4406, 1844, 552, 3701, 1883, 1980, 5711, 7693, 7323, 1393, 2051, 1875, 687, 442, 2203, 2342, 1492, 2665, 1514, 471, 852, 1882, 1742, 1933, 2041, 7906, 7717, 1977, 5748, 2537, 4584, 4999, 8093, 7227, 1690, 8496, 1622, 1689, 464, 198])
                                              feature  importances
73                                         next15_min          198
2                                             area_id          226
47                       cur_10min_working_rider_last          442
32     lasthour_poi_agg_poi_id_mean_waiting_order_num          459
72                                          cur_min_y          464
53                                           food_num          471
36                poi_agg_poi_id_mean_box_total_value          552
23       lasthour_poi_agg_poi_id_mean_box_total_value          613
46                                              15min          687
20              poi_agg_poi_id_mean_waiting_order_num          708
14             cur_10min_notbusy_working_rider_median          766
54                    cur_10min_not_fetched_order_num          852
16                                              10min         1043
10                                        poi_lat_bin         1216
43                                            poi_lng         1393
50                                            poi_lat         1492
9                                         poi_lng_bin         1508
15                    cur_10min_deliverying_order_num         1509
52                      poi_agg__avg_speed_meanpoi_id         1514
70     lasthour_poi_agg_poi_id_mean_delivery_distance         1622
26              poi_agg_poi_id_mean_delivery_distance         1629
71               poi_agg_poi_id_mean_food_total_value         1689
68              poi_agg_poi_id_mean_arrive_guest_cost         1690
7              lasthour_poi_agg__avg_speed_meanpoi_id         1725
56             lasthour_poi_agg_poi_id_std_fetch_cost         1742
12     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1750
18      lasthour_poi_agg_poi_id_mean_food_total_value         1752
4                           poi_agg_poi_id_coor_count         1763
1                  lasthour_poi_agg_poi_id_coor_count         1767
0                 poi_agg_poi_id_std_food_total_value         1775
..                                                ...          ...
44            lasthour_poi_agg_poi_id_mean_fetch_cost         2051
22                poi_agg_poi_id_mean_arriveshop_cost         2071
11  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2110
48                    lasthour_poi_agg_poi_id_mean_dd         2203
30                      poi_agg_poi_id_std_fetch_cost         2326
49                       poi_agg__avg_speed_stdpoi_id         2342
8                               poi_agg_poi_id_std_dd         2413
63                                    box_total_value         2537
51                     poi_agg_poi_id_mean_fetch_cost         2665
5                                             weekday         2749
25                             poi_agg_poi_id_mean_dd         2764
37                                        cst_lat_bin         3701
34                                 customer_longitude         4406
64   area_id_area_id#hour#minute_food_total_value_sum         4584
29                                        cst_lng_bin         4659
33   area_id_area_id#hour#minute_arriveshop_cost_mean         4778
65                           _10min_working_rider_num         4999
17    area_id_area_id#hour#minute_arriveshop_cost_std         5412
6                        _10min_deliverying_order_num         5607
13                                  customer_latitude         5631
40                                  waiting_order_num         5711
62                   _10min_notbusy_working_rider_num         5748
3                                           cur_min_x         6417
67                       _10min_not_fetched_order_num         7227
42                                          direction         7323
41                              bill_number_per_rider         7693
60                              prd_arrive_guest_time         7717
59                                   food_total_value         7906
66                                     area_busy_coef         8093
69                                  delivery_distance         8496

[74 rows x 2 columns]
[from_start 816290b] sub:try testb area
 3 files changed, 72 insertions(+), 51 deletions(-)
########### sub: try testb area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.230012893677 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0211100578308 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0472187995911 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00783109664917 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.40820813179 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0815329551697 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0612280368805 s 

add stats features begin ......
add stats features end ......
time lapsing 1.60357379913 s 

add stats features begin ......
add stats features end ......
time lapsing 1.26372981071 s 

add stats features begin ......
add stats features end ......
time lapsing 0.427425146103 s 

features,length 71, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'cur_10min_notbusy_working_rider_median', 'cur_10min_deliverying_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'cur_10min_working_rider_last', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'cur_10min_not_fetched_order_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14574
[LightGBM] [Info] Number of data: 659269, number of used features: 71
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1943, 1755, 269, 2749, 1868, 5864, 1687, 2332, 1559, 1304, 2123, 1810, 5693, 1080, 2183, 1484, 5847, 1915, 1858, 709, 1870, 1985, 605, 1994, 2947, 1876, 1857, 4625, 2227, 1896, 446, 5434, 4658, 1868, 511, 3790, 2025, 1954, 5750, 6888, 7210, 1327, 2004, 1838, 895, 665, 2263, 2259, 1521, 2797, 1476, 482, 1478, 1897, 1666, 2008, 2221, 8584, 7508, 1891, 5864, 2648, 5841, 5203, 9232, 7439, 1592, 7794, 1756, 1656, 1747])
                                              feature  importances
2                                             area_id          269
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          446
51                                           food_num          482
34                poi_agg_poi_id_mean_box_total_value          511
22       lasthour_poi_agg_poi_id_mean_box_total_value          605
45                       cur_10min_working_rider_last          665
19              poi_agg_poi_id_mean_waiting_order_num          709
44                                              15min          895
13             cur_10min_notbusy_working_rider_median         1080
9                                         poi_lat_bin         1304
41                                            poi_lng         1327
50                      poi_agg__avg_speed_meanpoi_id         1476
52                    cur_10min_not_fetched_order_num         1478
15                                              10min         1484
48                                            poi_lat         1521
8                                         poi_lng_bin         1559
66              poi_agg_poi_id_mean_arrive_guest_cost         1592
69               poi_agg_poi_id_mean_food_total_value         1656
54             lasthour_poi_agg_poi_id_std_fetch_cost         1666
6              lasthour_poi_agg__avg_speed_meanpoi_id         1687
70              poi_agg_poi_id_mean_delivery_distance         1747
1                  lasthour_poi_agg_poi_id_coor_count         1755
68     lasthour_poi_agg_poi_id_mean_delivery_distance         1756
11     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1810
43         poi_agg_poi_id_arrive_guest_avg_speed_mean         1838
26              lasthour_poi_agg__avg_speed_stdpoi_id         1857
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1858
33          poi_agg_poi_id_arrive_guest_avg_speed_std         1868
4                           poi_agg_poi_id_coor_count         1868
20               poi_agg_poi_id_std_delivery_distance         1870
..                                                ...          ...
36               poi_agg_poi_id_std_arrive_guest_cost         2025
10  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2123
14                    cur_10min_deliverying_order_num         2183
56       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2221
28                      poi_agg_poi_id_std_fetch_cost         2227
47                       poi_agg__avg_speed_stdpoi_id         2259
46                    lasthour_poi_agg_poi_id_mean_dd         2263
7                               poi_agg_poi_id_std_dd         2332
61                                    box_total_value         2648
3                                             weekday         2749
49                     poi_agg_poi_id_mean_fetch_cost         2797
24                             poi_agg_poi_id_mean_dd         2947
35                                        cst_lat_bin         3790
27                                        cst_lng_bin         4625
32                                 customer_longitude         4658
63                           _10min_working_rider_num         5203
31   area_id_area_id#hour#minute_arriveshop_cost_mean         5434
12                                  customer_latitude         5693
38                                  waiting_order_num         5750
62   area_id_area_id#hour#minute_food_total_value_sum         5841
16    area_id_area_id#hour#minute_arriveshop_cost_std         5847
5                        _10min_deliverying_order_num         5864
60                   _10min_notbusy_working_rider_num         5864
39                              bill_number_per_rider         6888
40                                          direction         7210
65                       _10min_not_fetched_order_num         7439
58                              prd_arrive_guest_time         7508
67                                  delivery_distance         7794
57                                   food_total_value         8584
64                                     area_busy_coef         9232

[71 rows x 2 columns]
[from_start c7600c9] sub:try testb area
 3 files changed, 38 insertions(+), 35 deletions(-)
add stats features begin ......
add stats features end ......
time lapsing 0.228363037109 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0206418037415 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0418570041656 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0117888450623 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.366383075714 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0722901821136 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0445649623871 s 

add stats features begin ......
add stats features end ......
time lapsing 0.988946914673 s 

features,length 64, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_std_arrive_guest_cost', 'area_busy_coef', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'poi_lng_bin', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'cst_lat_bin', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'cur_min', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'weekday', '15min', 'delivery_distance', 'poi_lat', 'lasthour_poi_agg_poi_id_std_arriveshop_cost']
Start training...
[LightGBM] [Info] Total Bins 13618
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [2294, 2049, 366, 1278, 7113, 1770, 2676, 2007, 1487, 2326, 2041, 5841, 6614, 5382, 5590, 685, 2108, 833, 2077, 686, 2194, 2113, 4721, 5077, 2426, 2323, 503, 4836, 2682, 2099, 2166, 9042, 5206, 6029, 7226, 2076, 2163, 2039, 1887, 1194, 4428, 1801, 3743, 2930, 1812, 491, 2494, 2307, 1938, 2406, 2181, 8042, 8416, 2107, 6890, 2410, 2718, 3122, 4912, 2880, 646, 8449, 1528, 2124])
                                              feature  importances
2                                             area_id          366
45                                           food_num          491
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          503
60                                              15min          646
15                poi_agg_poi_id_mean_box_total_value          685
19       lasthour_poi_agg_poi_id_mean_box_total_value          686
17              poi_agg_poi_id_mean_waiting_order_num          833
39                                        poi_lng_bin         1194
3                                               10min         1278
8                                         poi_lat_bin         1487
62                                            poi_lat         1528
5              lasthour_poi_agg__avg_speed_meanpoi_id         1770
41                          poi_agg_poi_id_coor_count         1801
44                      poi_agg__avg_speed_meanpoi_id         1812
38              poi_agg_poi_id_mean_arrive_guest_cost         1887
48             lasthour_poi_agg_poi_id_std_fetch_cost         1938
7               lasthour_poi_agg__avg_speed_stdpoi_id         2007
37                     lasthour_poi_agg_poi_id_std_dd         2039
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2041
1                  lasthour_poi_agg_poi_id_coor_count         2049
35                                            poi_lng         2076
18               poi_agg_poi_id_std_delivery_distance         2077
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2099
53                 poi_agg_poi_id_std_arriveshop_cost         2107
16  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2108
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         2113
63        lasthour_poi_agg_poi_id_std_arriveshop_cost         2124
36            lasthour_poi_agg_poi_id_mean_fetch_cost         2163
30               poi_agg_poi_id_std_arrive_guest_cost         2166
50      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2181
..                                                ...          ...
9                 poi_agg_poi_id_mean_arriveshop_cost         2326
49       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2406
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2410
24                      poi_agg_poi_id_std_fetch_cost         2426
46                       poi_agg__avg_speed_stdpoi_id         2494
6                               poi_agg_poi_id_std_dd         2676
28                    lasthour_poi_agg_poi_id_mean_dd         2682
56                                    box_total_value         2718
59                                            weekday         2880
43                     poi_agg_poi_id_mean_fetch_cost         2930
57                             poi_agg_poi_id_mean_dd         3122
42                                        cst_lat_bin         3743
40                                 customer_longitude         4428
22   area_id_area_id#hour#minute_food_total_value_sum         4721
27   area_id_area_id#hour#minute_arriveshop_cost_mean         4836
58                           _10min_working_rider_num         4912
23                                        cst_lng_bin         5077
32                                  waiting_order_num         5206
13    area_id_area_id#hour#minute_arriveshop_cost_std         5382
14                   _10min_notbusy_working_rider_num         5590
11                                  customer_latitude         5841
33                       _10min_deliverying_order_num         6029
12                       _10min_not_fetched_order_num         6614
54                                            cur_min         6890
4                               bill_number_per_rider         7113
34                                          direction         7226
51                                   food_total_value         8042
52                              prd_arrive_guest_time         8416
61                                  delivery_distance         8449
31                                     area_busy_coef         9042

[64 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.216406106949 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0196108818054 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0431220531464 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00715303421021 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.462858915329 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0796639919281 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0504598617554 s 

add stats features begin ......
add stats features end ......
time lapsing 1.08554387093 s 

features,length 63, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_food_total_value_sum', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_std_arrive_guest_cost', 'area_busy_coef', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'poi_lng_bin', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'cst_lat_bin', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'weekday', '15min', 'delivery_distance', 'poi_lat', 'lasthour_poi_agg_poi_id_std_arriveshop_cost']
Start training...
[LightGBM] [Info] Total Bins 13364
[LightGBM] [Info] Number of data: 659269, number of used features: 63
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [2124, 1808, 358, 1730, 7698, 1961, 2483, 2025, 1495, 2288, 2003, 5599, 7555, 6308, 6713, 660, 2065, 738, 2073, 685, 2104, 1937, 6898, 4593, 2346, 2137, 528, 6091, 2341, 2097, 2287, 9167, 5871, 6494, 7440, 1968, 2300, 2035, 1813, 1231, 4554, 1786, 4236, 2771, 1861, 530, 2294, 1971, 1987, 2311, 2045, 8616, 7799, 2209, 2147, 2543, 2938, 5392, 2972, 902, 8368, 1523, 2198])
                                              feature  importances
2                                             area_id          358
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          528
45                                           food_num          530
15                poi_agg_poi_id_mean_box_total_value          660
19       lasthour_poi_agg_poi_id_mean_box_total_value          685
17              poi_agg_poi_id_mean_waiting_order_num          738
59                                              15min          902
39                                        poi_lng_bin         1231
8                                         poi_lat_bin         1495
61                                            poi_lat         1523
3                                               10min         1730
41                          poi_agg_poi_id_coor_count         1786
1                  lasthour_poi_agg_poi_id_coor_count         1808
38              poi_agg_poi_id_mean_arrive_guest_cost         1813
44                      poi_agg__avg_speed_meanpoi_id         1861
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1937
5              lasthour_poi_agg__avg_speed_meanpoi_id         1961
35                                            poi_lng         1968
47                                             poi_id         1971
48             lasthour_poi_agg_poi_id_std_fetch_cost         1987
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2003
7               lasthour_poi_agg__avg_speed_stdpoi_id         2025
37                     lasthour_poi_agg_poi_id_std_dd         2035
50      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2045
16  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2065
18               poi_agg_poi_id_std_delivery_distance         2073
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2097
20      lasthour_poi_agg_poi_id_std_delivery_distance         2104
0                 poi_agg_poi_id_std_food_total_value         2124
25       lasthour_poi_agg_poi_id_std_food_total_value         2137
..                                                ...          ...
30               poi_agg_poi_id_std_arrive_guest_cost         2287
9                 poi_agg_poi_id_mean_arriveshop_cost         2288
46                       poi_agg__avg_speed_stdpoi_id         2294
36            lasthour_poi_agg_poi_id_mean_fetch_cost         2300
49       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2311
28                    lasthour_poi_agg_poi_id_mean_dd         2341
24                      poi_agg_poi_id_std_fetch_cost         2346
6                               poi_agg_poi_id_std_dd         2483
55                                    box_total_value         2543
43                     poi_agg_poi_id_mean_fetch_cost         2771
56                             poi_agg_poi_id_mean_dd         2938
58                                            weekday         2972
42                                        cst_lat_bin         4236
40                                 customer_longitude         4554
23                                        cst_lng_bin         4593
57                           _10min_working_rider_num         5392
11                                  customer_latitude         5599
32                                  waiting_order_num         5871
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6091
13    area_id_area_id#hour#minute_arriveshop_cost_std         6308
33                       _10min_deliverying_order_num         6494
14                   _10min_notbusy_working_rider_num         6713
22   area_id_area_id#hour#minute_food_total_value_sum         6898
34                                          direction         7440
12                       _10min_not_fetched_order_num         7555
4                               bill_number_per_rider         7698
52                              prd_arrive_guest_time         7799
60                                  delivery_distance         8368
51                                   food_total_value         8616
31                                     area_busy_coef         9167

[63 rows x 2 columns]
add stats features begin ......
add stats features end ......
time lapsing 0.231359004974 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0196740627289 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0470199584961 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00688505172729 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.444139003754 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0858240127563 s 

add stats features begin ......
add stats features end ......
time lapsing 0.056391954422 s 

add stats features begin ......
add stats features end ......
time lapsing 1.21087288857 s 

add stats features begin ......
add stats features end ......
time lapsing 1.18458199501 s 

add stats features begin ......
add stats features end ......
time lapsing 0.460647106171 s 

add stats features begin ......
add stats features end ......
time lapsing 0.409788131714 s 

add stats features begin ......
add stats features end ......
time lapsing 0.108895778656 s 

add stats features begin ......
add stats features end ......
time lapsing 0.438992977142 s 

add stats features begin ......
add stats features end ......
time lapsing 0.133689165115 s 

features,length 88, ['area_id', 'poi_lng_bin', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'cst_lng_bin', 'cur_block_box_total_value', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'cur_block_food_total_value', 'food_total_value', 'cur_10min_not_fetched_order_num_y', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'cst_lat_bin', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_mean_arriveshop_cost', 'customer_latitude', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'delivery_distance', 'area_id_area_id#hour#minute_food_total_value_sum', 'cur_block_delivery_distance', 'cur_block_box_total_value_y', 'cur_block_box_total_value_x', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'cur_order_id_count_x', 'cur_order_id_count_y', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_dd', 'food_num', 'poi_id', '_10min_notbusy_working_rider_num', '15min', 'poi_lat', 'area_id_area_id#hour#minute_prd_arrive_guest_time_mean', 'cur_waiting_order_num_x', '_10min_not_fetched_order_num', 'poi_agg_poi_id_std_dd', 'future_delivery_distance_y', 'future_delivery_distance_x', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_waiting_order_num', 'future_food_total_value_sum_y', 'future_food_total_value_sum_x', 'poi_agg_poi_id_std_fetch_cost', 'cur_order_id_count', 'lasthour_poi_agg_poi_id_mean_dd', 'area_id_area_id#hour#minute_prd_arrive_guest_time_std', 'poi_agg_poi_id_mean_food_total_value', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_std_food_total_value', 'cur_waiting_order_num_y', 'lasthour_poi_agg__avg_speed_stdpoi_id', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_lat_bin', 'poi_lng', 'poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'customer_longitude', 'poi_agg_poi_id_std_arrive_guest_cost', 'waiting_order_num', 'bill_number_per_rider', 'cur_area_busy_coef_y', 'cur_area_busy_coef_x', 'cur_block_delivery_distance_y', 'cur_block_delivery_distance_x', 'poi_agg__avg_speed_meanpoi_id', 'cur_block_food_total_value_y', 'cur_block_food_total_value_x', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_working_rider_num', 'cur_10min_not_fetched_order_num_x', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 19723
[LightGBM] [Info] Number of data: 659269, number of used features: 88
########### sub: new fea###########
########### sub: new fea###########
add stats features begin ......
add stats features end ......
time lapsing 0.22696685791 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0209500789642 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0462620258331 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00703096389771 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.435709953308 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0793011188507 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0555469989777 s 

add stats features begin ......
add stats features end ......
time lapsing 0.790882110596 s 

add stats features begin ......
add stats features end ......
time lapsing 0.858720064163 s 

add stats features begin ......
add stats features end ......
time lapsing 1.48718905449 s 

add stats features begin ......
add stats features end ......
time lapsing 1.130671978 s 

add stats features begin ......
add stats features end ......
time lapsing 0.485121965408 s 

add stats features begin ......
add stats features end ......
time lapsing 0.439496994019 s 

add stats features begin ......
add stats features end ......
time lapsing 0.113403081894 s 

add stats features begin ......
add stats features end ......
time lapsing 0.403591156006 s 

add stats features begin ......
add stats features end ......
time lapsing 0.129607915878 s 

features,length 91, ['area_id', 'poi_lng_bin', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'cst_lng_bin', 'cur_block_box_total_value', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'cur_block_food_total_value', 'food_total_value', 'cur_10min_not_fetched_order_num_y', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'cst_lat_bin', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_mean_arriveshop_cost', 'customer_latitude', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'delivery_distance', 'area_id_area_id#hour#minute_food_total_value_sum', 'cur_block_delivery_distance', 'cur_block_box_total_value_y', 'cur_block_box_total_value_x', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'cur_order_id_count_x', 'cur_order_id_count_y', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_dict__food_total_value_last_ten', 'food_num', 'poi_id', '_10min_notbusy_working_rider_num', '15min', 'poi_lat', 'area_id_area_id#hour#minute_prd_arrive_guest_time_mean', 'cur_waiting_order_num_x', '_10min_not_fetched_order_num', 'poi_agg_poi_id_std_dd', 'future_delivery_distance_y', 'future_delivery_distance_x', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_waiting_order_num', 'future_food_total_value_sum_y', 'future_food_total_value_sum_x', 'poi_agg_poi_id_std_fetch_cost', 'cur_order_id_count', 'lasthour_poi_agg_poi_id_mean_dd', 'area_id_area_id#hour#minute_prd_arrive_guest_time_std', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_dict__fetch_cost', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_std_food_total_value', 'cur_waiting_order_num_y', 'lasthour_poi_agg__avg_speed_stdpoi_id', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_lat_bin', 'poi_lng', 'poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_dict__arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'customer_longitude', 'poi_agg_poi_id_std_arrive_guest_cost', 'waiting_order_num', 'bill_number_per_rider', 'cur_area_busy_coef_y', 'cur_area_busy_coef_x', 'cur_block_delivery_distance_y', 'cur_block_delivery_distance_x', 'poi_agg__avg_speed_meanpoi_id', 'cur_block_food_total_value_y', 'cur_block_food_total_value_x', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_working_rider_num', 'cur_10min_not_fetched_order_num_x', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 20487
[LightGBM] [Info] Number of data: 659269, number of used features: 91
add stats features begin ......
add stats features end ......
time lapsing 0.207594871521 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0179080963135 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0410151481628 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00663995742798 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi_agg start
prefix is poi_agg,group column is poi_id,agg total count is 2384; after filter , agg total count is 1837, filter ratio is 22.94495409 %
lasthour poi_agg start
prefix is lasthour_poi_agg,group column is poi_id,agg total count is 2051; after filter , agg total count is 1540, filter ratio is 24.9150418574 %
prefix is lasthour_poi_agg,group column is poi_id,agg total count is 2099; after filter , agg total count is 1530, filter ratio is 27.1084940043 %
add stats features begin ......
add stats features end ......
time lapsing 0.839100837708 s 

add stats features begin ......
add stats features end ......
time lapsing 0.793077230453 s 

area_agg start
prefix is area_agg,group column is area_id#hour#minute,agg total count is 3960; after filter , agg total count is 3960, filter ratio is 0.000252524614841 %
prefix is area_agg,group column is area_id#hour#minute,agg total count is 3960; after filter , agg total count is 3960, filter ratio is 0.000252524614841 %
pick_drop_cluster_agg start
prefix is user_bin2,group column is cst_lat_bin#cst_lng_bin,agg total count is 19511; after filter , agg total count is 9389, filter ratio is 51.8784522175 %
prefix is poi_bin2,group column is poi_lat_bin#poi_lng_bin,agg total count is 1152; after filter , agg total count is 978, filter ratio is 15.1049036033 %
prefix is 15min_user_bin,group column is cst_lat_bin#cst_lng_bin#15min,agg total count is 59274; after filter , agg total count is 16145, filter ratio is 72.7620925259 %
prefix is 15min_poi_bin,group column is poi_lat_bin#poi_lng_bin#15min,agg total count is 4347; after filter , agg total count is 3180, filter ratio is 26.8462690447 %
add stats features begin ......
add stats features end ......
time lapsing 0.212342977524 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0176229476929 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0400369167328 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00645899772644 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi_agg start
prefix is poi_agg,group column is poi_id,agg total count is 2385; after filter , agg total count is 1840, filter ratio is 22.8514765137 %
lasthour poi_agg start
prefix is lasthour_poi_agg,group column is poi_id,agg total count is 2052; after filter , agg total count is 1541, filter ratio is 24.9029000833 %
prefix is lasthour_poi_agg,group column is poi_id,agg total count is 2102; after filter , agg total count is 1532, filter ratio is 27.1173781286 %
add stats features begin ......
add stats features end ......
time lapsing 0.697142839432 s 

add stats features begin ......
add stats features end ......
time lapsing 0.715090990067 s 

area_agg start
prefix is area_agg,group column is area_id#hour#minute,agg total count is 3960; after filter , agg total count is 3960, filter ratio is 0.000252524614841 %
prefix is area_agg,group column is area_id#hour#minute,agg total count is 3960; after filter , agg total count is 3960, filter ratio is 0.000252524614841 %
pick_drop_cluster_agg start
prefix is user_bin2,group column is cst_lat_bin#cst_lng_bin,agg total count is 19541; after filter , agg total count is 9432, filter ratio is 51.7322799589 %
prefix is poi_bin2,group column is poi_lat_bin#poi_lng_bin,agg total count is 1152; after filter , agg total count is 979, filter ratio is 15.0180988012 %
prefix is poi_user_bin2,group column is cst_lat_bin#cst_lng_bin#poi_lat_bin#poi_lng_bin,agg total count is 182341; after filter , agg total count is 13423, filter ratio is 92.6385183454 %
########### sub: add rolling fea###########
add stats features begin ......
add stats features end ......
time lapsing 0.205887079239 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0188870429993 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0413498878479 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00709199905396 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.364161968231 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0752689838409 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0526359081268 s 

add stats features begin ......
add stats features end ......
time lapsing 1.10502791405 s 

features,length 89, ['area_id', 'poi_lng_bin', 'rolling_poi_fea__waiting_order_num__forward_5_mean__poi_id', 'rolling_poi_bin__waiting_order_num__back_10_std__poi_lat_bin#poi_lng_bin', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'cst_lng_bin', 'lasthour_poi_agg_poi_id_std_food_total_value', 'rolling_poi_bin__waiting_order_num__forward_5_std__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'rolling_poi_fea__waiting_order_num__forward_5_std__poi_id', 'rolling_poi_fea__food_total_value__forward_5_mean__poi_id', 'food_total_value', 'rolling_poi_bin__food_total_value__back_10_std__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'rolling_poi_fea__delivery_distance__back_10_std__poi_id', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'rolling_poi_bin__food_total_value__back_10_mean__poi_lat_bin#poi_lng_bin', 'poi_agg_poi_id_mean_dd', 'cst_lat_bin', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'customer_latitude', 'rolling_poi_fea__food_total_value__forward_5_std__poi_id', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'delivery_distance', 'area_id_area_id#hour#minute_food_total_value_sum', 'rolling_poi_fea__waiting_order_num__back_10_mean__poi_id', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_dd', 'rolling_poi_bin__delivery_distance__forward_5_std__poi_lat_bin#poi_lng_bin', 'rolling_poi_fea__delivery_distance__back_10_mean__poi_id', 'poi_id', 'rolling_poi_bin__delivery_distance__forward_5_mean__poi_lat_bin#poi_lng_bin', 'rolling_poi_bin__delivery_distance__back_10_std__poi_lat_bin#poi_lng_bin', '_10min_notbusy_working_rider_num', '15min', 'rolling_poi_fea__waiting_order_num__back_10_std__poi_id', 'rolling_poi_bin__food_total_value__forward_5_std__poi_lat_bin#poi_lng_bin', '_10min_not_fetched_order_num', 'poi_agg_poi_id_std_dd', 'rolling_poi_bin__delivery_distance__back_10_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_mean_food_total_value', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'poi_agg__avg_speed_stdpoi_id', 'poi_agg_poi_id_mean_fetch_cost', 'rolling_poi_bin__waiting_order_num__forward_5_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'poi_agg_poi_id_mean_arriveshop_cost', 'rolling_poi_fea__food_total_value__back_10_mean__poi_id', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_std_food_total_value', 'rolling_poi_bin__waiting_order_num__back_10_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg__avg_speed_stdpoi_id', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_lat_bin', 'poi_lng', 'poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_std_delivery_distance', 'rolling_poi_fea__delivery_distance__forward_5_mean__poi_id', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'customer_longitude', 'poi_agg_poi_id_std_arrive_guest_cost', 'waiting_order_num', 'bill_number_per_rider', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'rolling_poi_fea__food_total_value__back_10_std__poi_id', 'poi_lat', 'poi_agg__avg_speed_meanpoi_id', 'rolling_poi_fea__delivery_distance__forward_5_std__poi_id', 'rolling_poi_bin__food_total_value__forward_5_mean__poi_lat_bin#poi_lng_bin', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_working_rider_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 20459
[LightGBM] [Info] Number of data: 659269, number of used features: 89
[LightGBM] [Info] Finished loading 1600 models
Calculate feature importances...
('Feature importances:', [451, 1806, 6300, 6926, 2707, 810, 5152, 2831, 7147, 2355, 7289, 2763, 7604, 6869, 8854, 7075, 2491, 8191, 2688, 6488, 3163, 5162, 2115, 3102, 3009, 4884, 7263, 7328, 2157, 9866, 7373, 7650, 2486, 2771, 2492, 8214, 7526, 2748, 7738, 7870, 6128, 1429, 7719, 7396, 8059, 2692, 7402, 2285, 1044, 2688, 2744, 1987, 8761, 2592, 2817, 3350, 5987, 2858, 2613, 6536, 10077, 2047, 2238, 6871, 2577, 1675, 7083, 1437, 1521, 636, 2452, 8089, 2606, 658, 4766, 2642, 4059, 7805, 2432, 7238, 1691, 1765, 7953, 6951, 9560, 2532, 5279, 2203, 2356])
                                              feature  importances
0                                             area_id          451
69                poi_agg_poi_id_mean_box_total_value          636
73     lasthour_poi_agg_poi_id_mean_waiting_order_num          658
5        lasthour_poi_agg_poi_id_mean_box_total_value          810
48              poi_agg_poi_id_mean_waiting_order_num         1044
41                                              15min         1429
67                                        poi_lat_bin         1437
68                                            poi_lng         1521
65                                              10min         1675
80                                            poi_lat         1691
81                      poi_agg__avg_speed_meanpoi_id         1765
1                                         poi_lng_bin         1806
51               poi_agg_poi_id_mean_food_total_value         1987
61              poi_agg_poi_id_mean_delivery_distance         2047
22             lasthour_poi_agg__avg_speed_meanpoi_id         2115
28         poi_agg_poi_id_arrive_guest_avg_speed_mean         2157
87              poi_agg_poi_id_mean_arrive_guest_cost         2203
62                poi_agg_poi_id_std_food_total_value         2238
47      lasthour_poi_agg_poi_id_mean_food_total_value         2285
9                  lasthour_poi_agg_poi_id_coor_count         2355
88     lasthour_poi_agg_poi_id_mean_delivery_distance         2356
78  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2432
70               poi_agg_poi_id_std_delivery_distance         2452
32          poi_agg_poi_id_arrive_guest_avg_speed_std         2486
16             lasthour_poi_agg_poi_id_std_fetch_cost         2491
34                     lasthour_poi_agg_poi_id_std_dd         2492
85                 poi_agg_poi_id_std_arriveshop_cost         2532
64              lasthour_poi_agg__avg_speed_stdpoi_id         2577
53     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2592
72      lasthour_poi_agg_poi_id_std_delivery_distance         2606
..                                                ...          ...
63  rolling_poi_bin__waiting_order_num__back_10_me...         6871
3   rolling_poi_bin__waiting_order_num__back_10_st...         6926
83  rolling_poi_bin__food_total_value__forward_5_m...         6951
15  rolling_poi_bin__food_total_value__back_10_std...         7075
66   area_id_area_id#hour#minute_arriveshop_cost_mean         7083
8   rolling_poi_bin__waiting_order_num__forward_5_...         7147
79  rolling_poi_fea__food_total_value__back_10_std...         7238
26  rolling_poi_fea__food_total_value__forward_5_s...         7263
10                       _10min_deliverying_order_num         7289
27    area_id_area_id#hour#minute_arriveshop_cost_std         7328
30   area_id_area_id#hour#minute_food_total_value_sum         7373
43  rolling_poi_bin__food_total_value__forward_5_s...         7396
46  rolling_poi_bin__delivery_distance__back_10_me...         7402
36  rolling_poi_fea__delivery_distance__back_10_me...         7526
12  rolling_poi_fea__waiting_order_num__forward_5_...         7604
31  rolling_poi_fea__waiting_order_num__back_10_me...         7650
42  rolling_poi_fea__waiting_order_num__back_10_st...         7719
38  rolling_poi_bin__delivery_distance__forward_5_...         7738
77                              bill_number_per_rider         7805
39  rolling_poi_bin__delivery_distance__back_10_st...         7870
82  rolling_poi_fea__delivery_distance__forward_5_...         7953
44                       _10min_not_fetched_order_num         8059
71  rolling_poi_fea__delivery_distance__forward_5_...         8089
17  rolling_poi_fea__delivery_distance__back_10_st...         8191
35  rolling_poi_bin__delivery_distance__forward_5_...         8214
52                                          direction         8761
14                                   food_total_value         8854
84                              prd_arrive_guest_time         9560
29                                  delivery_distance         9866
60                                     area_busy_coef        10077

[89 rows x 2 columns]
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.215614080429 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0179560184479 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0399780273438 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0073139667511 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.377215862274 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0721089839935 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0504817962646 s 

add stats features begin ......
add stats features end ......
time lapsing 1.02564096451 s 

features,length 89, ['area_id', 'poi_lng_bin', 'rolling_poi_fea__waiting_order_num__forward_5_mean__poi_id', 'rolling_poi_bin__waiting_order_num__back_10_std__poi_lat_bin#poi_lng_bin', 'poi_agg_poi_id_coor_count', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'cst_lng_bin', 'lasthour_poi_agg_poi_id_std_food_total_value', 'rolling_poi_bin__waiting_order_num__forward_5_std__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'rolling_poi_fea__waiting_order_num__forward_5_std__poi_id', 'rolling_poi_fea__food_total_value__forward_5_mean__poi_id', 'food_total_value', 'rolling_poi_bin__food_total_value__back_10_std__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'rolling_poi_fea__delivery_distance__back_10_std__poi_id', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'rolling_poi_bin__food_total_value__back_10_mean__poi_lat_bin#poi_lng_bin', 'poi_agg_poi_id_mean_dd', 'cst_lat_bin', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'customer_latitude', 'rolling_poi_fea__food_total_value__forward_5_std__poi_id', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'delivery_distance', 'area_id_area_id#hour#minute_food_total_value_sum', 'rolling_poi_fea__waiting_order_num__back_10_mean__poi_id', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_dd', 'rolling_poi_bin__delivery_distance__forward_5_std__poi_lat_bin#poi_lng_bin', 'rolling_poi_fea__delivery_distance__back_10_mean__poi_id', 'poi_id', 'rolling_poi_bin__delivery_distance__forward_5_mean__poi_lat_bin#poi_lng_bin', 'rolling_poi_bin__delivery_distance__back_10_std__poi_lat_bin#poi_lng_bin', '_10min_notbusy_working_rider_num', '15min', 'rolling_poi_fea__waiting_order_num__back_10_std__poi_id', 'rolling_poi_bin__food_total_value__forward_5_std__poi_lat_bin#poi_lng_bin', '_10min_not_fetched_order_num', 'poi_agg_poi_id_std_dd', 'rolling_poi_bin__delivery_distance__back_10_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_mean_food_total_value', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'poi_agg__avg_speed_stdpoi_id', 'poi_agg_poi_id_mean_fetch_cost', 'rolling_poi_bin__waiting_order_num__forward_5_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'poi_agg_poi_id_mean_arriveshop_cost', 'rolling_poi_fea__food_total_value__back_10_mean__poi_id', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_std_food_total_value', 'rolling_poi_bin__waiting_order_num__back_10_mean__poi_lat_bin#poi_lng_bin', 'lasthour_poi_agg__avg_speed_stdpoi_id', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_lat_bin', 'poi_lng', 'poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_std_delivery_distance', 'rolling_poi_fea__delivery_distance__forward_5_mean__poi_id', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'customer_longitude', 'poi_agg_poi_id_std_arrive_guest_cost', 'waiting_order_num', 'bill_number_per_rider', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'rolling_poi_fea__food_total_value__back_10_std__poi_id', 'poi_lat', 'poi_agg__avg_speed_meanpoi_id', 'rolling_poi_fea__delivery_distance__forward_5_std__poi_id', 'rolling_poi_bin__food_total_value__forward_5_mean__poi_lat_bin#poi_lng_bin', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_working_rider_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 20459
[LightGBM] [Info] Number of data: 659269, number of used features: 89
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.207307100296 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0183351039886 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0411040782928 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00711798667908 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.385982990265 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0746080875397 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0498371124268 s 

add stats features begin ......
add stats features end ......
time lapsing 1.12232208252 s 

features,length 71, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'high_level_arrive_guest##delivery_distance_5', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'poi_agg__avg_speed_meanpoi_id', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'high_level_arrive_shop##not_waited_div_not_working_rider', '15min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arriveshop_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 15869
[LightGBM] [Info] Number of data: 659269, number of used features: 71
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2222, 2236, 351, 1924, 7337, 7178, 9395, 2737, 1694, 6229, 1502, 2527, 2087, 6097, 1935, 6980, 1963, 6964, 2058, 2140, 752, 2210, 8082, 741, 2367, 2100, 2189, 4979, 2360, 2382, 480, 1933, 4916, 2228, 611, 3865, 2384, 2240, 3090, 7646, 7984, 1434, 2380, 2210, 1961, 2351, 9098, 2615, 1685, 3028, 5809, 1088, 6797, 2257, 2061, 2165, 2621, 8387, 6902, 2231, 6132, 2481, 3128, 5675, 7985, 6869, 2256, 6487, 2029, 1937, 1846])
                                              feature  importances
2                                             area_id          351
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          480
34                poi_agg_poi_id_mean_box_total_value          611
23       lasthour_poi_agg_poi_id_mean_box_total_value          741
20              poi_agg_poi_id_mean_waiting_order_num          752
51                                              15min         1088
41                                            poi_lng         1434
10                                        poi_lat_bin         1502
48                                            poi_lat         1685
8                                         poi_lng_bin         1694
70              poi_agg_poi_id_mean_delivery_distance         1846
3                           poi_agg_poi_id_coor_count         1924
31             lasthour_poi_agg__avg_speed_meanpoi_id         1933
14                      poi_agg__avg_speed_meanpoi_id         1935
69               poi_agg_poi_id_mean_food_total_value         1937
44              poi_agg_poi_id_mean_arrive_guest_cost         1961
16                                              10min         1963
68     lasthour_poi_agg_poi_id_mean_delivery_distance         2029
18      lasthour_poi_agg_poi_id_mean_food_total_value         2058
54             lasthour_poi_agg_poi_id_std_fetch_cost         2061
12     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2087
25                     lasthour_poi_agg_poi_id_std_dd         2100
19  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2140
55      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2165
26              lasthour_poi_agg__avg_speed_stdpoi_id         2189
43         poi_agg_poi_id_arrive_guest_avg_speed_mean         2210
21               poi_agg_poi_id_std_delivery_distance         2210
0                 poi_agg_poi_id_std_food_total_value         2222
33          poi_agg_poi_id_arrive_guest_avg_speed_std         2228
59                 poi_agg_poi_id_std_arriveshop_cost         2231
..                                                ...          ...
11  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2527
47                       poi_agg__avg_speed_stdpoi_id         2615
56       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2621
7                               poi_agg_poi_id_std_dd         2737
49                     poi_agg_poi_id_mean_fetch_cost         3028
38                                  waiting_order_num         3090
62                             poi_agg_poi_id_mean_dd         3128
35                                        cst_lat_bin         3865
32                                 customer_longitude         4916
27                                        cst_lng_bin         4979
63                           _10min_working_rider_num         5675
50  high_level_arrive_shop##not_waited_div_not_wor...         5809
13                                  customer_latitude         6097
60                   _10min_notbusy_working_rider_num         6132
9        high_level_arrive_guest##delivery_distance_5         6229
67                                  delivery_distance         6487
52   area_id_area_id#hour#minute_arriveshop_cost_mean         6797
65   area_id_area_id#hour#minute_food_total_value_sum         6869
58                              prd_arrive_guest_time         6902
17    area_id_area_id#hour#minute_arriveshop_cost_std         6964
15                       _10min_not_fetched_order_num         6980
5        high_level_arrive_guest##delivery_distance_2         7178
4                        _10min_deliverying_order_num         7337
39                              bill_number_per_rider         7646
40                                          direction         7984
64                                     area_busy_coef         7985
22  high_level_arrive_shop##waiting_plus_food_valu...         8082
57                                   food_total_value         8387
46      high_level_arrive_shop##not_fetched_area_busy         9098
6        high_level_arrive_guest##delivery_distance_1         9395

[71 rows x 2 columns]
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.21703004837 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0168881416321 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0419268608093 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00680685043335 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.496326208115 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0760488510132 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0731301307678 s 

add stats features begin ......
add stats features end ......
time lapsing 0.98373913765 s 

features,length 71, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'high_level_arrive_guest##delivery_distance_5', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'poi_agg__avg_speed_meanpoi_id', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'high_level_arrive_shop##not_waited_div_not_working_rider', '15min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arriveshop_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 15869
[LightGBM] [Info] Number of data: 659269, number of used features: 71
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2222, 2236, 351, 1924, 7337, 7178, 9395, 2737, 1694, 6229, 1502, 2527, 2087, 6097, 1935, 6980, 1963, 6964, 2058, 2140, 752, 2210, 8082, 741, 2367, 2100, 2189, 4979, 2360, 2382, 480, 1933, 4916, 2228, 611, 3865, 2384, 2240, 3090, 7646, 7984, 1434, 2380, 2210, 1961, 2351, 9098, 2615, 1685, 3028, 5809, 1088, 6797, 2257, 2061, 2165, 2621, 8387, 6902, 2231, 6132, 2481, 3128, 5675, 7985, 6869, 2256, 6487, 2029, 1937, 1846])
                                              feature  importances
2                                             area_id          351
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          480
34                poi_agg_poi_id_mean_box_total_value          611
23       lasthour_poi_agg_poi_id_mean_box_total_value          741
20              poi_agg_poi_id_mean_waiting_order_num          752
51                                              15min         1088
41                                            poi_lng         1434
10                                        poi_lat_bin         1502
48                                            poi_lat         1685
8                                         poi_lng_bin         1694
70              poi_agg_poi_id_mean_delivery_distance         1846
3                           poi_agg_poi_id_coor_count         1924
31             lasthour_poi_agg__avg_speed_meanpoi_id         1933
14                      poi_agg__avg_speed_meanpoi_id         1935
69               poi_agg_poi_id_mean_food_total_value         1937
44              poi_agg_poi_id_mean_arrive_guest_cost         1961
16                                              10min         1963
68     lasthour_poi_agg_poi_id_mean_delivery_distance         2029
18      lasthour_poi_agg_poi_id_mean_food_total_value         2058
54             lasthour_poi_agg_poi_id_std_fetch_cost         2061
12     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2087
25                     lasthour_poi_agg_poi_id_std_dd         2100
19  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2140
55      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2165
26              lasthour_poi_agg__avg_speed_stdpoi_id         2189
43         poi_agg_poi_id_arrive_guest_avg_speed_mean         2210
21               poi_agg_poi_id_std_delivery_distance         2210
0                 poi_agg_poi_id_std_food_total_value         2222
33          poi_agg_poi_id_arrive_guest_avg_speed_std         2228
59                 poi_agg_poi_id_std_arriveshop_cost         2231
..                                                ...          ...
11  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2527
47                       poi_agg__avg_speed_stdpoi_id         2615
56       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2621
7                               poi_agg_poi_id_std_dd         2737
49                     poi_agg_poi_id_mean_fetch_cost         3028
38                                  waiting_order_num         3090
62                             poi_agg_poi_id_mean_dd         3128
35                                        cst_lat_bin         3865
32                                 customer_longitude         4916
27                                        cst_lng_bin         4979
63                           _10min_working_rider_num         5675
50  high_level_arrive_shop##not_waited_div_not_wor...         5809
13                                  customer_latitude         6097
60                   _10min_notbusy_working_rider_num         6132
9        high_level_arrive_guest##delivery_distance_5         6229
67                                  delivery_distance         6487
52   area_id_area_id#hour#minute_arriveshop_cost_mean         6797
65   area_id_area_id#hour#minute_food_total_value_sum         6869
58                              prd_arrive_guest_time         6902
17    area_id_area_id#hour#minute_arriveshop_cost_std         6964
15                       _10min_not_fetched_order_num         6980
5        high_level_arrive_guest##delivery_distance_2         7178
4                        _10min_deliverying_order_num         7337
39                              bill_number_per_rider         7646
40                                          direction         7984
64                                     area_busy_coef         7985
22  high_level_arrive_shop##waiting_plus_food_valu...         8082
57                                   food_total_value         8387
46      high_level_arrive_shop##not_fetched_area_busy         9098
6        high_level_arrive_guest##delivery_distance_1         9395

[71 rows x 2 columns]
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.202340126038 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0190119743347 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0447330474854 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00713396072388 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.399445056915 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0763208866119 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0517339706421 s 

add stats features begin ......
add stats features end ......
time lapsing 1.09327793121 s 

features,length 72, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'high_level_arrive_shop##not_waited_div_not_working_rider', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', '15min', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arriveshop_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 15645
[LightGBM] [Info] Number of data: 659269, number of used features: 72
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2222, 2238, 371, 2801, 2002, 6800, 7383, 9670, 2735, 1761, 1481, 2492, 2185, 5925, 5963, 1907, 6968, 2181, 2124, 753, 2393, 6590, 691, 2364, 3219, 2279, 2170, 4975, 2474, 2257, 552, 1850, 4797, 2275, 640, 4205, 2368, 2293, 3005, 7958, 8857, 1687, 2292, 2181, 2009, 2572, 8374, 2891, 1565, 3108, 1826, 494, 1045, 6701, 2317, 2154, 2209, 2521, 8654, 7445, 2442, 6072, 2776, 7628, 5417, 8488, 6362, 2160, 7576, 2039, 1947, 1874])
                                              feature  importances
2                                             area_id          371
51                                           food_num          494
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          552
34                poi_agg_poi_id_mean_box_total_value          640
22       lasthour_poi_agg_poi_id_mean_box_total_value          691
19              poi_agg_poi_id_mean_waiting_order_num          753
52                                              15min         1045
10                                        poi_lat_bin         1481
48                                            poi_lat         1565
41                                            poi_lng         1687
9                                         poi_lng_bin         1761
50                      poi_agg__avg_speed_meanpoi_id         1826
31             lasthour_poi_agg__avg_speed_meanpoi_id         1850
71              poi_agg_poi_id_mean_delivery_distance         1874
15                                              10min         1907
70               poi_agg_poi_id_mean_food_total_value         1947
4                           poi_agg_poi_id_coor_count         2002
44              poi_agg_poi_id_mean_arrive_guest_cost         2009
69     lasthour_poi_agg_poi_id_mean_delivery_distance         2039
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2124
55             lasthour_poi_agg_poi_id_std_fetch_cost         2154
67                poi_agg_poi_id_mean_arriveshop_cost         2160
26              lasthour_poi_agg__avg_speed_stdpoi_id         2170
43         poi_agg_poi_id_arrive_guest_avg_speed_mean         2181
17      lasthour_poi_agg_poi_id_mean_food_total_value         2181
12     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2185
56      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2209
0                 poi_agg_poi_id_std_food_total_value         2222
1                  lasthour_poi_agg_poi_id_coor_count         2238
29       lasthour_poi_agg_poi_id_std_food_total_value         2257
..                                                ...          ...
45                    lasthour_poi_agg_poi_id_mean_dd         2572
8                               poi_agg_poi_id_std_dd         2735
62                                    box_total_value         2776
3                                             weekday         2801
47                       poi_agg__avg_speed_stdpoi_id         2891
38                                  waiting_order_num         3005
49                     poi_agg_poi_id_mean_fetch_cost         3108
24                             poi_agg_poi_id_mean_dd         3219
35                                        cst_lat_bin         4205
32                                 customer_longitude         4797
27                                        cst_lng_bin         4975
64                           _10min_working_rider_num         5417
13                                  customer_latitude         5925
14  high_level_arrive_shop##not_waited_div_not_wor...         5963
61                   _10min_notbusy_working_rider_num         6072
66                       _10min_not_fetched_order_num         6362
21  high_level_arrive_shop##waiting_plus_food_valu...         6590
53   area_id_area_id#hour#minute_arriveshop_cost_mean         6701
5                        _10min_deliverying_order_num         6800
16    area_id_area_id#hour#minute_arriveshop_cost_std         6968
6        high_level_arrive_guest##delivery_distance_2         7383
59                              prd_arrive_guest_time         7445
68                                  delivery_distance         7576
63   area_id_area_id#hour#minute_food_total_value_sum         7628
39                              bill_number_per_rider         7958
46      high_level_arrive_shop##not_fetched_area_busy         8374
65                                     area_busy_coef         8488
58                                   food_total_value         8654
40                                          direction         8857
7        high_level_arrive_guest##delivery_distance_1         9670

[72 rows x 2 columns]
########### sub: add high level###########
########### sub: add high level###########
########### sub: add high level###########
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.207005977631 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0189599990845 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0425951480865 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00693607330322 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.387237787247 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0757291316986 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0482189655304 s 

add stats features begin ......
add stats features end ......
time lapsing 1.00132989883 s 

features,length 74, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_3', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'high_level_arrive_guest##delivery_distance_4', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lng', 'customer_latitude', 'high_level_arrive_shop##not_waited_div_not_working_rider', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'poi_lat_bin', 'food_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'poi_agg_poi_id_mean_arriveshop_cost', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 16155
[LightGBM] [Info] Number of data: 659269, number of used features: 74
Training until validation scores don't improve for 20 rounds.
[200]	training's l1: 365.709
[400]	training's l1: 355.12
[600]	training's l1: 347.495
[800]	training's l1: 340.733
[1000]	training's l1: 334.438
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2022, 2002, 373, 2822, 1875, 6827, 8110, 6243, 9130, 2716, 1627, 5699, 2495, 1646, 5662, 5433, 1874, 6680, 1898, 2070, 690, 2200, 5934, 654, 2308, 3232, 2153, 2044, 4881, 2506, 2362, 524, 1895, 4547, 2255, 573, 4076, 2241, 2285, 2805, 7918, 8535, 2033, 2294, 2051, 941, 2537, 8536, 2104, 2672, 2059, 2871, 1767, 1059, 510, 6226, 2280, 6045, 2128, 2405, 7524, 6095, 2252, 2214, 2452, 6909, 4898, 8227, 6382, 1980, 6021, 1902, 1919, 1885])
                                              feature  importances
2                                             area_id          373
54                                           food_num          510
31     lasthour_poi_agg_poi_id_mean_waiting_order_num          524
35                poi_agg_poi_id_mean_box_total_value          573
23       lasthour_poi_agg_poi_id_mean_box_total_value          654
20              poi_agg_poi_id_mean_waiting_order_num          690
45                                              15min          941
53                                        poi_lat_bin         1059
10                                        poi_lng_bin         1627
13                                            poi_lng         1646
52                      poi_agg__avg_speed_meanpoi_id         1767
16                                              10min         1874
4                           poi_agg_poi_id_coor_count         1875
73              poi_agg_poi_id_mean_delivery_distance         1885
32             lasthour_poi_agg__avg_speed_meanpoi_id         1895
18      lasthour_poi_agg_poi_id_mean_food_total_value         1898
71     lasthour_poi_agg_poi_id_mean_delivery_distance         1902
72               poi_agg_poi_id_mean_food_total_value         1919
69              poi_agg_poi_id_mean_arrive_guest_cost         1980
1                  lasthour_poi_agg_poi_id_coor_count         2002
0                 poi_agg_poi_id_std_food_total_value         2022
42     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2033
27              lasthour_poi_agg__avg_speed_stdpoi_id         2044
44         poi_agg_poi_id_arrive_guest_avg_speed_mean         2051
50                                            poi_lat         2059
19  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2070
48             lasthour_poi_agg_poi_id_std_fetch_cost         2104
58      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2128
26                     lasthour_poi_agg_poi_id_std_dd         2153
21               poi_agg_poi_id_std_delivery_distance         2200
..                                                ...          ...
49                       poi_agg__avg_speed_stdpoi_id         2672
9                               poi_agg_poi_id_std_dd         2716
39                                  waiting_order_num         2805
3                                             weekday         2822
51                     poi_agg_poi_id_mean_fetch_cost         2871
25                             poi_agg_poi_id_mean_dd         3232
36                                        cst_lat_bin         4076
33                                 customer_longitude         4547
28                                        cst_lng_bin         4881
66                           _10min_working_rider_num         4898
15  high_level_arrive_shop##not_waited_div_not_wor...         5433
14                                  customer_latitude         5662
11       high_level_arrive_guest##delivery_distance_4         5699
22  high_level_arrive_shop##waiting_plus_food_valu...         5934
70                                  delivery_distance         6021
57                   _10min_notbusy_working_rider_num         6045
61                              prd_arrive_guest_time         6095
55   area_id_area_id#hour#minute_arriveshop_cost_mean         6226
7        high_level_arrive_guest##delivery_distance_2         6243
68                       _10min_not_fetched_order_num         6382
17    area_id_area_id#hour#minute_arriveshop_cost_std         6680
5                        _10min_deliverying_order_num         6827
65   area_id_area_id#hour#minute_food_total_value_sum         6909
60                                   food_total_value         7524
40                              bill_number_per_rider         7918
6        high_level_arrive_guest##delivery_distance_3         8110
67                                     area_busy_coef         8227
41                                          direction         8535
47      high_level_arrive_shop##not_fetched_area_busy         8536
8        high_level_arrive_guest##delivery_distance_1         9130

[74 rows x 2 columns]
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.208850860596 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0196950435638 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0425591468811 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00736498832703 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.371155023575 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0750629901886 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0521531105042 s 

add stats features begin ......
add stats features end ......
time lapsing 1.2357609272 s 

features,length 74, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_3', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'high_level_arrive_guest##delivery_distance_4', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lng', 'customer_latitude', 'high_level_arrive_shop##not_waited_div_not_working_rider', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'poi_lat_bin', 'food_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'poi_agg_poi_id_mean_arriveshop_cost', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 16155
[LightGBM] [Info] Number of data: 659269, number of used features: 74
Training until validation scores don't improve for 20 rounds.
[200]	training's l1: 365.734
[400]	training's l1: 355.172
[600]	training's l1: 347.513
[800]	training's l1: 340.661
[1000]	training's l1: 334.338
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [1972, 2043, 353, 2785, 1834, 6759, 8106, 6060, 9288, 2658, 1634, 5594, 2520, 1685, 5788, 5297, 1793, 6710, 1972, 2156, 691, 2272, 5901, 697, 2394, 3061, 2100, 2075, 4817, 2416, 2361, 479, 1874, 4541, 2180, 575, 4132, 2281, 2297, 2628, 7803, 8561, 2088, 2362, 1996, 1019, 2606, 8656, 2142, 2825, 2038, 2812, 1716, 996, 522, 5853, 2343, 5934, 2245, 2432, 7309, 6466, 2311, 2265, 2538, 6837, 5049, 8053, 6350, 1995, 6256, 1942, 1940, 1961])
                                              feature  importances
2                                             area_id          353
31     lasthour_poi_agg_poi_id_mean_waiting_order_num          479
54                                           food_num          522
35                poi_agg_poi_id_mean_box_total_value          575
20              poi_agg_poi_id_mean_waiting_order_num          691
23       lasthour_poi_agg_poi_id_mean_box_total_value          697
53                                        poi_lat_bin          996
45                                              15min         1019
10                                        poi_lng_bin         1634
13                                            poi_lng         1685
52                      poi_agg__avg_speed_meanpoi_id         1716
16                                              10min         1793
4                           poi_agg_poi_id_coor_count         1834
32             lasthour_poi_agg__avg_speed_meanpoi_id         1874
72               poi_agg_poi_id_mean_food_total_value         1940
71     lasthour_poi_agg_poi_id_mean_delivery_distance         1942
73              poi_agg_poi_id_mean_delivery_distance         1961
18      lasthour_poi_agg_poi_id_mean_food_total_value         1972
0                 poi_agg_poi_id_std_food_total_value         1972
69              poi_agg_poi_id_mean_arrive_guest_cost         1995
44         poi_agg_poi_id_arrive_guest_avg_speed_mean         1996
50                                            poi_lat         2038
1                  lasthour_poi_agg_poi_id_coor_count         2043
27              lasthour_poi_agg__avg_speed_stdpoi_id         2075
42     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2088
26                     lasthour_poi_agg_poi_id_std_dd         2100
48             lasthour_poi_agg_poi_id_std_fetch_cost         2142
19  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2156
34          poi_agg_poi_id_arrive_guest_avg_speed_std         2180
58      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2245
..                                                ...          ...
39                                  waiting_order_num         2628
9                               poi_agg_poi_id_std_dd         2658
3                                             weekday         2785
51                     poi_agg_poi_id_mean_fetch_cost         2812
49                       poi_agg__avg_speed_stdpoi_id         2825
25                             poi_agg_poi_id_mean_dd         3061
36                                        cst_lat_bin         4132
33                                 customer_longitude         4541
28                                        cst_lng_bin         4817
66                           _10min_working_rider_num         5049
15  high_level_arrive_shop##not_waited_div_not_wor...         5297
11       high_level_arrive_guest##delivery_distance_4         5594
14                                  customer_latitude         5788
55   area_id_area_id#hour#minute_arriveshop_cost_mean         5853
22  high_level_arrive_shop##waiting_plus_food_valu...         5901
57                   _10min_notbusy_working_rider_num         5934
7        high_level_arrive_guest##delivery_distance_2         6060
70                                  delivery_distance         6256
68                       _10min_not_fetched_order_num         6350
61                              prd_arrive_guest_time         6466
17    area_id_area_id#hour#minute_arriveshop_cost_std         6710
5                        _10min_deliverying_order_num         6759
65   area_id_area_id#hour#minute_food_total_value_sum         6837
60                                   food_total_value         7309
40                              bill_number_per_rider         7803
67                                     area_busy_coef         8053
6        high_level_arrive_guest##delivery_distance_3         8106
41                                          direction         8561
47      high_level_arrive_shop##not_fetched_area_busy         8656
8        high_level_arrive_guest##delivery_distance_1         9288

[74 rows x 2 columns]
########### sub: add high level###########
features,length 74, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'high_level_arrive_guest##delivery_distance_3', 'high_level_arrive_guest##delivery_distance_2', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'high_level_arrive_guest##delivery_distance_4', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_lng', 'customer_latitude', 'high_level_arrive_shop##not_waited_div_not_working_rider', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'high_level_arrive_shop##waiting_plus_food_value_plus_box_value', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'high_level_arrive_shop##not_fetched_area_busy', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'poi_lat_bin', 'food_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'poi_id', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'poi_agg_poi_id_mean_arriveshop_cost', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
########### sub: add high level###########
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.207592010498 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0183620452881 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0414938926697 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00713205337524 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.371500968933 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0815839767456 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0552577972412 s 

add stats features begin ......
add stats features end ......
time lapsing 1.117166996 s 

features,length 67, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'poi_agg_poi_id_mean_dd', '_10min_working_rider_num', 'area_busy_coef', 'area_id_area_id#hour#minute_food_total_value_sum', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14370
[LightGBM] [Info] Number of data: 659269, number of used features: 67
Training until validation scores don't improve for 20 rounds.
[200]	training's l1: 366.479
[400]	training's l1: 355.554
[600]	training's l1: 348.311
[800]	training's l1: 341.956
[1000]	training's l1: 336.059
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2273, 2121, 359, 3863, 2197, 9081, 2082, 2792, 1859, 1554, 2647, 2040, 7065, 9553, 2227, 8544, 2237, 2302, 834, 2329, 2457, 785, 2494, 2297, 2372, 5993, 2835, 2589, 587, 7443, 5202, 2383, 622, 4802, 2475, 2554, 6881, 9190, 9658, 1752, 2298, 2155, 1279, 2516, 2886, 1629, 3191, 1914, 620, 2326, 2192, 2380, 2580, 10669, 10537, 2324, 8406, 3396, 3403, 6602, 10925, 8448, 2000, 10666, 2185, 2147, 1996])
                                              feature  importances
2                                             area_id          359
28     lasthour_poi_agg_poi_id_mean_waiting_order_num          587
48                                           food_num          620
32                poi_agg_poi_id_mean_box_total_value          622
21       lasthour_poi_agg_poi_id_mean_box_total_value          785
18              poi_agg_poi_id_mean_waiting_order_num          834
42                                              15min         1279
9                                         poi_lat_bin         1554
45                                            poi_lat         1629
39                                            poi_lng         1752
8                                         poi_lng_bin         1859
47                      poi_agg__avg_speed_meanpoi_id         1914
66              poi_agg_poi_id_mean_delivery_distance         1996
62              poi_agg_poi_id_mean_arrive_guest_cost         2000
11     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2040
6              lasthour_poi_agg__avg_speed_meanpoi_id         2082
1                  lasthour_poi_agg_poi_id_coor_count         2121
65               poi_agg_poi_id_mean_food_total_value         2147
41         poi_agg_poi_id_arrive_guest_avg_speed_mean         2155
64     lasthour_poi_agg_poi_id_mean_delivery_distance         2185
50             lasthour_poi_agg_poi_id_std_fetch_cost         2192
4                           poi_agg_poi_id_coor_count         2197
14                                              10min         2227
16      lasthour_poi_agg_poi_id_mean_food_total_value         2237
0                 poi_agg_poi_id_std_food_total_value         2273
23                     lasthour_poi_agg_poi_id_std_dd         2297
40            lasthour_poi_agg_poi_id_mean_fetch_cost         2298
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2302
55                 poi_agg_poi_id_std_arriveshop_cost         2324
49                                             poi_id         2326
..                                                ...          ...
43                    lasthour_poi_agg_poi_id_mean_dd         2516
35        lasthour_poi_agg_poi_id_std_arriveshop_cost         2554
52       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2580
27       lasthour_poi_agg_poi_id_std_food_total_value         2589
10  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2647
7                               poi_agg_poi_id_std_dd         2792
26                      poi_agg_poi_id_std_fetch_cost         2835
44                       poi_agg__avg_speed_stdpoi_id         2886
46                     poi_agg_poi_id_mean_fetch_cost         3191
57                                    box_total_value         3396
58                             poi_agg_poi_id_mean_dd         3403
3                                             weekday         3863
33                                        cst_lat_bin         4802
30                                 customer_longitude         5202
25                                        cst_lng_bin         5993
59                           _10min_working_rider_num         6602
36                                  waiting_order_num         6881
12                                  customer_latitude         7065
29   area_id_area_id#hour#minute_arriveshop_cost_mean         7443
56                   _10min_notbusy_working_rider_num         8406
61   area_id_area_id#hour#minute_food_total_value_sum         8448
15    area_id_area_id#hour#minute_arriveshop_cost_std         8544
5                        _10min_deliverying_order_num         9081
37                              bill_number_per_rider         9190
13                       _10min_not_fetched_order_num         9553
38                                          direction         9658
54                              prd_arrive_guest_time        10537
63                                  delivery_distance        10666
53                                   food_total_value        10669
60                                     area_busy_coef        10925

[67 rows x 2 columns]
########### sub: add high level###########
add stats features begin ......
add stats features end ......
time lapsing 0.207089185715 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0191750526428 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0420060157776 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00820112228394 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.37840294838 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0753560066223 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0507719516754 s 

add stats features begin ......
add stats features end ......
time lapsing 1.0365011692 s 

features,length 69, ['poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_coor_count', 'area_id', 'weekday', 'poi_agg_poi_id_coor_count', '_10min_deliverying_order_num', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'high_level_arrive_guest##delivery_distance_1', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', 'high_level_arrive_shop##not_waited_div_not_working_rider', '10min', 'area_id_area_id#hour#minute_arriveshop_cost_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_std_delivery_distance', 'poi_agg_poi_id_mean_dd', 'lasthour_poi_agg_poi_id_std_dd', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_food_total_value', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'customer_longitude', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'poi_agg_poi_id_mean_box_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', 'bill_number_per_rider', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', '15min', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg__avg_speed_stdpoi_id', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', '_10min_notbusy_working_rider_num', 'box_total_value', 'area_id_area_id#hour#minute_food_total_value_sum', '_10min_working_rider_num', 'area_busy_coef', '_10min_not_fetched_order_num', 'poi_agg_poi_id_mean_arrive_guest_cost', 'delivery_distance', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'poi_agg_poi_id_mean_food_total_value', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 14880
[LightGBM] [Info] Number of data: 659269, number of used features: 69
Training until validation scores don't improve for 20 rounds.
[200]	training's l1: 366.48
[400]	training's l1: 355.285
[600]	training's l1: 347.731
[800]	training's l1: 341.146
[1000]	training's l1: 334.993
[LightGBM] [Info] Finished loading 1000 models
Calculate feature importances...
('Feature importances:', [2241, 2345, 398, 3164, 2107, 8244, 2040, 10686, 2853, 1792, 1618, 2762, 2232, 6134, 7993, 2002, 7669, 2185, 2323, 801, 2365, 2445, 753, 2453, 3257, 2443, 2184, 5403, 2530, 2541, 524, 6757, 5450, 2443, 673, 4515, 2525, 2583, 5319, 8382, 8547, 1726, 2605, 2318, 1143, 2614, 2851, 1832, 3197, 1931, 538, 2351, 2146, 2486, 2608, 9416, 9012, 2465, 6703, 3118, 7591, 5992, 9955, 7836, 2107, 8433, 2190, 2160, 1995])
                                              feature  importances
2                                             area_id          398
30     lasthour_poi_agg_poi_id_mean_waiting_order_num          524
50                                           food_num          538
34                poi_agg_poi_id_mean_box_total_value          673
22       lasthour_poi_agg_poi_id_mean_box_total_value          753
19              poi_agg_poi_id_mean_waiting_order_num          801
44                                              15min         1143
10                                        poi_lat_bin         1618
41                                            poi_lng         1726
9                                         poi_lng_bin         1792
47                                            poi_lat         1832
49                      poi_agg__avg_speed_meanpoi_id         1931
68              poi_agg_poi_id_mean_delivery_distance         1995
15                                              10min         2002
6              lasthour_poi_agg__avg_speed_meanpoi_id         2040
64              poi_agg_poi_id_mean_arrive_guest_cost         2107
4                           poi_agg_poi_id_coor_count         2107
52             lasthour_poi_agg_poi_id_std_fetch_cost         2146
67               poi_agg_poi_id_mean_food_total_value         2160
26              lasthour_poi_agg__avg_speed_stdpoi_id         2184
17      lasthour_poi_agg_poi_id_mean_food_total_value         2185
66     lasthour_poi_agg_poi_id_mean_delivery_distance         2190
12     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         2232
0                 poi_agg_poi_id_std_food_total_value         2241
43         poi_agg_poi_id_arrive_guest_avg_speed_mean         2318
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2323
1                  lasthour_poi_agg_poi_id_coor_count         2345
51                                             poi_id         2351
20               poi_agg_poi_id_std_delivery_distance         2365
33          poi_agg_poi_id_arrive_guest_avg_speed_std         2443
..                                                ...          ...
42            lasthour_poi_agg_poi_id_mean_fetch_cost         2605
54       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2608
45                    lasthour_poi_agg_poi_id_mean_dd         2614
11  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2762
46                       poi_agg__avg_speed_stdpoi_id         2851
8                               poi_agg_poi_id_std_dd         2853
59                                    box_total_value         3118
3                                             weekday         3164
48                     poi_agg_poi_id_mean_fetch_cost         3197
24                             poi_agg_poi_id_mean_dd         3257
35                                        cst_lat_bin         4515
38                                  waiting_order_num         5319
27                                        cst_lng_bin         5403
32                                 customer_longitude         5450
61                           _10min_working_rider_num         5992
13                                  customer_latitude         6134
58                   _10min_notbusy_working_rider_num         6703
31   area_id_area_id#hour#minute_arriveshop_cost_mean         6757
60   area_id_area_id#hour#minute_food_total_value_sum         7591
16    area_id_area_id#hour#minute_arriveshop_cost_std         7669
63                       _10min_not_fetched_order_num         7836
14  high_level_arrive_shop##not_waited_div_not_wor...         7993
5                        _10min_deliverying_order_num         8244
39                              bill_number_per_rider         8382
65                                  delivery_distance         8433
40                                          direction         8547
56                              prd_arrive_guest_time         9012
55                                   food_total_value         9416
62                                     area_busy_coef         9955
7        high_level_arrive_guest##delivery_distance_1        10686

[69 rows x 2 columns]
