########### sub add fetch cost area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.222110033035 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0218482017517 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0447609424591 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00788807868958 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.42612695694 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0816159248352 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0529398918152 s 

add stats features begin ......
add stats features end ......
time lapsing 1.26259589195 s 

tr.size() 659269
te.size() 251864
features,length 62, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13110
[LightGBM] [Info] Number of data: 659269, number of used features: 62
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1825, 271, 2306, 8722, 2204, 1917, 2305, 1459, 1275, 2078, 1958, 5763, 8760, 7714, 6360, 724, 636, 2099, 659, 8786, 6103, 2011, 1885, 4942, 2108, 477, 7586, 2205, 2165, 2041, 3528, 1959, 2122, 5837, 7330, 8696, 1325, 2222, 1949, 1879, 4430, 1880, 1324, 2542, 1702, 562, 2178, 1981, 1886, 2045, 2092, 8981, 8552, 2069, 2258, 2916, 2436, 3143, 1310, 1960, 9510, 2052])
                                              feature  importances
1                                             area_id          271
25     lasthour_poi_agg_poi_id_mean_waiting_order_num          477
45                                           food_num          562
16                poi_agg_poi_id_mean_box_total_value          636
18              poi_agg_poi_id_mean_waiting_order_num          659
15       lasthour_poi_agg_poi_id_mean_box_total_value          724
8                                         poi_lat_bin         1275
58                                              15min         1310
42                                            poi_lat         1324
36                                            poi_lng         1325
7                                         poi_lng_bin         1459
44                      poi_agg__avg_speed_meanpoi_id         1702
0                  lasthour_poi_agg_poi_id_coor_count         1825
39              poi_agg_poi_id_mean_arrive_guest_cost         1879
41                          poi_agg_poi_id_coor_count         1880
22              lasthour_poi_agg__avg_speed_stdpoi_id         1885
48             lasthour_poi_agg_poi_id_std_fetch_cost         1886
5              lasthour_poi_agg__avg_speed_meanpoi_id         1917
38                     lasthour_poi_agg_poi_id_std_dd         1949
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1958
31               poi_agg_poi_id_std_arrive_guest_cost         1959
59     lasthour_poi_agg_poi_id_mean_delivery_distance         1960
47                                             poi_id         1981
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         2011
29      lasthour_poi_agg_poi_id_mean_food_total_value         2041
49       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2045
61              poi_agg_poi_id_mean_delivery_distance         2052
53                 poi_agg_poi_id_std_arriveshop_cost         2069
9                 poi_agg_poi_id_mean_arriveshop_cost         2078
50      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2092
..                                                ...          ...
32        lasthour_poi_agg_poi_id_std_arriveshop_cost         2122
28          poi_agg_poi_id_arrive_guest_avg_speed_std         2165
46                       poi_agg__avg_speed_stdpoi_id         2178
4                poi_agg_poi_id_mean_food_total_value         2204
27                    lasthour_poi_agg_poi_id_mean_dd         2205
37            lasthour_poi_agg_poi_id_mean_fetch_cost         2222
54  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2258
6                               poi_agg_poi_id_std_dd         2305
2                                               10min         2306
56                             poi_agg_poi_id_mean_dd         2436
43                     poi_agg_poi_id_mean_fetch_cost         2542
55                                    box_total_value         2916
57                                            weekday         3143
30                                        cst_lat_bin         3528
40                                 customer_longitude         4430
23                                        cst_lng_bin         4942
11                                  customer_latitude         5763
33                                  waiting_order_num         5837
20                           _10min_working_rider_num         6103
14                   _10min_notbusy_working_rider_num         6360
34                       _10min_deliverying_order_num         7330
26   area_id_area_id#hour#minute_arriveshop_cost_mean         7586
13    area_id_area_id#hour#minute_arriveshop_cost_std         7714
52                              prd_arrive_guest_time         8552
35                                          direction         8696
3                               bill_number_per_rider         8722
12                       _10min_not_fetched_order_num         8760
19                                  delivery_distance         8786
51                                   food_total_value         8981
60                                     area_busy_coef         9510

[62 rows x 2 columns]
[from_start 6780c31] sub:add fetch cost area
 1 file changed, 48 insertions(+), 49 deletions(-)
########### sub: add fetch cost area ###########
add stats features begin ......
add stats features end ......
time lapsing 0.214452981949 s 

add stats features begin ......
add stats features end ......
time lapsing 0.018755197525 s 

add stats features begin ......
add stats features end ......
time lapsing 0.045599937439 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00646495819092 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.381939888 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0897309780121 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0494749546051 s 

add stats features begin ......
add stats features end ......
time lapsing 1.32183790207 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'area_id_area_id#hour#minute_fetch_cost_std', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'area_id_area_id#hour#minute_fetch_cost_mean', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13620
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1757, 254, 1922, 7641, 2159, 1719, 2362, 1497, 1255, 7174, 1923, 2172, 5443, 7624, 6224, 5926, 709, 589, 1924, 648, 8541, 5571, 1846, 2065, 4701, 2146, 411, 5878, 2216, 2198, 2004, 3857, 1901, 2206, 5411, 6589, 7863, 1307, 2015, 2010, 1821, 4418, 1650, 1326, 2278, 1743, 5609, 464, 2210, 2107, 1992, 2124, 2200, 8088, 7864, 2145, 2364, 2732, 2355, 2954, 962, 2209, 8629, 2098])
                                              feature  importances
1                                             area_id          254
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          411
47                                           food_num          464
17                poi_agg_poi_id_mean_box_total_value          589
19              poi_agg_poi_id_mean_waiting_order_num          648
16       lasthour_poi_agg_poi_id_mean_box_total_value          709
60                                              15min          962
8                                         poi_lat_bin         1255
37                                            poi_lng         1307
43                                            poi_lat         1326
7                                         poi_lng_bin         1497
42                          poi_agg_poi_id_coor_count         1650
5              lasthour_poi_agg__avg_speed_meanpoi_id         1719
45                      poi_agg__avg_speed_meanpoi_id         1743
0                  lasthour_poi_agg_poi_id_coor_count         1757
40              poi_agg_poi_id_mean_arrive_guest_cost         1821
22         poi_agg_poi_id_arrive_guest_avg_speed_mean         1846
32               poi_agg_poi_id_std_arrive_guest_cost         1901
2                                               10min         1922
10                poi_agg_poi_id_mean_arriveshop_cost         1923
18  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1924
50             lasthour_poi_agg_poi_id_std_fetch_cost         1992
30      lasthour_poi_agg_poi_id_mean_food_total_value         2004
39                     lasthour_poi_agg_poi_id_std_dd         2010
38            lasthour_poi_agg_poi_id_mean_fetch_cost         2015
23              lasthour_poi_agg__avg_speed_stdpoi_id         2065
63              poi_agg_poi_id_mean_delivery_distance         2098
49                                             poi_id         2107
51       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2124
55                 poi_agg_poi_id_std_arriveshop_cost         2145
..                                                ...          ...
52      lasthour_poi_agg_poi_id_std_arrive_guest_cost         2200
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2206
61     lasthour_poi_agg_poi_id_mean_delivery_distance         2209
48                       poi_agg__avg_speed_stdpoi_id         2210
28                    lasthour_poi_agg_poi_id_mean_dd         2216
44                     poi_agg_poi_id_mean_fetch_cost         2278
58                             poi_agg_poi_id_mean_dd         2355
6                               poi_agg_poi_id_std_dd         2362
56  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2364
57                                    box_total_value         2732
59                                            weekday         2954
31                                        cst_lat_bin         3857
41                                 customer_longitude         4418
24                                        cst_lng_bin         4701
34                                  waiting_order_num         5411
12                                  customer_latitude         5443
21                           _10min_working_rider_num         5571
46        area_id_area_id#hour#minute_fetch_cost_mean         5609
27   area_id_area_id#hour#minute_arriveshop_cost_mean         5878
15                   _10min_notbusy_working_rider_num         5926
14    area_id_area_id#hour#minute_arriveshop_cost_std         6224
35                       _10min_deliverying_order_num         6589
9          area_id_area_id#hour#minute_fetch_cost_std         7174
13                       _10min_not_fetched_order_num         7624
3                               bill_number_per_rider         7641
36                                          direction         7863
54                              prd_arrive_guest_time         7864
53                                   food_total_value         8088
20                                  delivery_distance         8541
62                                     area_busy_coef         8629

[64 rows x 2 columns]
[from_start 2fe3c24] sub:add fetch cost area
 2 files changed, 82 insertions(+), 80 deletions(-)
########### sub: arrive_guest_cost ###########
add stats features begin ......
add stats features end ......
time lapsing 0.226097106934 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0189690589905 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0463399887085 s 

add stats features begin ......
add stats features end ......
time lapsing 0.00699496269226 s 

start basic fea...
cal pre cost
cal ta cost
done basic fea...
poi agg fea...
add stats features begin ......
add stats features end ......
time lapsing 0.382848024368 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0753009319305 s 

add stats features begin ......
add stats features end ......
time lapsing 0.0508580207825 s 

add stats features begin ......
add stats features end ......
time lapsing 1.19944190979 s 

tr.size() 659269
te.size() 251864
features,length 64, ['lasthour_poi_agg_poi_id_coor_count', 'area_id', '10min', 'bill_number_per_rider', 'poi_agg_poi_id_mean_food_total_value', 'lasthour_poi_agg__avg_speed_meanpoi_id', 'poi_agg_poi_id_std_dd', 'poi_lng_bin', 'poi_lat_bin', 'poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_mean_arrive_guest_cost', 'customer_latitude', '_10min_not_fetched_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_std', '_10min_notbusy_working_rider_num', 'lasthour_poi_agg_poi_id_mean_box_total_value', 'poi_agg_poi_id_mean_box_total_value', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_mean', 'poi_agg_poi_id_mean_waiting_order_num', 'delivery_distance', '_10min_working_rider_num', 'poi_agg_poi_id_arrive_guest_avg_speed_mean', 'area_id_area_id#hour#minute_aarrive_guest_cost_mean', 'lasthour_poi_agg__avg_speed_stdpoi_id', 'cst_lng_bin', 'poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_waiting_order_num', 'area_id_area_id#hour#minute_arriveshop_cost_mean', 'lasthour_poi_agg_poi_id_mean_dd', 'poi_agg_poi_id_arrive_guest_avg_speed_std', 'lasthour_poi_agg_poi_id_mean_food_total_value', 'cst_lat_bin', 'poi_agg_poi_id_std_arrive_guest_cost', 'lasthour_poi_agg_poi_id_std_arriveshop_cost', 'waiting_order_num', '_10min_deliverying_order_num', 'direction', 'poi_lng', 'lasthour_poi_agg_poi_id_mean_fetch_cost', 'lasthour_poi_agg_poi_id_std_dd', 'poi_agg_poi_id_mean_arrive_guest_cost', 'customer_longitude', 'poi_agg_poi_id_coor_count', 'poi_lat', 'poi_agg_poi_id_mean_fetch_cost', 'poi_agg__avg_speed_meanpoi_id', 'food_num', 'poi_agg__avg_speed_stdpoi_id', 'poi_id', 'lasthour_poi_agg_poi_id_std_fetch_cost', 'lasthour_poi_agg_poi_id_mean_arriveshop_cost', 'lasthour_poi_agg_poi_id_std_arrive_guest_cost', 'food_total_value', 'prd_arrive_guest_time', 'poi_agg_poi_id_std_arriveshop_cost', 'lasthour_poi_agg_poi_id_arrive_guest_avg_speed_std', 'box_total_value', 'poi_agg_poi_id_mean_dd', 'area_id_area_id#hour#minute_arrive_guest_cost_std', 'weekday', '15min', 'lasthour_poi_agg_poi_id_mean_delivery_distance', 'area_busy_coef', 'poi_agg_poi_id_mean_delivery_distance']
Start training...
[LightGBM] [Info] Total Bins 13618
[LightGBM] [Info] Number of data: 659269, number of used features: 64
[LightGBM] [Info] Finished loading 800 models
Calculate feature importances...
('Feature importances:', [1740, 298, 1999, 7785, 2023, 1729, 2258, 1422, 1289, 2065, 1845, 5936, 7221, 6613, 6071, 647, 555, 1999, 618, 8408, 5500, 1928, 6252, 2016, 4618, 2086, 380, 6493, 2258, 2100, 1977, 3739, 1873, 2114, 5463, 7047, 8068, 1254, 2035, 2049, 1700, 4336, 1602, 1252, 2324, 1631, 461, 2154, 1838, 1832, 2195, 1794, 8988, 7534, 1857, 2431, 2867, 2355, 6329, 3005, 1034, 1949, 8836, 1925])
                                              feature  importances
1                                             area_id          298
26     lasthour_poi_agg_poi_id_mean_waiting_order_num          380
46                                           food_num          461
16                poi_agg_poi_id_mean_box_total_value          555
18              poi_agg_poi_id_mean_waiting_order_num          618
15       lasthour_poi_agg_poi_id_mean_box_total_value          647
60                                              15min         1034
43                                            poi_lat         1252
37                                            poi_lng         1254
8                                         poi_lat_bin         1289
7                                         poi_lng_bin         1422
42                          poi_agg_poi_id_coor_count         1602
45                      poi_agg__avg_speed_meanpoi_id         1631
40              poi_agg_poi_id_mean_arrive_guest_cost         1700
5              lasthour_poi_agg__avg_speed_meanpoi_id         1729
0                  lasthour_poi_agg_poi_id_coor_count         1740
51      lasthour_poi_agg_poi_id_std_arrive_guest_cost         1794
49             lasthour_poi_agg_poi_id_std_fetch_cost         1832
48                                             poi_id         1838
10     lasthour_poi_agg_poi_id_mean_arrive_guest_cost         1845
54                 poi_agg_poi_id_std_arriveshop_cost         1857
32               poi_agg_poi_id_std_arrive_guest_cost         1873
63              poi_agg_poi_id_mean_delivery_distance         1925
21         poi_agg_poi_id_arrive_guest_avg_speed_mean         1928
61     lasthour_poi_agg_poi_id_mean_delivery_distance         1949
30      lasthour_poi_agg_poi_id_mean_food_total_value         1977
2                                               10min         1999
17  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         1999
23              lasthour_poi_agg__avg_speed_stdpoi_id         2016
4                poi_agg_poi_id_mean_food_total_value         2023
..                                                ...          ...
29          poi_agg_poi_id_arrive_guest_avg_speed_std         2100
33        lasthour_poi_agg_poi_id_std_arriveshop_cost         2114
47                       poi_agg__avg_speed_stdpoi_id         2154
50       lasthour_poi_agg_poi_id_mean_arriveshop_cost         2195
6                               poi_agg_poi_id_std_dd         2258
28                    lasthour_poi_agg_poi_id_mean_dd         2258
44                     poi_agg_poi_id_mean_fetch_cost         2324
57                             poi_agg_poi_id_mean_dd         2355
55  lasthour_poi_agg_poi_id_arrive_guest_avg_speed...         2431
56                                    box_total_value         2867
59                                            weekday         3005
31                                        cst_lat_bin         3739
41                                 customer_longitude         4336
24                                        cst_lng_bin         4618
34                                  waiting_order_num         5463
20                           _10min_working_rider_num         5500
11                                  customer_latitude         5936
14                   _10min_notbusy_working_rider_num         6071
22  area_id_area_id#hour#minute_aarrive_guest_cost...         6252
58  area_id_area_id#hour#minute_arrive_guest_cost_std         6329
27   area_id_area_id#hour#minute_arriveshop_cost_mean         6493
13    area_id_area_id#hour#minute_arriveshop_cost_std         6613
35                       _10min_deliverying_order_num         7047
12                       _10min_not_fetched_order_num         7221
53                              prd_arrive_guest_time         7534
3                               bill_number_per_rider         7785
36                                          direction         8068
19                                  delivery_distance         8408
62                                     area_busy_coef         8836
52                                   food_total_value         8988

[64 rows x 2 columns]
[from_start 6afe3dd] sub:arrive_guest_cost
 2 files changed, 36 insertions(+), 35 deletions(-)
